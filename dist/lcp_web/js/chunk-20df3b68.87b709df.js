(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-20df3b68"],{1732:function(t,e,a){},"333d":function(t,e,a){"use strict";a("c5f6"),Math.easeInOutQuad=function(t,e,a,i){return(t/=i/2)<1?a/2*t*t+e:-a/2*(--t*(t-2)-1)+e};var i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};function n(t,e,a){var n=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,r=t-n,s=0;e=void 0===e?500:e;!function t(){s+=20,function(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}(Math.easeInOutQuad(s,n,r,e)),s<e?i(t):a&&"function"==typeof a&&a()}()}var r={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit("update:limit",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,limit:t}),this.autoScroll&&n(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,limit:this.pageSize}),this.autoScroll&&n(0,800)}}},s=r,o=(a("8d79"),a("2877")),u=Object(o.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[a("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)}),[],!1,null,"0a87263c",null);e.a=u.exports},"449c":function(t,e,a){t.exports=a.p+"img/warning.5f578519.svg"},4605:function(t,e,a){"use strict";a.r(e);var i=a("c7eb"),n=(a("96cf"),a("1da1")),r=a("6ea4"),s=a("df55"),o=a("7562"),u=a("ed08"),c={components:{steps:r.a,monitor:s.a},data:function(){return{stepsObj:{active:2,title:"发布API",tiptitle:["部署服务","维护JSF别名","填写发布原因","提交发布请求成功"]},id:this.$route.params.id,qualifiedName:this.$route.query.qualifiedName,formData:{postMessage:""},formrules:{postMessage:[{required:!0,message:"请填写发布信息",trigger:"blur"}]}}},methods:{findApiBaseInfo:function(){var t=Object(n.a)(Object(i.a)().mark((function t(e){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/ApiManagerService/findApiBaseInfo",a=[{id:e}],t.next=4,o.a.post("/ApiManagerService/findApiBaseInfo",JSON.stringify(a));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),updateTitle:function(t){this.id=t.id,this.qualifiedName=t.qualifiedName,this.createUser=t.createUser,this.createTime=Object(u.c)(t.createTime,"{y}-{m}-{d} {h}:{i}"),this.updateTime=Object(u.c)(t.updateTime,"{y}-{m}-{d} {h}:{i}"),this.status=t.status},fetchApiSummary:function(){var t=Object(n.a)(Object(i.a)().mark((function t(e){var a,n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.findApiBaseInfo(e).catch((function(){throw new Error("fetchApiInstance findApiBaseInfo")}));case 2:a=t.sent,n=a.data,this.updateTitle(n);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),previous:function(){this.$router.push({name:"ApiManagerApiTabsPublishTwo",params:{id:this.id},query:{qualifiedName:this.qualifiedName}})},next:function(){var t=this;this.$refs.postMessageForm.validate((function(e){if(!e)return!1;Object(o.a)({url:"/ApiManagerService/applyPublishApi",method:"post",data:JSON.stringify([{id:t.id,reason:t.formData.postMessage}])}).then((function(e){t.fetchApiSummary(t.id),t.$router.push({name:"ApiManagerApiTabsPublishFour",params:{id:t.id},query:{qualifiedName:t.qualifiedName}})})).catch((function(t){}))}))}}},l=c,p=(a("9746"),a("2877")),d=Object(p.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("steps",t._b({},"steps",t.stepsObj,!1)),a("div",{staticClass:"entryFormBox tc",staticStyle:{width:"80%","margin-left":"10%"}},[a("el-form",{ref:"postMessageForm",staticClass:"textarea",attrs:{model:t.formData,rules:t.formrules}},[a("el-form-item",{attrs:{prop:"postMessage"}},[a("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请填写本次发布的原因，如：快递b2c业务，新增取件码核销场景开放给外部客户。"},model:{value:t.formData.postMessage,callback:function(e){t.$set(t.formData,"postMessage",e)},expression:"formData.postMessage"}})],1)],1)],1),a("div",{staticStyle:{"margin-top":"30px","text-align":"center"}},[a("el-button",{on:{click:t.previous}},[t._v("上一步")]),a("el-button",{attrs:{type:"primary"},on:{click:t.next}},[t._v("发布")])],1)],1)}),[],!1,null,"9e668e04",null);e.default=d.exports},"6ea4":function(t,e,a){"use strict";var i=(a("c5f6"),{name:"steps",props:{active:{required:!0,type:Number},title:{required:!1,type:String},tiptitle:{required:!0,type:Array}}}),n=(a("e7be"),a("2877")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.title?a("h2",{staticClass:"com-tit-mini"},[t._v(t._s(t.title))]):t._e(),a("div",{staticClass:"my-step-bar"},[a("el-steps",{staticClass:"my-steps",attrs:{active:t.active,"finish-status":"success","align-center":""}},t._l(t.tiptitle,(function(t,e){return a("el-step",{key:e,attrs:{title:t}})})),1)],1)])}),[],!1,null,"16bbb482",null);e.a=r.exports},"753e":function(t,e,a){},7562:function(t,e,a){"use strict";var i=a("c7eb"),n=(a("96cf"),a("1da1")),r=a("bc3a"),s=a.n(r),o=a("7a3a"),u=a("3cfb"),c=a("c24f"),l=a("2a53"),p=a("a78e"),d=a.n(p),f=!1,m=s.a.create({baseURL:window.env.gatewayApiDecoupling,withCredentials:!0,timeout:1e4,headers:{"LOP-DN":window.env.gatewayApiDecouplingLop,"Account-Type":Object(l.a)()?"erp":"passport","X-Requested-With":"XMLHttpRequest"}});function h(){return g.apply(this,arguments)}function g(){return g=Object(n.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:u.a.dispatch("user/resetUser"),sessionStorage.setItem("store",JSON.stringify(u.a.state)),o.MessageBox.confirm("您的登录状态已失效，是否重新登录？","提示",{confirmButtonText:"登录",cancelButtonText:"不登录",type:"warning"}).then(Object(n.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f=!1,t.next=3,Object(c.a)();case 3:if(!l.a){t.next=8;break}return t.next=6,u.a.dispatch("user/handleIntranetGetUserInfo");case 6:t.next=9;break;case 8:window.location.reload();case 9:case"end":return t.stop()}}),t)})))).catch((function(){f=!1}));case 3:case"end":return t.stop()}}),t)}))),g.apply(this,arguments)}m.interceptors.request.use((function(t){return t.headers.groupCode=d.a.get("groupCode")||"",t}),(function(t){return Promise.reject(t)})),m.interceptors.response.use((function(t){var e=t.status;if(t.data.error_response)return o.Message.error("服务异常"),Promise.reject(t);if(401===e||520===e)return f||(f=!0,h()),Promise.reject(t);if(t.data.response){var a=t.data.response,i=a.code,n=a.message;return 2e4===i?t.data.response:(10003===i||n&&o.Message.error(n),Promise.reject(t.data.response))}return Promise.reject(t)}),(function(t){var e=t.response.status;return t.response.data.error_response&&o.Message.error("服务异常"),401!==e&&520!==e||f||(f=!0,h()),Promise.reject(t.response)})),e.a=m},"8d79":function(t,e,a){"use strict";a("753e")},9746:function(t,e,a){"use strict";a("f531")},d491:function(t,e,a){"use strict";a("1732")},d6a5:function(t,e,a){},df55:function(t,e,a){"use strict";var i=a("c7eb"),n=(a("96cf"),a("1da1")),r=a("333d"),s=a("b775"),o=a("7562"),u={components:{Pagination:r.a},data:function(){return{tableDatas:[],monitor:"pending",radio:"全部",listQuery:{total:1,pageNumb:1,pageSize:10,pageSizes:[10,20,40,60]},aliasList:[],currentTableDatas:[],loading:!0,apiPublishPath:"",alias:""}},methods:{findApiBaseInfo:function(){var t=Object(n.a)(Object(i.a)().mark((function t(){var e,a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/ApiManagerService/findApiBaseInfo",e=this.$route.params.id,a=[{id:e}],t.next=5,o.a.post("/ApiManagerService/findApiBaseInfo",JSON.stringify(a));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),fetchAlias:function(){var t=this;Object(o.a)({url:"/ApiManagerService/queryAlias",method:"post",data:JSON.stringify([{pageSize:50,pageNumb:1},{id:this.$route.params.id}])}).then((function(e){t.aliasList=[];var a=e.data.list;if(a){for(var i=0;i<a.length;i++){var n={};n.key=a[i].alias,n.label=a[i].alias,t.aliasList.push(n)}t.allButtonFocus=!0}t.loading=!1})).catch((function(e){t.loading=!1}))},fetchApiInstance:function(){var t=Object(n.a)(Object(i.a)().mark((function t(){var e,a,n=this;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.findApiBaseInfo().catch((function(){throw n.loading=!1,new Error("fetchApiInstance findApiBaseInfo")}));case 2:e=t.sent,a=e.data,this.qualifiedName=a.qualifiedName,this.queryApiMonitor();case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),queryApiMonitor:function(){var t=this;Object(s.a)({url:"/apiInstance/apiMonitor",method:"get",params:{qualifiedName:this.qualifiedName,pageSize:this.listQuery.pageSize,pageNumb:this.listQuery.pageNumb,alias:this.alias}}).then((function(e){t.monitor="online",t.listQuery.total=e.data.total,t.tableDatas=e.data.list,t.currentTableDatas=t.tableDatas,t.fetchAlias()})).catch((function(e){t.monitor="offline",t.loading=!1}))},paginationChange:function(t){this.listQuery.pageNumb=t.page,this.listQuery.pageSize=t.limit,this.queryApiMonitor()},onQueryByAlias:function(){"全部"===this.radio?(this.alias="",this.queryApiMonitor(),this.currentTableDatas=this.tableDatas):(this.alias=this.radio,this.queryApiMonitor())},rowClassName:function(t){var e=t.row,a=t.rowIndex;e.number=a+1}},mounted:function(){this.apiPublishPath=window.location.protocol+"//"+"".concat(window.location.host,"/#")+"".concat(window.env.docApiPublish),this.fetchApiInstance()}},c=u,l=(a("d491"),a("2877")),p=Object(l.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{meta:"x:259.0,y:143.0,width:600.0,height:395.0"}},["online"===t.monitor?i("span",{key:"1"},[i("div",{staticClass:"filter-container"},[i("el-row",[i("el-col",{attrs:{span:24}},[i("label",{staticStyle:{margin:"5px","font-weight":"normal"}},[t._v("别名: ")]),i("el-radio-group",{on:{change:function(e){return t.onQueryByAlias()}},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[i("el-radio-button",{attrs:{label:"全部",id:"all"}}),t._l(t.aliasList,(function(t){return i("el-radio-button",{key:t.key,attrs:{label:t.label}})}))],2)],1)],1)],1)]):t._e(),"online"===t.monitor||"pending"===t.monitor?i("span",{key:"2"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"my-table mb2",attrs:{"element-loading-text":"存活实例检测中...","element-loading-spinner":"el-icon-loading",data:t.currentTableDatas,"default-sort":{prop:"host",order:"descending"},"row-class-name":t.rowClassName}},[i("el-table-column",{attrs:{label:"序号",prop:"number",align:"center","min-width":"7.36%"}}),i("el-table-column",{attrs:{prop:"ip",label:"主机",align:"center","min-width":"18.23%"}}),i("el-table-column",{attrs:{prop:"port",label:"端口",align:"center","min-width":"15.22%"}}),i("el-table-column",{attrs:{prop:"alias",label:"别名",align:"center","min-width":"29.60%"}}),i("el-table-column",{attrs:{prop:"pid",label:"PID",align:"center","min-width":"16.05%"}}),i("el-table-column",{attrs:{prop:"status",label:"状态",align:"center","min-width":"13.38%"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status&&1==e.row.optType?i("span",{staticClass:"unknownColor",attrs:{type:"text"}},[t._v("无心跳 ")]):t._e(),1==e.row.status&&1==e.row.optType?i("span",{staticClass:"normalColor",attrs:{type:"text"}},[t._v("正常 ")]):t._e(),0==e.row.status&&0==e.row.optType?i("span",{staticClass:"deadColor",attrs:{type:"text"}},[t._v("死亡 ")]):t._e(),1==e.row.status&&0==e.row.optType?i("span",{staticClass:"deadColor",attrs:{type:"text"}},[t._v("下线 ")]):t._e(),2==e.row.status?i("span",{staticClass:"deadColor",attrs:{type:"text"}},[t._v("死亡 ")]):t._e(),3==e.row.status?i("span",{staticClass:"deadColor",attrs:{type:"text"}},[t._v("死亡下线 ")]):t._e(),4==e.row.status?i("span",{attrs:{type:"text"}},[t._v("反注册 ")]):t._e(),5==e.row.status?i("span",{attrs:{type:"text"}},[t._v("扫描 ")]):t._e()]}}],null,!1,1686916691)})],1)],1):t._e(),"online"===t.monitor?i("span",{key:"3"},[i("el-row",[i("el-col",{attrs:{span:24}},[i("pagination",{directives:[{name:"show",rawName:"v-show",value:t.listQuery.total,expression:"listQuery.total"}],staticStyle:{margin:"0px",float:"right"},attrs:{total:t.listQuery.total,pageSizes:t.listQuery.pageSizes,page:t.listQuery.pageNumb,limit:t.listQuery.pageSize},on:{"update:pageSizes":function(e){return t.$set(t.listQuery,"pageSizes",e)},"update:page-sizes":function(e){return t.$set(t.listQuery,"pageSizes",e)},"update:page":function(e){return t.$set(t.listQuery,"pageNumb",e)},"update:limit":function(e){return t.$set(t.listQuery,"pageSize",e)},pagination:t.paginationChange}})],1)],1)],1):"offline"===t.monitor?i("span",{key:"4"},[i("div",{staticStyle:{"margin-top":"15%","text-align":"center"}},[i("img",{staticStyle:{width:"80px",height:"80px","margin-bottom":"20px"},attrs:{src:a("449c")}}),i("el-row",[i("el-col",{attrs:{span:24}},[i("div",{staticStyle:{"margin-top":"0px","text-align":"center"}},[t._v(" 没有检测到存活实例，请检查是否已按照"),i("a",{staticStyle:{color:"#3c6ef0"},attrs:{href:this.apiPublishPath,target:"_blank"}},[t._v("《API部署手册》")]),t._v("成功部署服务，并在别名列表中维护JSF别名 ")])])],1)],1)]):t._e()])}),[],!1,null,"694fd4fa",null);e.a=p.exports},e7be:function(t,e,a){"use strict";a("d6a5")},f531:function(t,e,a){}}]);