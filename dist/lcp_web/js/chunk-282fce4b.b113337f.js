(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-282fce4b"],{"43fc":function(e,t,a){"use strict";a("d14b")},"7f92":function(e,t,a){"use strict";a.r(t);var s=a("c7eb"),n=(a("96cf"),a("1da1")),r=(a("7f7f"),a("a322")),i=a("fd48"),c={data:function(){return{headerInfo:{},activeRouteName:"messageManagerBasicInfo",status:-1}},watch:{$route:{handler:function(e){e&&(this.activeRouteName=e.name)},immediate:!0}},computed:{headerInfoStatus:function(){var e=this.status;switch(+e){case 0:return{text:"初始化",className:"status_init",disabled:!1,status:e};case 1:return{text:"编辑中",className:"status_edit",disabled:!1,status:e};case 2:return{text:"审批中",className:"status_approve",disabled:!0,status:e};case 3:return{text:"已发布",className:"status_released",disabled:!0,status:e};case 4:return{text:"已下线",className:"status_offline",disabled:!1,status:e};default:return{}}}},mounted:function(){"messageManagerBasicInfo"!==this.activeRouteName&&this.queryMessageBaseInfo()},methods:{queryMessageBaseInfo:function(){var e=Object(n.a)(Object(s.a)().mark((function e(){var t,a,n,r;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{topic:this.$route.params.topic}],e.next=3,i.a.messageAccessService.queryMessageBaseInfo(t);case 3:a=e.sent,r=(n=a||{}).data,2e4==+n.code&&this.updateBasicInfo(r);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),updateBasicInfo:function(e){var t=e||{},a=t.topic,s=t.status,n=t.createUser,r=t.createTime,i=t.cnName,c=t.dailyCall,u=t.tps;this.headerInfo={url:a,name:i,createUser:n,createTime:r,tps:u,dailyCall:c},this.status=s},handleClickTab:function(){var e=this.$route.params;this.$router.push({name:this.activeRouteName,params:e})},handlePublish:function(){var e=Object(n.a)(Object(s.a)().mark((function e(){var t,a,n,r,c,u,o,l,d;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this.$route.params.topic],e.next=3,i.a.messageAccessService.checkMessageBeforePublish(t).catch((function(e){return console.log("err",e)}));case 3:a=e.sent,2e4==+(a||{}).code&&(n=this.headerInfo,r=n.url,c=n.dailyCall,u=void 0===c?null:c,o=n.tps,l=void 0===o?null:o,d={},(u||0===u)&&(d.dailyCall=u),(l||0===l)&&(d.tps=l),this.$router.push({name:"messageManagerPublish",params:{topic:r},query:d}));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},components:{HeaderInfo:r.a},name:"messageManagerDetail"},u=c,o=(a("c766"),a("2877")),l=Object(o.a)(u,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail-page"},[a("HeaderInfo",{attrs:{url:e.headerInfo.url,name:e.headerInfo.name,createUser:e.headerInfo.createUser,createTime:e.headerInfo.createTime,statusInfo:e.headerInfoStatus},scopedSlots:e._u([{key:"otherImage",fn:function(){return[a("span",{staticClass:"header-image"})]},proxy:!0}])},[a("el-button",{attrs:{type:"primary",disabled:e.headerInfoStatus.disabled},on:{click:e.handlePublish}},[e._v("发 布")])],1),a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClickTab},model:{value:e.activeRouteName,callback:function(t){e.activeRouteName=t},expression:"activeRouteName"}},[a("el-tab-pane",{attrs:{label:"基础数据",name:"messageManagerBasicInfo"}}),a("el-tab-pane",{attrs:{label:"消息文档",name:"messageManagerMessageDoc"}}),a("el-tab-pane",{attrs:{label:"订阅方",name:"messageManagerSubscriber"}}),a("el-tab-pane",{attrs:{label:"发布记录",name:"messageManagerPublishRecords"}})],1),a("div",{staticClass:"detail-content"},[a("router-view",{attrs:{status:e.status},on:{updateBasicInfo:e.updateBasicInfo,reloadBasicInfo:e.queryMessageBaseInfo}})],1)],1)}),[],!1,null,"27c11144",null);t.default=l.exports},a1e0:function(e,t,a){},a322:function(e,t,a){"use strict";var s=a("ad2b"),n={name:"HeaderInfo",props:{imagePath:{type:String|Function},url:{type:String,default:""},name:{type:String,default:""},createUser:{type:String,default:""},createTime:{type:String|Date,default:function(){return new Date}},statusInfo:{type:Object,default:function(){return{text:"",className:""}}}},computed:{computeCreateTime:function(){return s.a.timeInTable(this.createTime)}}},r=(a("43fc"),a("2877")),i=Object(r.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("header",{staticClass:"header-info"},[a("div",{staticClass:"header-info-top"},[a("div",{staticClass:"header-info__content"},[e.imagePath?a("div",{staticClass:"image-wrapper"},[a("img",{staticStyle:{width:"100%"},attrs:{src:e.imagePath}})]):e._t("otherImage"),a("div",{staticClass:"text-wrapper"},[a("div",{staticClass:"title-wrapper"},[a("p",{staticClass:"title"},[e._v(e._s(e.url)+"（"+e._s(e.name)+"）")]),a("span",{class:e.statusInfo.className+" showStatus"},[e._v("● "+e._s(e.statusInfo.text))])]),a("p",{staticClass:"subtitle"},[e._v(" "+e._s(e.createUser)+" 创建于 "+e._s(e.computeCreateTime)+" ")])])],2),a("div",{staticClass:"header-info__button-wrapper"},[e._t("default")],2)]),a("div",{staticClass:"header-info-bottom"},[e._t("hintContent")],2)])}),[],!1,null,"2c213686",null);t.a=i.exports},ad2b:function(e,t,a){"use strict";a("28a5"),a("a481");var s={timeInTable:function(e){"string"==typeof e&&e.replace(".000+0000","");var t=new Date(e);return e?"".concat(t.toLocaleDateString().replaceAll("/","-")," ").concat(t.toTimeString().split(" ")[0]):""}};t.a=s},c766:function(e,t,a){"use strict";a("a1e0")},d14b:function(e,t,a){}}]);