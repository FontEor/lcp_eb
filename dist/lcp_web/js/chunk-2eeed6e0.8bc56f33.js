(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2eeed6e0"],{"049e":function(e,t,r){},"086c":function(e,t,r){"use strict";r.r(t);var a,n,o=(r("7f7f"),r("c7eb")),i=(r("96cf"),r("1da1")),s=(r("6762"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[1===e.num?r("SubscribeList",{attrs:{tenementInfo:e.tenementInfo,systemMessage:e.systemMessage},on:{next:e.updateNum}}):e._e(),2===e.num?r("SubscribeVersion",{attrs:{tenementInfo:e.tenementInfo,systemMessage:e.systemMessage},on:{back:e.updateNum}}):e._e()],1)}),c=r("b775"),l=r("ed08"),u=r("333d"),d=r("7a3a"),p={props:{tenementInfo:Object,systemMessage:Object},components:{TagTip:function(){return Promise.resolve().then(r.bind(null,"3c94"))},Pagination:u.a},data:function(){var e=this;return{subscribeTable:[],listQuery:{total:1,pageNumb:1,pageSize:10,pageSizes:[10,20,40,60]},dialog:!1,subscribeForm:{productId:"",code:"",name:"",createType:1,supplierId:-1,tenementName:"",pin:"",passWord1:"",passWord2:"",remark:""},tenant:{},tenantOptions:[],rules:{tenementName:[{required:!0,message:"请输入租户名称"}],pin:[{required:!0,message:"请输入租户主账号名"}],passWord1:[{required:!0,message:"请输入密码"},{min:6,max:20,message:"长度在 6 到 20 个字符"}],passWord2:[{required:!0,message:"请再次输入密码"},{validator:function(t,r,a){e.subscribeForm.passWord1,e.subscribeForm.passWord1!==r?a(new Error("密码不一致")):a()}}]},loading:!0,hrefHelpDocument:"//lcp.jdl.com/#/newHand/53054"}},filters:{parseTimefilter:function(e,t){return e?Object(l.c)(e,t):""}},methods:{getSubscribeList:function(){var e=this;this.systemMessage;Object(c.a)({url:"/product/subscribe/list",method:"get",params:{productId:this.systemMessage.id,pageSize:this.listQuery.pageSize,pageNumb:this.listQuery.pageNumb}}).then((function(t){e.listQuery.total=t.data.total,e.subscribeTable=t.data.list,e.loading=!1})).catch((function(e){}))},rowClassName:function(e){var t=e.row,r=e.rowIndex;t.number=r+1},createSubscribe:function(){this.systemMessage,this.subscribeForm.productId=this.systemMessage.id,this.subscribeForm.code=this.systemMessage.code,this.subscribeForm.name=this.systemMessage.name,this.dialog=!0},searchVersion:function(e,t,r){this.tenementInfo.id=e,this.tenementInfo.tenementName=t,this.tenementInfo.tenementCode=r,this.$emit("next")},deleteSubscribe:function(e){},paginationChange:function(e){this.listQuery.pageNumb=e.page,this.listQuery.pageSize=e.limit,this.getSubscribeList()},onClose:function(e){this.cleanDialog(),e()},onCancel:function(){this.cleanDialog(),this.dialog=!1},cleanDialog:function(){this.$refs.subscribeForm.resetFields(),this.tenant={}},selectCreateType:function(e){1===e&&(this.subscribeForm.pin="",this.subscribeForm.passWord1="",this.subscribeForm.passWord2=""),this.subscribeForm.tenementName="",this.subscribeForm.remark=""},saveSubscribe:function(){var e=this;1===this.subscribeForm.createType&&this.$refs.subscribeForm.validate((function(t){if(t){var r={productId:e.subscribeForm.productId,createType:e.subscribeForm.createType,supplierId:e.subscribeForm.supplierId,remark:e.subscribeForm.remark};Object(c.a)({url:"/product/subscribe/create",method:"post",data:r}).then((function(t){2e4===t.code?(d.Message.success("创建成功"),e.getSubscribeList(),e.cleanDialog(),e.dialog=!1):d.Message.error(t.message)})).catch((function(e){}))}})),2===this.subscribeForm.createType&&this.$refs.subscribeForm.validate((function(t){t&&(e.$refs.subscribeForm.resetFields(),e.dialog=!1)}))},querySearch:function(e){null!==e&&""!==e.trim()&&this.getTenemenList(e)},handleSelect:function(e){this.subscribeForm.tenementName,this.subscribeForm.tenementName=e.name,this.subscribeForm.supplierId=e.id},getTenemenList:function(e){var t=this;Object(c.a)({url:"/user/fuzzy/queryOuterSupplier",method:"post",params:{supplierName:e}}).then((function(e){t.tenantOptions=[];for(var r=0;r<e.data.length;r++)t.tenantOptions.push({id:e.data[r].id,name:e.data[r].name,code:e.data[r].tenementCode})})).catch((function(e){}))}},mounted:function(){this.getSubscribeList(),this.systemMessage}},m=p,f=(r("8b9c"),r("2877")),h=Object(f.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.subscribeTable.length<1&&!1===e.loading?a("div",[a("br"),a("br"),a("br"),a("br"),a("br"),a("el-row",[a("el-col",{attrs:{offset:4,span:16}},[a("img",{attrs:{src:r("751f"),width:"100%"}})])],1),a("br"),a("el-row",[a("el-col",{staticStyle:{"text-align":"center"},attrs:{offset:11,span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:e.createSubscribe}},[e._v("创建订阅")])],1)],1)],1):e._e(),e.subscribeTable.length>0?a("div",[a("div",[a("TagTip",{attrs:{closable:!1}},[e._v(" 了解更多请看 "),a("a",{staticClass:"anchor initColor",attrs:{href:e.hrefHelpDocument,target:"_blank"}},[e._v("新手帮助文档")])])],1),a("el-row",[a("el-col",{attrs:{offset:12,span:12}},[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:e.createSubscribe}},[e._v("创建订阅")])],1)],1),a("br"),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.subscribeTable,"row-class-name":e.rowClassName,"header-cell-style":{"text-align":"left"}}},[a("el-table-column",{attrs:{label:"序号",type:"index",align:"left",width:"64"}}),a("el-table-column",{attrs:{label:"租户名称",prop:"tenementName",align:"left"}}),a("el-table-column",{attrs:{label:"租户编码",prop:"tenementCode",align:"left"}}),a("el-table-column",{attrs:{label:"创建人",prop:"createUser",align:"left"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("parseTimefilter")(t.row.createTime,"{y}-{m}-{d} {h}:{i}")))])]}}],null,!1,655845935)}),a("el-table-column",{attrs:{label:"操作",prop:"id",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(r){return e.searchVersion(t.row.id,t.row.tenementName,t.row.tenementCode)}}},[e._v("查看版本")])]}}],null,!1,2746855686)})],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.listQuery.total,expression:"listQuery.total"}],staticStyle:{margin:"0px",float:"right"},attrs:{total:e.listQuery.total,pageSizes:e.listQuery.pageSizes,page:e.listQuery.pageNumb,limit:e.listQuery.pageSize},on:{"update:pageSizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page-sizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page":function(t){return e.$set(e.listQuery,"pageNumb",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.paginationChange}})],1)],1)],1):e._e(),a("div",[a("el-dialog",{attrs:{width:"40%",visible:e.dialog,title:"创建订阅","before-close":e.onClose},on:{"update:visible":function(t){e.dialog=t}}},[a("el-row",[a("el-col",{attrs:{offset:4,span:16}},[a("el-form",{ref:"subscribeForm",attrs:{rules:e.rules,model:e.subscribeForm,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"软件系统编码:",prop:"code"}},[a("el-input",{attrs:{disabled:""},model:{value:e.subscribeForm.code,callback:function(t){e.$set(e.subscribeForm,"code",t)},expression:"subscribeForm.code"}})],1),a("el-form-item",{attrs:{label:"软件系统名称:",prop:"name"}},[a("el-input",{attrs:{disabled:""},model:{value:e.subscribeForm.name,callback:function(t){e.$set(e.subscribeForm,"name",t)},expression:"subscribeForm.name"}})],1),a("el-form-item",{attrs:{label:"创建方式:",prop:"createType"}},[a("el-radio-group",{on:{change:e.selectCreateType},model:{value:e.subscribeForm.createType,callback:function(t){e.$set(e.subscribeForm,"createType",t)},expression:"subscribeForm.createType"}},[a("el-radio",{attrs:{label:1}},[e._v("选择物流开放平台租户")])],1)],1),a("el-form-item",{attrs:{label:"租户名称:",prop:"tenementName"}},[1===e.subscribeForm.createType?a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","remote-method":e.querySearch,"value-key":"id",placeholder:"请输入租户名称"},on:{change:e.handleSelect},model:{value:e.tenant,callback:function(t){e.tenant=t},expression:"tenant"}},e._l(e.tenantOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.code))])])})),1):e._e(),2===e.subscribeForm.createType?a("el-input",{attrs:{placeholder:"请输入租户名称"},model:{value:e.subscribeForm.tenementName,callback:function(t){e.$set(e.subscribeForm,"tenementName",t)},expression:"subscribeForm.tenementName"}}):e._e()],1),2===e.subscribeForm.createType?a("div",[a("el-form-item",{attrs:{label:"租户主账号名:",prop:"pin"}},[a("el-input",{model:{value:e.subscribeForm.pin,callback:function(t){e.$set(e.subscribeForm,"pin",t)},expression:"subscribeForm.pin"}})],1),a("el-form-item",{attrs:{label:"密码:",prop:"passWord1"}},[a("el-input",{attrs:{"show-password":""},model:{value:e.subscribeForm.passWord1,callback:function(t){e.$set(e.subscribeForm,"passWord1",t)},expression:"subscribeForm.passWord1"}})],1),a("el-form-item",{attrs:{label:"再次输入密码:",prop:"passWord2"}},[a("el-input",{attrs:{"show-password":""},model:{value:e.subscribeForm.passWord2,callback:function(t){e.$set(e.subscribeForm,"passWord2",t)},expression:"subscribeForm.passWord2"}})],1)],1):e._e(),a("el-form-item",{attrs:{label:"备注:",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:3},placeholder:"请输入内容",maxlength:"120","show-word-limit":""},model:{value:e.subscribeForm.remark,callback:function(t){e.$set(e.subscribeForm,"remark",t)},expression:"subscribeForm.remark"}})],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"default"},on:{click:e.onCancel}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveSubscribe}},[e._v("确定")])],1)],1)],1)])}),[],!1,null,"450c6700",null),b=h.exports,g=r("6ea4"),v=(r("386d"),{props:{tenementInfo:Object,systemMessage:Object,subscribeVersionForm:Object},data:function(){var e=this;return{rules:{versionName:[{required:!0,validator:function(t,r,a){e.versionInfo,e.versionInfo.id,null!==e.versionInfo.id&&void 0!==e.versionInfo.id?a():a(new Error("请选择版本"))}}]},versionInfo:{},versionOptions:[],queryVersionOptions:[]}},methods:{onCancel:function(){this.$emit("onCancel")},next:function(){var e=this;this.$refs.subscribeVersionForm.validate((function(t){if(!t)return!1;e.$emit("next")}))},querySearch:function(e){if(null!==e&&""!==e.trim()){this.queryVersionOptions=[];for(var t=0;t<this.versionOptions.length;t++)-1!==this.versionOptions[t].name.search(e)&&this.queryVersionOptions.push(this.versionOptions[t])}else this.queryVersionOptions=this.versionOptions},handleSelect:function(e){this.subscribeVersionForm.versionId=e.id,this.subscribeVersionForm.versionCode=e.code,this.subscribeVersionForm.versionName=e.name},getVersionOptions:function(){var e=this;Object(c.a)({url:"/sysVersion/queryVersionList",method:"post",data:{productId:this.systemMessage.id,category:"MENUTREE",pageNum:1,pageSize:500}}).then((function(t){t.data,e.versionOptions=[];for(var r=0;r<t.data.list.length;r++)e.versionOptions.push({id:t.data.list[r].id,name:t.data.list[r].versionName,code:t.data.list[r].versionCode});e.queryVersionOptions=e.versionOptions})).catch((function(e){}))}},mounted:function(){0!==this.subscribeVersionForm.versionId&&(this.versionInfo.id=this.subscribeVersionForm.versionId,this.versionInfo.code=this.subscribeVersionForm.versionCode,this.versionInfo.name=this.subscribeVersionForm.versionName),this.getVersionOptions()}}),y=v,w=(r("9dbb"),Object(f.a)(y,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",[r("el-col",{attrs:{offset:3,span:16}},[r("el-form",{ref:"subscribeVersionForm",attrs:{rules:e.rules,model:e.subscribeVersionForm,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"租户名称:",prop:"tenementName"}},[r("el-input",{attrs:{disabled:""},model:{value:e.subscribeVersionForm.tenementName,callback:function(t){e.$set(e.subscribeVersionForm,"tenementName",t)},expression:"subscribeVersionForm.tenementName"}})],1),r("el-form-item",{attrs:{label:"租户编码:",prop:"tenementCode"}},[r("el-input",{attrs:{disabled:""},model:{value:e.subscribeVersionForm.tenementCode,callback:function(t){e.$set(e.subscribeVersionForm,"tenementCode",t)},expression:"subscribeVersionForm.tenementCode"}})],1),r("el-form-item",{attrs:{label:"版本:",prop:"versionName"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","remote-method":e.querySearch,"value-key":"id",placeholder:"请选择版本"},on:{change:e.handleSelect},model:{value:e.versionInfo,callback:function(t){e.versionInfo=t},expression:"versionInfo"}},e._l(e.queryVersionOptions,(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.code))])])})),1)],1),r("el-form-item",{attrs:{label:"备注:",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:3},maxlength:"120",placeholder:"请输入内容","show-word-limit":""},model:{value:e.subscribeVersionForm.remark,callback:function(t){e.$set(e.subscribeVersionForm,"remark",t)},expression:"subscribeVersionForm.remark"}})],1)],1)],1)],1),r("br"),r("div",{staticClass:"select-version-btn"},[r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"default"},on:{click:e.onCancel}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.next}},[e._v("下一步")])],1)])],1)}),[],!1,null,"43602434",null)),x=w.exports,D={props:{systemMessage:Object,tenementInfo:Object,subscribeVersionForm:Object},data:function(){return{checkList:[],environment:[],disabledEnvId:[]}},methods:{onCancel:function(){this.$emit("onCancel")},next:function(){if(this.environment,this.checkList,this.checkList.length<1)this.$message.error("请选择要开通的环境");else{for(var e=0;e<this.checkList.length;e++)this.openVersion(this.checkList[e]);this.$emit("next")}},back:function(){this.$emit("back")},getEnvironment:function(){var e=this;Object(c.a)({url:"/product/env/get",method:"get",params:{productId:this.systemMessage.id,type:"USF"}}).then((function(t){for(var r=0;r<t.data.length;r++)e.environment.push({id:t.data[r].id,name:t.data[r].name,description:t.data[r].description})})).catch((function(e){}))},getProhibitedEnvironment:function(){var e=this;Object(c.a)({url:"/saas/system/tenement/version/activate/activatedEnvs",method:"get",params:{productId:this.systemMessage.id,tenementId:this.tenementInfo.id}}).then((function(t){for(var r=0;r<t.data.length;r++)e.disabledEnvId.push(t.data[r].id)})).catch((function(e){}))},isDisabled:function(e){for(var t=0;t<this.disabledEnvId.length;t++)if(this.disabledEnvId[t]===e)return!0;return!1},openVersion:function(e){Object(c.a)({url:"/saas/system/tenement/version/activate/open",method:"post",data:{productId:this.systemMessage.id,tenementId:this.tenementInfo.id,versionId:this.subscribeVersionForm.versionId,envId:e,remark:this.subscribeVersionForm.remark}}).then((function(e){})).catch((function(e){}))}},mounted:function(){this.getProhibitedEnvironment(),this.getEnvironment(),this.subscribeVersionForm}},C=D,S=(r("9cd8"),Object(f.a)(C,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",[r("el-col",{attrs:{offset:2,span:20}},[e._v(" 开通之后，若客户端不存在该软件系统或租户则会先进行创建，然后再将资源下发至软件系统；若客户端已存在该租户和软件系统，则仅将本次变更的资源下发至所选的环境。 ")])],1),r("br"),r("el-row",[r("el-col",{attrs:{offset:2,span:6}},[r("span",{staticStyle:{"font-weight":"bold"}},[e._v("请选择开通环境:")])])],1),r("br"),e._l(e.environment,(function(t){return r("div",{key:t.id},[r("el-row",[r("el-col",{attrs:{offset:3,span:16}},[r("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[r("div",[e.isDisabled(t.id)?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"当前版本已开通或正在开通该环境",placement:"bottom-start"}},[r("el-checkbox",{attrs:{label:t.id,disabled:""}},[e._v(e._s(t.name)+" ")])],1):r("el-checkbox",{attrs:{label:t.id}},[e._v(e._s(t.name)+" ")])],1)]),r("div",[r("span",{staticStyle:{color:"#999"}},[e._v("("+e._s(t.description)+")")])])],1)],1),r("br")],1)})),r("div",{staticClass:"select-env-btn"},[r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"default"},on:{click:e.back}},[e._v("上一步")]),r("el-button",{attrs:{type:"primary"},on:{click:e.next}},[e._v("开通")])],1)])],2)}),[],!1,null,"84eb11d4",null)),O=S.exports,k={methods:{onCancel:function(){this.$emit("onCancel")}}},_=(r("7469"),Object(f.a)(k,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{align:"center"}},[r("el-row",[r("el-col",{attrs:{offset:2,span:20}},[e._v(" 版本正在开通中，预计需要1-2分钟完成开通，开通结果将通过邮件/咚咚告知。 ")])],1),r("el-row",[r("el-col",{attrs:{offset:2,span:20}},[e._v("您可以关闭当前弹窗去进行其他操作")])],1),r("br"),r("br"),r("br"),r("br"),r("br"),r("br"),r("br"),r("div",{staticClass:"finish-btn"},[r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.onCancel}},[e._v("完成")])],1)])],1)}),[],!1,null,"cfd2e2dc",null)),j=_.exports,T=r("6f81"),N={props:{tenementInfo:Object,systemMessage:Object},components:{TagTip:function(){return Promise.resolve().then(r.bind(null,"3c94"))},Pagination:u.a,steps:g.a,SelectVersion:x,SelectEnvironment:O,Finish:j},data:function(){return{openVersionDisabled:!1,subscribeVersionTable:[],listQuery:{total:1,pageNumb:1,pageSize:10,pageSizes:[10,20,40,60]},dialog:!1,stepsObj:{},stepsList:[{active:0,tiptitle:["选择版本","选择同步环境","完成"]},{active:1,tiptitle:["选择版本","选择同步环境","完成"]},{active:2,tiptitle:["选择版本","选择同步环境","完成"]}],progress:0,closeDialog:!1,colseVersionId:0,subscribeVersionForm:{},hrefHelpDocument:"//lcp.jdl.com/#/newHand/53054"}},filters:{parseTimefilter:function(e,t){return e?Object(l.c)(e,t):""}},methods:{activatedEnvs:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.systemMessage.id,r=this.tenementInfo.id,a={productId:t,tenementId:r},e.next=5,T.a.activatedEnvs(a).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("activatedEnvs")}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),envGet:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.systemMessage.id,"USF",r={productId:t,type:"USF"},e.next=5,T.a.envGet(r).catch((function(e){var t=e.data.message;throw t&&a.$message.error(t),new Error("envGet")}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),checkOpenVersionDisabled:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.envGet().catch((function(){throw new Error("envGet")}));case 2:return t=e.sent,r=t.data.data,e.next=6,this.activatedEnvs().catch((function(){throw new Error("activatedEnvs")}));case 6:a=e.sent,n=a.data.data,this.openVersionDisabled=r.every((function(e){var t=e.id;return n.some((function(e){return t===e.id}))}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),back:function(){this.$emit("back")},createVersion:function(){this.openVersionDisabled||(this.stepsObj=this.stepsList[this.progress],this.dialog=!0)},paginationChange:function(e){this.listQuery.pageNumb=e.page,this.listQuery.pageSize=e.limit,this.getActivateVersionList()},onClose:function(e){this.refresh(),e(),this.progress=0},onCancel:function(){this.refresh(),this.progress=0,this.dialog=!1},refresh:function(){this.initSubscribeVersionForm(),this.getActivateVersionList()},initSubscribeVersionForm:function(){this.subscribeVersionForm={tenementName:this.tenementInfo.tenementName,tenementCode:this.tenementInfo.tenementCode,versionId:0,versionCode:"",versionName:"",remark:""}},previous:function(){this.progress>0&&(this.progress--,this.stepsObj=this.stepsList[this.progress])},next:function(){this.progress<2&&(this.progress++,this.stepsObj=this.stepsList[this.progress])},closeVersion:function(e){this.closeDialog=!0,this.colseVersionId=e},deleteVersion:function(){var e=this;if(0!==this.colseVersionId){Object(c.a)({url:"/saas/system/tenement/version/activate/close",method:"post",params:{activateId:this.colseVersionId}}).then((function(t){2e4===t.code?(e.colseVersionId=0,e.closeDialog=!1,e.getActivateVersionList()):e.$message.error(t.message)})).catch((function(e){}))}},statusDisabled:function(e){return 2!==e&&6!=e},rowClassName:function(e){var t=e.row,r=e.rowIndex;t.number=r+1},getActivateVersionList:function(){var e=this;Object(c.a)({url:"/saas/system/tenement/version/activate/list",method:"get",params:{productId:this.systemMessage.id,tenementId:this.tenementInfo.id,pageSize:this.listQuery.pageSize,pageNumb:this.listQuery.pageNumb}}).then((function(t){t.data,e.listQuery.total=t.data.total,e.subscribeVersionTable=t.data.list})).catch((function(e){}))},getColor:function(e){return 0===e?"initColor":1===e||4===e?"updateColor":2===e?"normalColor":3===e||4===e?"unknownColor":5==e?"deadColor":void 0}},mounted:function(){this.refresh(),this.checkOpenVersionDisabled()}},E=N,I=(r("197d"),Object(f.a)(E,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"subscribe-version"},[r("div",[r("TagTip",{attrs:{closable:!1}},[e._v(" 可在当前页给租户开通版本 "),r("a",{staticClass:"anchor initColor",attrs:{href:e.hrefHelpDocument,target:"_blank"}},[e._v("新手帮助文档")])])],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-page-header",{attrs:{content:"版本详情"},on:{back:e.back}})],1),r("el-col",{attrs:{span:12}},[e.openVersionDisabled?r("el-tooltip",{attrs:{content:"当前租户已开通版本，若要修改版本请回收当前版本再下发。",placement:"top-end"}},[r("el-button",{staticClass:"open-version--disabled",staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:e.createVersion}},[e._v("开通版本")])],1):r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:e.createVersion}},[e._v("开通版本")])],1)],1),r("br"),r("el-table",{attrs:{data:e.subscribeVersionTable,"row-class-name":e.rowClassName,"header-cell-style":{"text-align":"left"}}},[r("el-table-column",{attrs:{label:"序号",type:"index",align:"left",width:"64"}}),r("el-table-column",{attrs:{label:"版本名称",prop:"versionName",align:"left"}}),r("el-table-column",{attrs:{label:"版本号",prop:"versionCode"}}),r("el-table-column",{attrs:{label:"开通环境",prop:"envName",align:"left"}}),r("el-table-column",{attrs:{label:"开通状态",prop:"statusName",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{class:e.getColor(t.row.status)},[e._v(" "+e._s(t.row.statusName)+" ")])]}}])}),r("el-table-column",{attrs:{label:"操作人",prop:"createUser",align:"left"}}),r("el-table-column",{attrs:{label:"开通时间",prop:"createTime",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e._f("parseTimefilter")(t.row.createTime,"{y}-{m}-{d} {h}:{i}")))])]}}])}),r("el-table-column",{attrs:{label:"操作",prop:"activateId",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",disabled:e.statusDisabled(t.row.status)},on:{click:function(r){return e.closeVersion(t.row.activateId)}}},[e._v("关闭版本")])]}}])})],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.listQuery.total,expression:"listQuery.total"}],staticStyle:{margin:"0px",float:"right"},attrs:{total:e.listQuery.total,pageSizes:e.listQuery.pageSizes,page:e.listQuery.pageNumb,limit:e.listQuery.pageSize},on:{"update:pageSizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page-sizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page":function(t){return e.$set(e.listQuery,"pageNumb",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.paginationChange}})],1)],1),r("div",[r("el-dialog",{attrs:{width:"40%",visible:e.dialog,title:"开通版本","before-close":e.onClose},on:{"update:visible":function(t){e.dialog=t},close:e.checkOpenVersionDisabled}},[r("steps",e._b({},"steps",e.stepsObj,!1)),0==e.progress&&e.dialog?r("SelectVersion",{attrs:{tenementInfo:e.tenementInfo,systemMessage:e.systemMessage,subscribeVersionForm:e.subscribeVersionForm},on:{next:e.next,onCancel:e.onCancel}}):e._e(),1==e.progress&&e.dialog?r("SelectEnvironment",{attrs:{tenementInfo:e.tenementInfo,systemMessage:e.systemMessage,subscribeVersionForm:e.subscribeVersionForm},on:{next:e.next,back:e.previous,onCancel:e.onCancel}}):e._e(),2==e.progress?r("Finish",{on:{onCancel:e.onCancel}}):e._e()],1)],1),r("div",[r("el-dialog",{attrs:{title:"确认关闭",visible:e.closeDialog,width:"40%"},on:{"update:visible":function(t){e.closeDialog=t},close:e.checkOpenVersionDisabled}},[r("span",[e._v("关闭后，下发给该租户的资源一并删除，已授权用户将没有权限。")]),r("span",{staticStyle:{color:"red"}},[e._v("谨慎操作！")]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.closeDialog=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.deleteVersion()}}},[e._v("确 定")])],1)])],1)],1)}),[],!1,null,"b0fe8608",null)),F=I.exports,$={components:{SubscribeList:b,SubscribeVersion:F},data:function(){return{tenementInfo:{},systemMessage:{},num:0}},methods:{updateNum:function(){1===this.num?this.num=2:this.num=1},fetchProductSummary:function(e){var t=this;Object(c.a)({url:"/product",method:"get",params:{id:e}}).then((function(e){t.systemMessage=e.data,t.num=1})).catch((function(e){}))}},created:function(){this.fetchProductSummary(this.$route.params.id)}},L=$,V=Object(f.a)(L,s,[],!1,null,"23b52fe0",null),P=V.exports,R=(r("ac6a"),r("28a5"),r("2a6f")),q=r("c24f"),z={name:"ProductBasicInfo",components:{StickyWrapper:R.a},props:{editable:{type:Boolean,required:!0},secondaryDevelopment:{type:String,required:!0}},data:function(){return{env:window.env.buildEnv,loading:!0,uatDomainNameEditable:!1,domainNameEditable:!1,addProdPinData:{zhanghaos:[],loading:!1,value:"",realName:"",mobile:"",email:"",realNameEdit:!0,mobileEdit:!0,emailEdit:!0},addDevPinData:{zhanghaos:[],loading:!1,value:"",realName:"",mobile:"",email:"",realNameEdit:!0,mobileEdit:!0,emailEdit:!0},oldProdSummaryForm:{id:"",oldName:"",code:"",oldScope:"",oldDescription:"",oldDevelopOwner:"",oldProductOwner:"",classify:""},prodSummaryForm:{id:"",name:"",scope:"",code:"",status:"",description:"",developOwner:"",productOwner:"",classify:""},scopeEnum:[{id:1,name:"外网"},{id:2,name:"内网"}],classifyEnum:[{id:"oms",name:"订单"},{id:"wms",name:"仓储"},{id:"tms",name:"配运"},{id:"data_algorithm",name:"数据算法"},{id:"tech",name:"基础技术"}],rules:{productOwner:[{required:!0,message:"请输入产品负责人京东账号",trigger:["blur","change"]}],developOwner:[{required:!0,message:"请输入研发负责人京东账号",trigger:["blur","change"]}],name:[{required:!0,message:"请输入系统名称",trigger:["blur","change"]},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:["blur","change"]}],classify:[{required:!0,message:"请选择产品分类",trigger:["blur","change"]}],prodPin:[{required:!0,message:"请输入产品负责人",trigger:"blur"}],devPin:[{required:!0,message:"请输入研发负责人",trigger:"blur"}],description:[{required:!0,message:"请输入系统描述",trigger:["blur","change"]},{min:2,max:255,message:"长度在 2 到 255 个字符",trigger:["blur","change"]}],uatDomainName:[{required:!0,message:"请输入环境域名"},{pattern:/^[\w-]+(\.[\w-]+)+([\w.-]*[\w-])?$/,message:"只允许输入英文字母、数字、“-”和“.”，且“-”和“.”不能出现在开头或者结尾",trigger:"blur"},{min:3,max:45,message:"长度在 3 到 45 个字符"}],domainName:[{required:!0,message:"请输入环境域名"},{pattern:/^[\w-]+(\.[\w-]+)+([\w.-]*[\w-])?$/,message:"只允许输入英文字母、数字、“-”和“.”，且“-”和“.”不能出现在开头或者结尾",trigger:"blur"},{min:3,max:45,message:"长度在 3 到 45 个字符"}],secondaryDevelopment:[{required:!0,message:"请选择是否支持二次开发"}]}}},computed:{mainProdPlaceHolder:function(){return"请输入产品负责人京东账号"},mainDevPlaceHolder:function(){return"请输入研发负责人京东账号"},descriptionPlaceHolder:function(){return"描述系统功能,2-255个字符"},computeSecondaryDevelopmentText:function(){var e=this.prodSummaryForm.secondaryDevelopment;if(e){return{0:"不支持",1:"支持"}[e]}return"未选择"}},watch:{"prodSummaryForm.domainName":{handler:function(e){"uat"!==this.env&&"prod"!==this.env&&(this.prodSummaryForm.uatDomainName=e)}}},methods:{fetchProdSummary:function(){var e=this;Object(c.a)({url:"/product",method:"get",params:{id:this.$route.params.id}}).then((function(t){e.$emit("update:secondaryDevelopment",t.data.secondaryDevelopment||""),e.prodSummaryForm=t.data;var r=t.data,a=r.uatDomainName,n=r.domainName;e.uatDomainNameEditable=!a,e.domainNameEditable=!n,e.$emit("updateTitle",e.prodSummaryForm),delete e.prodSummaryForm.createTime,delete e.prodSummaryForm.updateTime,delete e.prodSummaryForm.ts,e.oldProdSummaryForm.oldName=e.prodSummaryForm.name,e.oldProdSummaryForm.oldScope=e.prodSummaryForm.scope,e.oldProdSummaryForm.oldStatus=e.prodSummaryForm.status,e.oldProdSummaryForm.code=e.prodSummaryForm.code,e.oldProdSummaryForm.oldDescription=e.prodSummaryForm.description,e.oldProdSummaryForm.classify=e.prodSummaryForm.classify,e.oldProdSummaryForm.uatDomainName=e.prodSummaryForm.uatDomainName,e.oldProdSummaryForm.domainName=e.prodSummaryForm.domainName,e.oldProdSummaryForm.secondaryDevelopment=e.prodSummaryForm.secondaryDevelopment||"",e.prodSummaryForm.productOwner&&(e.addProdPinData.value=e.prodSummaryForm.productOwner.split(":")[0],e.addProdPinData.realName=e.prodSummaryForm.productOwner.split(":")[1],e.oldProdSummaryForm.oldProductOwner=e.addProdPinData.value),e.prodSummaryForm.developOwner&&(e.addDevPinData.value=e.prodSummaryForm.developOwner.split(":")[0],e.addDevPinData.realName=e.prodSummaryForm.developOwner.split(":")[1],e.oldProdSummaryForm.oldDevelopOwner=e.addDevPinData.value),e.loading=!1})).catch((function(t){e.loading=!1}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var r=t.prodSummaryForm,a=JSON.parse(JSON.stringify(r)),n=t.uatDomainNameEditable,o=t.domainNameEditable;(!n||!o)&&delete a.uatDomainName&&delete a.domainName,Object(c.a)({url:"/product/edit",method:"post",params:a,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){t.$message.success("软件系统信息修改成功"),t.$emit("update:editable",!1),t.fetchProdSummary()})).catch((function(e){t.$message.error("产品信息修改失败"+e)}))}))},editForm:function(e){this.$emit("update:editable",!0)},resetForm:function(e){this.$emit("update:editable",!1),this.$refs[e].clearValidate(),this.prodSummaryForm.name=this.oldProdSummaryForm.oldName,this.prodSummaryForm.scope=this.oldProdSummaryForm.oldScope,this.prodSummaryForm.description=this.oldProdSummaryForm.oldDescription,this.prodSummaryForm.classify=this.oldProdSummaryForm.classify,this.prodSummaryForm.uatDomainName=this.oldProdSummaryForm.uatDomainName,this.prodSummaryForm.domainName=this.oldProdSummaryForm.domainName,this.prodSummaryForm.secondaryDevelopment=this.oldProdSummaryForm.secondaryDevelopment||"",""!==this.oldProdSummaryForm.oldProductOwner?this.prodSummaryForm.productOwner=this.oldProdSummaryForm.oldProductOwner+":"+this.addProdPinData.realName:this.prodSummaryForm.productOwner="",""!==this.oldProdSummaryForm.oldDevelopOwner?this.prodSummaryForm.developOwner=this.oldProdSummaryForm.oldDevelopOwner+":"+this.addDevPinData.realName:this.prodSummaryForm.developOwner="",this.addProdPinData.value=this.oldProdSummaryForm.oldProductOwner,this.addDevPinData.value=this.oldProdSummaryForm.oldDevelopOwner},searchProdPin:function(e){var t=this;""!==e?(this.addProdPinData.loading=!0,setTimeout((function(){Object(q.c)(e).then((function(e){t.addProdPinData.loading=!1,t.addProdPinData.zhanghaos=e.data})).catch((function(e){}))}),200)):this.addProdPinData.zhanghaos=[]},searchDevPin:function(e){var t=this;""!==e?(this.addDevPinData.loading=!0,setTimeout((function(){Object(q.c)(e).then((function(e){t.addDevPinData.loading=!1,t.addDevPinData.zhanghaos=e.data})).catch((function(e){}))}),200)):this.addDevPinData.zhanghaos=[]},prodPinSelectChange:function(e){var t=this;this.addProdPinData.realName="",this.addProdPinData.mobile="",this.addProdPinData.email="",this.addProdPinData.zhanghaos.forEach((function(r,a){e===r.userName&&(r.realName?(t.addProdPinData.realNameEdit=!0,t.addProdPinData.realName=r.realName):t.addProdPinData.realNameEdit=!1,r.mobile?(t.addProdPinData.mobileEdit=!0,t.addProdPinData.mobile=r.mobile):t.addProdPinData.mobileEdit=!1,r.email?(t.addProdPinData.emailEdit=!0,t.addProdPinData.email=r.email):t.addProdPinData.emailEdit=!1,t.prodSummaryForm.productOwner=r.userName+":"+r.realName,t.addProdPinData.realName=r.realName)}))},devPinSelectChange:function(e){var t=this;this.addDevPinData.realName="",this.addDevPinData.mobile="",this.addDevPinData.email="",this.addDevPinData.zhanghaos.forEach((function(r,a){e===r.userName&&(r.realName?(t.addDevPinData.realNameEdit=!0,t.addDevPinData.realName=r.realName):t.addDevPinData.realNameEdit=!1,r.mobile?(t.addDevPinData.mobileEdit=!0,t.addDevPinData.mobile=r.mobile):t.addDevPinData.mobileEdit=!1,r.email?(t.addDevPinData.emailEdit=!0,t.addDevPinData.email=r.email):t.addDevPinData.emailEdit=!1,t.prodSummaryForm.developOwner=r.userName+":"+r.realName,t.addDevPinData.realName=r.realName)}))},onCopy:function(e){this.$message.success("复制成功")},onError:function(e){this.$message.error("复制失败")}},created:function(){this.fetchProdSummary()}},M=z,A=(r("e33f"),Object(f.a)(M,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"product-basic-info"},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"mod-overview"},[r("el-form",{ref:"prodSummaryForm",staticClass:"overview-prodSummaryForm",attrs:{model:e.prodSummaryForm,rules:e.rules,disabled:!e.editable,"label-width":"140px","element-loading-text":"加载中"}},[r("el-form-item",{attrs:{label:"系统名称",prop:"name"}},[e.editable?r("el-input",{attrs:{placeholder:"系统中文名称"},model:{value:e.prodSummaryForm.name,callback:function(t){e.$set(e.prodSummaryForm,"name","string"==typeof t?t.trim():t)},expression:"prodSummaryForm.name"}}):e._e(),e.editable?e._e():r("span",[e._v(e._s(""===e.prodSummaryForm.name?"未填写":e.prodSummaryForm.name))])],1),r("el-form-item",{attrs:{label:"系统编码",prop:"code"}},[r("span",{staticClass:"copy-text"},[e._v(e._s(e.prodSummaryForm.code))]),r("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.prodSummaryForm.code,expression:"prodSummaryForm.code",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},[r("i",{staticClass:"el-icon-document-copy"})])]),r("el-form-item",{attrs:{label:"产品分类",prop:"classify"}},[e.editable?r("el-select",{attrs:{placeholder:"请选择产品分类"},model:{value:e.prodSummaryForm.classify,callback:function(t){e.$set(e.prodSummaryForm,"classify",t)},expression:"prodSummaryForm.classify"}},e._l(e.classifyEnum,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1):e._e(),e.editable?e._e():["oms"===e.prodSummaryForm.classify?r("span",[e._v("订单")]):"wms"===e.prodSummaryForm.classify?r("span",[e._v("仓储")]):"tms"===e.prodSummaryForm.classify?r("span",[e._v("配运")]):"data_algorithm"===e.prodSummaryForm.classify?r("span",[e._v("数据算法")]):"tech"===e.prodSummaryForm.classify?r("span",[e._v("基础技术")]):r("span",[e._v("未填写")])]],2),r("el-form-item",{attrs:{label:"发布范围",prop:"scope"}},[1===e.prodSummaryForm.scope?r("span",[e._v("外网")]):2===e.prodSummaryForm.scope?r("span",[e._v("内网")]):e._e()]),r("el-form-item",{attrs:{label:"产品负责人",prop:"productOwner"}},[e.editable?r("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:this.mainProdPlaceHolder,"remote-method":e.searchProdPin,loading:e.addProdPinData.loading,"popper-class":"erp-info-select"},on:{change:e.prodPinSelectChange},model:{value:e.addProdPinData.value,callback:function(t){e.$set(e.addProdPinData,"value",t)},expression:"addProdPinData.value"}},e._l(e.addProdPinData.zhanghaos,(function(t){return r("el-option",{key:t.userName,attrs:{label:t.userName,value:t.userName}},[r("div",{staticClass:"cbox ptb5"},[r("div",{staticClass:"avatar__wrapper"},[r("div",{style:{display:"inlineFlex",margin:"2px",width:"30px",height:"30px",borderRadius:"50%",background:"url("+t.headImg+") 0% 0% / 30px 30px no-repeat scroll content-box border-box transparent"}})]),r("div",{staticClass:"inputUsers__input__autocomplete--info vhbox"},[r("span",[e._v(e._s(t.userName)+" ("+e._s(t.realName)+")")]),r("span",[e._v(e._s(t.organizationFullName))])])])])})),1):e._e(),e.editable?e._e():r("span",[e._v(e._s(""===e.addProdPinData.value?"未填写":e.addProdPinData.value))])],1),r("el-form-item",{attrs:{label:"研发负责人",prop:"developOwner"}},[e.editable?r("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:this.mainDevPlaceHolder,"remote-method":e.searchDevPin,loading:e.addDevPinData.loading,"popper-class":"erp-info-select"},on:{change:e.devPinSelectChange},model:{value:e.addDevPinData.value,callback:function(t){e.$set(e.addDevPinData,"value",t)},expression:"addDevPinData.value"}},e._l(e.addDevPinData.zhanghaos,(function(t){return r("el-option",{key:t.userName,attrs:{label:t.userName,value:t.userName}},[r("div",{staticClass:"cbox ptb5"},[r("div",{staticClass:"avatar__wrapper"},[r("div",{style:{display:"inlineFlex",margin:"2px",width:"30px",height:"30px",borderRadius:"50%",background:"url("+t.headImg+") 0% 0% / 30px 30px no-repeat scroll content-box border-box transparent"}})]),r("div",{staticClass:"inputUsers__input__autocomplete--info vhbox"},[r("span",[e._v(e._s(t.userName)+" ("+e._s(t.realName)+")")]),r("span",[e._v(e._s(t.organizationFullName))])])])])})),1):e._e(),e.editable?e._e():r("span",[e._v(e._s(""===e.addDevPinData.value?"未填写":e.addDevPinData.value))])],1),r("el-form-item",{attrs:{label:"系统描述",prop:"description"}},[e.editable?r("el-input",{attrs:{type:"textarea",placeholder:this.descriptionPlaceHolder},model:{value:e.prodSummaryForm.description,callback:function(t){e.$set(e.prodSummaryForm,"description","string"==typeof t?t.trim():t)},expression:"prodSummaryForm.description"}}):e._e(),e.editable?e._e():r("span",[e._v(e._s(""===e.prodSummaryForm.description?"未填写":e.prodSummaryForm.description))])],1),"local"===e.env||"devtest"===e.env||"publictest"===e.env?[r("el-form-item",{attrs:{label:"测试环境域名",prop:"domainName"}},[e.editable?[e.domainNameEditable?r("el-input",{model:{value:e.prodSummaryForm.domainName,callback:function(t){e.$set(e.prodSummaryForm,"domainName","string"==typeof t?t.trim():t)},expression:"prodSummaryForm.domainName"}}):r("span",[r("span",{staticClass:"copy-text"},[e._v(e._s(e.prodSummaryForm.domainName))]),r("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.prodSummaryForm.domainName,expression:"prodSummaryForm.domainName",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},[r("i",{staticClass:"el-icon-document-copy"})])])]:r("span",[r("span",{staticClass:"copy-text"},[e._v(e._s(e.prodSummaryForm.domainName?e.prodSummaryForm.domainName:"未填写"))]),r("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.prodSummaryForm.domainName,expression:"prodSummaryForm.domainName",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},[r("i",{staticClass:"el-icon-document-copy"})])])],2)]:"uat"===e.env||"prod"===e.env?[r("el-form-item",{attrs:{label:"预发环境域名",prop:"uatDomainName"}},[e.editable?[e.uatDomainNameEditable?r("el-input",{model:{value:e.prodSummaryForm.uatDomainName,callback:function(t){e.$set(e.prodSummaryForm,"uatDomainName","string"==typeof t?t.trim():t)},expression:"prodSummaryForm.uatDomainName"}}):r("span",[r("span",{staticClass:"copy-text"},[e._v(e._s(e.prodSummaryForm.uatDomainName))]),r("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.prodSummaryForm.uatDomainName,expression:"prodSummaryForm.uatDomainName",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},[r("i",{staticClass:"el-icon-document-copy"})])])]:r("span",[r("span",{staticClass:"copy-text"},[e._v(e._s(e.prodSummaryForm.uatDomainName?e.prodSummaryForm.uatDomainName:"未填写"))]),r("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.prodSummaryForm.uatDomainName,expression:"prodSummaryForm.uatDomainName",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},[r("i",{staticClass:"el-icon-document-copy"})])])],2),r("el-form-item",{attrs:{label:"生产环境域名",prop:"domainName"}},[e.editable?[e.domainNameEditable?r("el-input",{model:{value:e.prodSummaryForm.domainName,callback:function(t){e.$set(e.prodSummaryForm,"domainName","string"==typeof t?t.trim():t)},expression:"prodSummaryForm.domainName"}}):r("span",[r("span",{staticClass:"copy-text"},[e._v(e._s(e.prodSummaryForm.domainName))]),r("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.prodSummaryForm.domainName,expression:"prodSummaryForm.domainName",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},[r("i",{staticClass:"el-icon-document-copy"})])])]:r("span",[r("span",{staticClass:"copy-text"},[e._v(e._s(e.prodSummaryForm.domainName?e.prodSummaryForm.domainName:"未填写"))]),r("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.prodSummaryForm.domainName,expression:"prodSummaryForm.domainName",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},[r("i",{staticClass:"el-icon-document-copy"})])])],2)]:e._e(),r("el-form-item",{attrs:{label:"是否支持二次开发",prop:"secondaryDevelopment"}},[e.editable?r("el-radio-group",{model:{value:e.prodSummaryForm.secondaryDevelopment,callback:function(t){e.$set(e.prodSummaryForm,"secondaryDevelopment",t)},expression:"prodSummaryForm.secondaryDevelopment"}},[r("el-radio",{attrs:{label:"1"}},[e._v("支持")]),r("el-radio",{attrs:{label:"0"}},[e._v("不支持")])],1):e._e(),e.editable?e._e():r("span",[e._v(e._s(e.computeSecondaryDevelopmentText))])],1)],2),r("StickyWrapper",[e.editable?r("div",{staticClass:"button-wrapper"},[r("el-button",{on:{click:function(t){return e.resetForm("prodSummaryForm")}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("prodSummaryForm")}}},[e._v("保存")])],1):r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editForm("prodSummaryForm")}}},[e._v("编辑")])],1)],1)])}),[],!1,null,"3505b500",null)),U=A.exports,B=r("5530"),G=(r("5df3"),r("1c4c"),r("3835")),H=r("180e"),J={name:"ProductIntroductionTable",props:{editable:{type:Boolean,required:!0},title:{type:String,required:!0},tableData:{type:Array,required:!0},editableTableData:{type:Array,required:!0},tableList:{type:Array,required:!0},productShowType:{type:String,required:!0},iconList:{type:Array},imageList:{type:Array}},data:function(){return{dialogVisible:!1,iconItem:"",imageItem:"",currentLabel:"",dataIndex:null}},computed:{computeDialogTitle:function(){return{"展示图标":"选择图标","展示配图":"选择配图"}[this.currentLabel]},computeRadioClass:function(){return{"展示图标":"icon-radio","展示配图":"image-radio"}[this.currentLabel]}},methods:{query:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"1",r={imgUseScenes:"1",imgType:t},e.next=4,H.a.query(r).catch((function(e){var t=e.data.message;throw t&&a.$message.error(t),new Error("load")}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),imageUpload:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("imageFile",t),e.next=4,H.a.imageUpload(r).catch((function(e){var t=e.data.message;throw t&&a.$message.error(t),new Error("imageUpload")}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),formatSelectButtonText:function(e){return{"展示图标":"选择图标","展示配图":"选择配图"}[e]},judgeMaxlength:function(e){return{title:10,describe:100}[e]},closeDialog:function(){this.currentLabel="",this.iconItem="",this.imageItem="",this.dataIndex=null},handleBannerChange:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,r){var a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return[].push(t),e.next=4,this.imageUpload(t.raw);case 4:a=e.sent,n=a.data.data,this.$message.success("上传图片成功！"),this.editableTableData[0].imgUrl=n;case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),handleAddRowData:function(){var e=this,t=this.tableList.reduce((function(t,r){return t[r.prop]="",t.productShowType=e.productShowType,t}),{});this.$emit("update:tableData","add",t)},handleDeleteRowData:function(e){this.$emit("update:tableData","delete",e)},handleSelectIconOrImage:function(e,t){this.currentLabel=e,this.dataIndex=t,this.dialogVisible=!0},handleSaveSelectIconOrImage:function(){var e=this.iconItem||this.imageItem,t=JSON.parse(e),r=Object(G.a)(t,2),a=r[0],n=r[1];this.editableTableData[this.dataIndex].imgConfigCode=a,this.editableTableData[this.dataIndex].imgUrl=n,this.dialogVisible=!1}}},Q=J,K=(r("889d"),Object(f.a)(Q,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"product-introduction-table"},[e.editable?[a("p",{staticClass:"form-row-title"},[e._v(e._s(e.title))]),"2"===e.productShowType?a("el-upload",{staticClass:"banner-uploader",attrs:{action:"","auto-upload":!1,"show-file-list":!1,"on-change":e.handleBannerChange}},[e.editableTableData[0].imgUrl?[a("img",{staticClass:"banner",attrs:{src:e.editableTableData[0].imgUrl,onerror:"this.src='"+r("f688")+"'"}})]:a("i",{staticClass:"el-icon-plus banner-uploader-icon"},[e._v("添加图片")]),a("p",{staticStyle:{color:"#8c939d"},attrs:{slot:"tip"},slot:"tip"},[e._v("建议上传图片宽度不小于1000px")])],2):[a("el-table",{attrs:{data:e.editableTableData,hideEmptyImg:!0}},[e._l(e.tableList,(function(t,r){return a("el-table-column",{key:r,attrs:{prop:t.prop,label:t.label,"min-width":t["min-width"]},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,n=t.column,o=t.$index;return["imgConfigCode"===n.property?[r[n.property]?a("img",{staticStyle:{cursor:"pointer",height:"32px"},attrs:{src:""+r.imgUrl},on:{click:function(t){return e.handleSelectIconOrImage(n.label,o)}}}):a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(t){return e.handleSelectIconOrImage(n.label,o)}}},[e._v(e._s(e.formatSelectButtonText(n.label)))])]:[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:e.judgeMaxlength(n.property)},model:{value:r[n.property],callback:function(t){e.$set(r,n.property,"string"==typeof t?t.trim():t)},expression:"row[column.property]"}})]]}}],null,!0)})})),a("el-table-column",{attrs:{prop:"handle",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(r){return e.handleDeleteRowData(t.$index)}}},[e._v("删除")])]}}])})],2),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{icon:"el-icon-square-add",plain:""},on:{click:e.handleAddRowData}},[e._v("添加")])],1)]]:[a("p",{staticClass:"form-row-title"},[e._v(e._s(e.title))]),"2"===e.productShowType?[e.tableData[0].imgUrl?a("img",{staticClass:"banner",staticStyle:{"margin-bottom":"22px"},attrs:{src:e.tableData[0].imgUrl,onerror:"this.src='"+r("f688")+"'"}}):a("p",{staticStyle:{color:"#999","margin-bottom":"22px"}},[e._v("暂无图片")])]:a("el-table",{staticStyle:{"margin-bottom":"22px"},attrs:{data:e.tableData,hideEmptyImg:!0}},e._l(e.tableList,(function(t,r){return a("el-table-column",{key:r,attrs:{prop:t.prop,label:t.label,"min-width":t["min-width"]},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,n=t.column;return["imgConfigCode"===n.property?[r[n.property]?a("img",{staticStyle:{height:"32px"},attrs:{src:""+r.imgUrl}}):a("span",[e._v("未"+e._s(e.formatSelectButtonText(n.label)))])]:[a("span",[e._v(e._s(r[n.property]))])]]}}],null,!0)})})),1)],a("el-dialog",{attrs:{width:"500px",title:e.computeDialogTitle,"close-on-click-modal":!1,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},close:e.closeDialog}},[a("div",{staticClass:"dialog-content"},[a("p",[e._v("请选择展示图标：")]),"选择图标"===e.computeDialogTitle?a("el-radio-group",{model:{value:e.iconItem,callback:function(t){e.iconItem=t},expression:"iconItem"}},e._l(e.iconList,(function(t,r){return a("el-radio",{key:r,class:e.computeRadioClass,attrs:{label:JSON.stringify([t.code,t.url]),border:!0}},[a("img",{staticClass:"icon-radio__image",attrs:{src:""+t.url}})])})),1):"选择配图"===e.computeDialogTitle?a("el-radio-group",{model:{value:e.imageItem,callback:function(t){e.imageItem=t},expression:"imageItem"}},e._l(e.imageList,(function(e,t){return a("el-radio",{key:t,staticClass:"image-radio",attrs:{label:JSON.stringify([e.code,e.url]),border:""}},[a("img",{staticClass:"image-radio__image",attrs:{src:""+e.url}})])})),1):e._e()],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSaveSelectIconOrImage}},[e._v("保 存")])],1)])],2)}),[],!1,null,"6fbc8c2e",null)),W=K.exports,Z={name:"ConfigureProductIntroduction",components:{StickyWrapper:R.a,ProductIntroductionTable:W},props:{editable:{type:Boolean,required:!0},productCode:{type:String,required:!0},secondaryDevelopment:{type:String,required:!0}},data:function(){return{totalTableData:[],editableTotalTableData:[],totalTableList:[[{label:"能力标题",prop:"title","min-width":"160"},{label:"描述信息",prop:"describe","min-width":"240"},{label:"展示图标",prop:"imgConfigCode","min-width":"160"}],[],[{label:"场景标题",prop:"title","min-width":"160"},{label:"场景描述",prop:"describe","min-width":"240"},{label:"详情链接",prop:"linkAddress","min-width":"240"},{label:"展示配图",prop:"imgConfigCode","min-width":"160"}],[{label:"案例标题",prop:"title","min-width":"160"},{label:"案例描述",prop:"describe","min-width":"240"},{label:"详情链接",prop:"linkAddress","min-width":"240"}],[{label:"能力标题",prop:"title","min-width":"160"},{label:"描述信息",prop:"describe","min-width":"240"},{label:"展示图标",prop:"imgConfigCode","min-width":"160"}]],imageUrl:"",iconList:[],imageList:[]}},computed:{computeFormRowList:function(){var e=[{title:"产品能力"},{title:"产品架构"},{title:"应用场景"},{title:"合作案例"},{title:"提供二次开发能力"}];return"1"===this.secondaryDevelopment?e:e.slice(0,-1)}},methods:{load:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productCode,e.next=3,H.a.load(t).catch((function(e){var t=e.data.message;throw t&&r.$message.error(t),new Error("load")}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),query:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"1",t={imgUseScenes:"1"},e.next=4,H.a.query(t).catch((function(e){var t=e.data.message;throw t&&r.$message.error(t),new Error("query")}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),save:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.productCode,a={productCode:r,showList:t},e.next=4,H.a.save(a).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("save")}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),updateTableData:function(e,t){var r=Object(G.a)(e,2),a=r[0],n=r[1];"add"===a?this.editableTotalTableData[t].push(n):"delete"===a&&this.editableTotalTableData[t].splice(n,1)},checkEditableTableData:function(e){return!0},handleSaveEditableTableData:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.checkEditableTableData(this.editableTotalTableData)){e.next=10;break}return t=this.editableTotalTableData.reduce((function(e,t){return e.concat(t)}),[]),e.next=5,this.save(t).catch((function(){throw new Error("save")}));case 5:return this.$message.success("保存成功！"),e.next=8,this.reloadTableData();case 8:this.$emit("update:editable",!1),this.$emit("updateStatus");case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleCancelEditableTableData:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reloadTableData();case 2:this.$emit("update:editable",!1);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),reloadTableData:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.totalTableData=Array.from({length:5},(function(e,t){var r="".concat(t+1);return 1===t?[{productShowType:r,imgUrl:""}]:[]})),this.editableTotalTableData=Array.from({length:5},(function(e,t){var r="".concat(t+1);return 1===t?[{productShowType:r,imgUrl:""}]:[]})),e.next=4,this.load().catch((function(){throw new Error("reloadTableData")}));case 4:t=e.sent,t.data.data.forEach((function(e){var t=e.productShowType;if(t){var a=parseInt(t)-1;"2"===t?(r.totalTableData[a].splice(0,1,e),r.editableTotalTableData[a].splice(0,1,Object(B.a)({},e))):(r.totalTableData[a].push(e),r.editableTotalTableData[a].push(Object(B.a)({},e)))}})),Object(i.a)(Object(o.a)().mark((function e(){var t,a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.query().catch((function(){}));case 2:t=e.sent,a=t.data,r.iconList=a.data.filter((function(e){return"1"===e.imgType})),r.imageList=a.data.filter((function(e){return"2"===e.imgType}));case 6:case"end":return e.stop()}}),e)})))();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},created:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reloadTableData();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},X=Z,Y=(r("1edf"),Object(f.a)(X,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"configure-product-introduction"},[e._l(e.computeFormRowList,(function(t,a){return r("div",{key:a,staticClass:"form-row"},[r("ProductIntroductionTable",{attrs:{editable:e.editable,title:t.title,tableData:e.totalTableData[a],editableTableData:e.editableTotalTableData[a],tableList:e.totalTableList[a],iconList:e.iconList,imageList:e.imageList,productShowType:""+(a+1)},on:{"update:tableData":function(t){return e.updateTableData(arguments,a)}}})],1)})),r("StickyWrapper",[e.editable?r("div",{staticClass:"button-wrapper"},[r("el-button",{on:{click:e.handleCancelEditableTableData}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handleSaveEditableTableData}},[e._v("保存")])],1):r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("update:editable",!0)}}},[e._v("编辑")])],1)],2)}),[],!1,null,"e4a59b3e",null)),ee={name:"Overview",components:{ProductBasicInfo:U,ConfigureProductIntroduction:Y.exports},props:{productCode:{type:String,required:!0}},data:function(){return{radioValue:"产品基本信息",editable:!1,secondaryDevelopment:""}},methods:{updateTitle:function(e){this.$emit("updateTitle",e)}}},te=ee,re=(r("ac8d"),Object(f.a)(te,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"overview"},[r("el-radio-group",{staticClass:"second-tabs",model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[r("el-radio-button",{attrs:{label:"产品基本信息"}}),r("el-radio-button",{attrs:{label:"配置产品介绍页"}})],1),"产品基本信息"===e.radioValue?r("ProductBasicInfo",{attrs:{editable:e.editable,secondaryDevelopment:e.secondaryDevelopment},on:{"update:editable":function(t){e.editable=t},"update:secondaryDevelopment":function(t){e.secondaryDevelopment=t},"update:secondary-development":function(t){e.secondaryDevelopment=t},updateTitle:e.updateTitle}}):"配置产品介绍页"===e.radioValue?r("ConfigureProductIntroduction",{attrs:{editable:e.editable,productCode:e.productCode,secondaryDevelopment:e.secondaryDevelopment},on:{"update:editable":function(t){e.editable=t},updateStatus:function(t){return e.$emit("updateStatus")}}}):e._e()],1)}),[],!1,null,"4cab2cd7",null)),ae=re.exports,ne=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticStyle:{display:"none"},attrs:{id:"displayNoDocInfo"}},[a("div",{staticStyle:{"margin-top":"0px","text-align":"center"}},[a("img",{staticStyle:{width:"316px",height:"200px"},attrs:{src:r("24ec")}})]),a("div",{staticClass:"noDataMessage"},[e._v("暂无文档~")])])}],oe=(r("8615"),r("53ca")),ie=r("aa47"),se=r("16d8"),ce={name:"SoftwareSystemManual",components:{Sortable:ie.a,MarkdownEditor:se.a},data:function(){return{tableData:[],sortTableData:[],dialogTitle:"新增",formData:{id:0,parentId:0,objId:this.$route.params.id,docType:1,title:"",remark:"",content:""},productDocRules:{docType:[{required:!0,message:"请选择类型",trigger:"blur"}],title:[{required:!0,message:"请输入名称",trigger:"blur"},{min:2,max:150,message:"名称长度2-150个字符",trigger:["blur","change"]}],remark:[{min:0,max:255,message:"备注长度超过255个字符",trigger:["blur","change"]}]},productDocEditRules:{title:[{required:!0,message:"请输入名称",trigger:"blur"},{min:2,max:150,message:"名称长度2-150个字符",trigger:["blur","change"]}],remark:[{min:0,max:255,message:"备注长度超过255个字符",trigger:["blur","change"]}],content:[{required:!0,message:"请输入文档内容",trigger:"blur"}]},docDialogVisible:!1,docEditDialogVisible:!1,languageTypeList:{en:"en_US",zh:"zh_CN",es:"es_ES"},nodata:"yes",markdownEditorHeight:window.innerHeight-308}},filters:{parseTimefilter:function(e,t){return e?Object(l.c)(e,t):""}},created:function(){},mounted:function(){this.fetchProdDocTree()},updated:function(){var e=this;this.$nextTick((function(){e.dropRow()}))},computed:{language:function(){return this.languageTypeList.zh}},methods:{handleRowId:function(e){return e.id+""+e.index},dropRow:function(){if(this.tableData.length>0){var e=document.querySelector(".el-table__body-wrapper tbody"),t=this;ie.a.create(e,{onEnd:function(){var e=Object(i.a)(Object(o.a)().mark((function e(r){var a,n,i,s,c,l;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.newIndex,n=r.oldIndex,i=JSON.parse(JSON.stringify(t.tableData)),t.sortTableData=[],t.treeConvertToList(i),s=t.sortTableData[n],c=t.sortTableData[a],s.parentId===c.parentId){e.next=10;break}d.Message.error("只能移动同一层级下的目录或文档"),e.next=13;break;case 10:return l=[s.id,":",c.seq,",",c.id,":",s.seq].join(""),e.next=13,t.setSort(l);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})}},treeConvertToList:function(e){for(var t in e){var r=e[t];this.sortTableData.push({id:r.id,seq:r.seq,parentId:r.parentId});var a=r.children;null!=a&&a.length>0&&this.recurrenceFun(a,this.sortTableData,r.id)}},recurrenceFun:function(e,t,r){for(var a in e){var n=e[a];t.push({id:n.id,seq:n.seq,parentId:r});var o=n.children;null!=o&&o.length>0&&this.recurrenceFun(o,t,n.id)}},changeDocType:function(e){this.formData.docType=e},addIndexProperty:function(e,t){var r=this;Array.isArray(e)?e.forEach((function(e,a){e[t]=a,r.addIndexProperty(e,t)})):"object"===Object(oe.a)(e)&&null!==e&&Object.values(e).forEach((function(e){r.addIndexProperty(e,t)}))},fetchProdDocTree:function(){var e=this;Object(c.a)({url:"/doc/getProductDocTree",method:"get",params:{productId:this.$route.params.id}}).then((function(t){e.tableData=t.data,e.addIndexProperty(e.tableData,"index"),0===e.tableData.length?(document.getElementById("displayNoDocInfo").style.display="",e.nodata="yes"):(document.getElementById("displayNoDocInfo").style.display="none",e.nodata="no")})).catch((function(e){}))},fetchProdDoc:function(e){var t=this;Object(c.a)({url:"/doc/getProductDoc",method:"get",params:{docId:e}}).then((function(e){for(var r in e.data)t.formData.hasOwnProperty(r)&&(t.formData[r]=e.data[r]);t.$refs.MarkdownEditor.setValue(e.data.content)})).catch((function(e){}))},add:function(e){this.formData.id=0,this.formData.parentId=e,this.docDialogVisible=!0},edit:function(e){this.dialogTitle="编辑",this.fetchProdDoc(e),this.docDialogVisible=!0},editDoc:function(e){this.fetchProdDoc(e),this.docEditDialogVisible=!0},setSort:function(e){var t=this;Object(c.a)({url:"/doc/sortProductDoc",method:"post",params:{sortStr:e}}).then((function(e){t.fetchProdDocTree()})).catch((function(e){}))},publish:function(e,t){var r,a=this;r=1==t?"文件夹发布成功后，用户即可在物流开放平台查看该文件夹（及其所有的子文件夹和文档），确认发布？":"文档发布成功后，用户即可在物流开放平台查看该文档，确认发布？",this.$confirm(r,"提示").then((function(t){Object(c.a)({url:"/doc/publishProductDoc",method:"post",params:{docId:e,productId:a.$route.params.id}}).then((function(e){d.Message.success("发布成功"),a.fetchProdDocTree()})).catch((function(e){}))})).catch((function(e){}))},down:function(e,t){var r,a=this;r=1==t?"文件夹下线成功后，用户将无法在物流开放平台查看该文件夹（及其所有的子文件夹和文档），确认下线？":"文档下线成功后，用户将无法在物流开放平台查看该文档，确认下线？",this.$confirm(r,"提示").then((function(t){Object(c.a)({url:"/doc/downProductDoc",method:"post",params:{docId:e,productId:a.$route.params.id}}).then((function(e){d.Message.success("下线成功"),a.fetchProdDocTree()})).catch((function(e){}))})).catch((function(e){}))},del:function(e,t){var r,a=this;r=1==t?"您将删除该目录及其下的所有文档，删除后用户无法在物流开放平台查看到该目录及其下的文档，确认删除？":"删除后，用户将无法在物流开放平台查看到该文档，确认删除？",this.$confirm(r,"提示").then((function(t){Object(c.a)({url:"/doc/deleteProductDoc",method:"post",params:{docId:e}}).then((function(e){d.Message.success("删除成功"),a.fetchProdDocTree()})).catch((function(e){}))})).catch((function(e){}))},handleCloseDocDialog:function(){this.clearFormData(),this.docDialogVisible=!1},handleCloseDocEditDialog:function(){this.clearEditFormData(),this.docEditDialogVisible=!1},saveProductDoc:function(){var e=this;this.formData,this.$refs.productDocForm.validate((function(t){if(!t)return!1;Object(c.a)({url:"/doc/addProductDoc",method:"post",data:e.formData}).then((function(t){e.docDialogVisible=!1,d.Message.success("保存成功"),e.fetchProdDocTree(),e.clearFormData()})).catch((function(e){d.Message.error("添加文档错误")}))}))},saveProductDocEdit:function(){var e=this;this.formData.content=this.$refs.MarkdownEditor.getValue(),this.$refs.productDocEditForm.validate((function(t){if(!t)return!1;Object(c.a)({url:"/doc/addProductDoc",method:"post",data:e.formData}).then((function(t){e.docEditDialogVisible=!1,d.Message.success("保存成功"),e.fetchProdDocTree(),e.clearEditFormData()})).catch((function(e){d.Message.error("添加文档错误")}))}))},clearFormData:function(){this.formData.id=0,this.formData.parentId=0,this.formData.objId=this.$route.params.id,this.formData.docType=1,this.formData.title="",this.formData.remark="",this.$refs.productDocForm.resetFields()},clearEditFormData:function(){this.formData.id=0,this.formData.parentId=0,this.formData.objId=this.$route.params.id,this.formData.docType=1,this.formData.title="",this.formData.remark="",this.formData.content="",this.$refs.productDocEditForm.resetFields()}}},le=ce,ue=(r("19a6"),Object(f.a)(le,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"software-system-manual"},[r("div",{staticClass:"mod-overview"},["no"===this.nodata?r("span",{key:"1"},[e.tableData.length>0?r("el-table",{ref:"tableDom",attrs:{data:e.tableData,"row-key":e.handleRowId,"tree-props":{children:"children",hasChildren:"hasChildren"}}},[r("el-table-column",{attrs:{prop:"title",label:"名称",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.docType?r("span",[r("i",{staticClass:"el-icon-document-empty"},[e._v(" "+e._s(t.row.title))])]):1===t.row.docType?r("span",[r("i",{staticClass:"icon iconfont icon-defaultfolder"},[e._v(" "+e._s(t.row.title))])]):e._e()]}}],null,!1,1318156733)}),r("el-table-column",{attrs:{prop:"updateUser",label:"更新人",align:"center"}}),r("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e._f("parseTimefilter")(t.row.updateTime,"{y}-{m}-{d} {h}:{i}")))])]}}],null,!1,1501552922)}),r("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"initColor"},[e._v(e._s(1===t.row.status?"初始化":""))]),r("span",{staticClass:"normalColor"},[e._v(e._s(2===t.row.status?"已发布":""))]),r("span",{staticClass:"updateColor"},[e._v(e._s(6===t.row.status?"编辑中":""))]),r("span",{staticClass:"deadColor"},[e._v(e._s(3===t.row.status?"已下线":""))])]}}],null,!1,831534242)}),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[2==t.row.docType?r("el-button",{attrs:{disabled:"",type:"text",size:"small"}},[e._v("新建")]):r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.add(t.row.id)}}},[e._v("新建")]),2==t.row.docType?r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.editDoc(t.row.id)}}},[e._v("编辑")]):r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.edit(t.row.id)}}},[e._v("编辑")]),2==t.row.status?r("el-button",{attrs:{disabled:"",type:"text",size:"small"}},[e._v("发布")]):r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.publish(t.row.id,t.row.docType)}}},[e._v("发布")]),2==t.row.status?r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.down(t.row.id,t.row.docType)}}},[e._v(" 下线 ")]):r("el-button",{attrs:{type:"text",size:"small",disabled:""}},[e._v("下线")]),1!=t.row.status&&3!=t.row.status||0==t.row.parentId?r("el-button",{attrs:{type:"text",size:"small",disabled:""}},[e._v("删除")]):r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.del(t.row.id,t.row.docType)}}},[e._v("删除")])]}}],null,!1,3917779867)})],1):e._e(),r("el-dialog",{attrs:{title:e.dialogTitle,visible:e.docDialogVisible,"before-close":e.handleCloseDocDialog,width:"400px","close-on-click-modal":!1},on:{"update:visible":function(t){e.docDialogVisible=t}}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form",{ref:"productDocForm",staticStyle:{width:"100%"},attrs:{"label-width":"100px",model:e.formData,rules:e.productDocRules}},[r("el-form-item",{attrs:{label:"id",prop:"id",hidden:""}},[r("el-input",{model:{value:e.formData.id,callback:function(t){e.$set(e.formData,"id",t)},expression:"formData.id"}})],1),r("el-form-item",{attrs:{label:"objId",prop:"objId",hidden:""}},[r("el-input",{model:{value:e.formData.objId,callback:function(t){e.$set(e.formData,"objId",t)},expression:"formData.objId"}})],1),r("el-form-item",{attrs:{label:"parentId",prop:"parentId",hidden:""}},[r("el-input",{model:{value:e.formData.parentId,callback:function(t){e.$set(e.formData,"parentId",t)},expression:"formData.parentId"}})],1),r("el-form-item",{attrs:{label:"类型",prop:"docType"}},[r("el-radio-group",{on:{change:e.changeDocType},model:{value:e.formData.docType,callback:function(t){e.$set(e.formData,"docType",t)},expression:"formData.docType"}},[0!=e.formData.id&&1==e.formData.docType?r("el-radio",{attrs:{disabled:"",label:1}},[e._v("子目录")]):r("el-radio",{attrs:{label:1}},[e._v("子目录")]),0!=e.formData.id?r("el-radio",{attrs:{disabled:"",label:2}},[e._v("文档")]):r("el-radio",{attrs:{label:2}},[e._v("文档")])],1)],1),r("el-form-item",{attrs:{label:"名称",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}})],1),r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1),r("el-form-item",[r("el-button",{on:{click:e.handleCloseDocDialog}},[e._v("关闭")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveProductDoc}},[e._v("保存")])],1)],1)],1)],1)],1),e.docEditDialogVisible?r("el-dialog",{attrs:{fullscreen:"",title:"编辑文档",visible:e.docEditDialogVisible,"before-close":e.handleCloseDocEditDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.docEditDialogVisible=t}}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form",{ref:"productDocEditForm",staticClass:"productDocument",staticStyle:{width:"100%"},attrs:{"label-width":"100px",model:e.formData,rules:e.productDocEditRules}},[r("el-form-item",{attrs:{label:"id",prop:"id",hidden:""}},[r("el-input",{model:{value:e.formData.id,callback:function(t){e.$set(e.formData,"id",t)},expression:"formData.id"}})],1),r("el-form-item",{attrs:{label:"objId",prop:"objId",hidden:""}},[r("el-input",{model:{value:e.formData.objId,callback:function(t){e.$set(e.formData,"objId",t)},expression:"formData.objId"}})],1),r("el-form-item",{attrs:{label:"parentId",prop:"parentId",hidden:""}},[r("el-input",{model:{value:e.formData.parentId,callback:function(t){e.$set(e.formData,"parentId",t)},expression:"formData.parentId"}})],1),r("el-form-item",{attrs:{label:"docType",prop:"docType",hidden:""}},[r("el-input",{model:{value:e.formData.docType,callback:function(t){e.$set(e.formData,"docType",t)},expression:"formData.docType"}})],1),r("el-form-item",{attrs:{label:"文档名称",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入文档名称"},model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}})],1),r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1),r("el-form-item",{attrs:{label:"内容",prop:"content"}},[r("el-alert",{attrs:{title:"注：文档中如果需要包含图片，请用工具栏中的图片上传工具上传，否则可能无法正常展示图片、下载文档",type:"error",closable:!1}}),r("div",{staticClass:"editor-container"},[r("MarkdownEditor",{ref:"MarkdownEditor",staticClass:"markdown-editor",attrs:{height:e.markdownEditorHeight},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}})],1)],1)],1)],1)],1),r("div",{staticClass:"button-wrapper",staticStyle:{display:"flex","justify-content":"flex-end","align-items":"center"}},[r("el-button",{on:{click:e.handleCloseDocEditDialog}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveProductDocEdit}},[e._v("保存")])],1)],1):e._e()],1):e._e(),e._m(0)])])}),ne,!1,null,"097ed502",null)),de=ue.exports,pe=r("3c94"),me=(r("a481"),r("456d"),r("2fdb"),r("c5f6"),r("7210")),fe={name:"MenuResourceTable",props:{loading:{type:Boolean,required:!0},refTable:{type:String,required:!0},category:{type:String,required:!0},queryResourcesList:{type:Function,required:!0},extensionFieldList:{type:Array,required:!0},queryConfig:{type:Function,required:!0},scrollTop:{type:Number,required:!0}},data:function(){return{resizeTimeout:null,height:228,offsetTop:350,treeConfig:{children:"childNodes",iconClose:"el-icon-arrow-right",iconOpen:"el-icon-arrow-down",indent:10},tableList:[{label:"资源名称",prop:"resourceName","min-width":"200"},{label:"资源编码",prop:"resourceCode","min-width":"200"},{label:"类型",prop:"resourceType","min-width":"80"},{label:"URL",prop:"resourceUrl","min-width":"120"},{label:"ICON",prop:"icon","min-width":"120"}]}},methods:{deleteNode:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a,n,i,s=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.category,a=t.id,n=t.lopResourceId,i={category:r,id:a,lopResourceId:n},e.next=5,me.a.deleteNode(i).catch((function(e){var t=e.data.message;throw t&&s.$message.error(t),new Error("deleteNode")}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),formatResourceTypeClass:function(e){return["normalColor","updateColor","deadColor"][e]},formatResourceTypeText:function(e){return["菜单","按钮","其它"][e]},formatterExtensionField:function(e,t,r){if(Object.keys(e).includes(t.property)){var a=parseInt(t.property.replace("ext",""))-1,n=this.extensionFieldList[a].enumValue;if(n){if(n.indexOf(",")>-1){var o={};return n.split(",").forEach((function(e){var t=e.split(":")[0],r=e.split(":")[1];o[r]=t})),Object.keys(o).includes(r)?o[r]:r}var i=n.split(":")[0];return r===n.split(":")[1]?i:r}return r}return r},resizeThrottler:function(){var e=this;this.resizeTimeout||(this.resizeTimeout=setTimeout((function(){e.resizeTimeout=null,e.height=document.body.offsetHeight-e.offsetTop,e.$refs[e.refTable].doLayout()}),100))},onTableBodyScroll:function(e){var t=e.scrollTop,r=e.judgeFlse;this.$emit("update:scrollTop",r?-1:t||0)},handleExtensionField:function(){this.$emit("update:handleExtensionField")},handleAddSubResource:function(e){this.$emit("update:handleAddSubResource",e)},handleEdit:function(e){this.$emit("update:handleEdit",e)},handleDelete:function(e){var t=this,r=this.$createElement,a={title:"删除子资源",message:r("p",null,["删除后，资源将从其所属的版本中一并删除，下次开通版本时将不会包含此资源，但已开通的租户不会受到影响，依然可以使用此资源。",r("span",{style:"color: #e1251b"},"谨慎操作！")]),customClass:"delete-message-box",type:"warning",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消"};this.$msgbox(a).then(Object(i.a)(Object(o.a)().mark((function r(){var a,n,s;return Object(o.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.deleteNode(e);case 2:return t.$message.success("删除子资源成功！"),t.$emit("update:loading",!0),Object(i.a)(Object(o.a)().mark((function e(){var r,a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.queryConfig();case 2:r=e.sent,a=r.data.data,t.$emit("update:extensionFieldList",a);case 5:case"end":return e.stop()}}),e)})))(),a=t.$refs[t.refTable].getTreeExpandRecords(),r.next=8,t.queryResourcesList();case 8:return n=r.sent,s=n.data,r.next=12,t.$refs[t.refTable].reloadData([s.data]);case 12:a.forEach((function(e){t.$refs[t.refTable].setTreeExpansion(e,!0)})),t.scrollTop>-1?t.$refs[t.refTable].pagingScrollTopLeft(t.scrollTop,0):t.$refs[t.refTable].scrollBottom(),t.$emit("update:loading",!1);case 15:case"end":return r.stop()}}),r)})))).catch((function(){}))}},mounted:function(){var e=this;window.addEventListener("resize",this.resizeThrottler,!1),Object(i.a)(Object(o.a)().mark((function t(){var r,a,n,s,c;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$emit("update:loading",!0),Object(i.a)(Object(o.a)().mark((function t(){var r,a;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.queryConfig();case 2:r=t.sent,a=r.data.data,e.$emit("update:extensionFieldList",a);case 5:case"end":return t.stop()}}),t)})))(),t.next=4,e.queryResourcesList();case 4:return r=t.sent,a=r.data,t.next=8,e.$refs[e.refTable].reloadData([a.data]);case 8:n=e.$refs[e.refTable].getUTreeData(),s=Object(G.a)(n,1),c=s[0],[c].forEach((function(t){e.$refs[e.refTable].setTreeExpansion(t,!0)})),e.height=document.body.offsetHeight-e.offsetTop,e.$emit("update:loading",!1);case 13:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){window.removeEventListener("resize",this.resizeThrottler,!1)}},he=fe,be=(r("b7ee"),r("9cc8"),Object(f.a)(he,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("u-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"menuResourceTable",staticClass:"menu-resource-table",attrs:{"row-id":"id","use-virtual":!0,"tree-config":e.treeConfig,"fixed-columns-roll":!0,border:!0,stripe:!0,"beautify-table":!0,"row-height":57,height:e.height,"header-row-style":{color:"#666"},"cell-style":{color:"#333"},"show-header-overflow":!0,"data-changes-scroll-top":!1},on:{"table-body-scroll":e.onTableBodyScroll}},[e._l(e.tableList,(function(t,a){return r("u-table-column",{key:a,attrs:{"tree-node":0===a,label:t.label,prop:t.prop,"min-width":t["min-width"],"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,n=t.column;return["resourceType"===n.property?[r("span",{class:e.formatResourceTypeClass(a[n.property])},[e._v(" "+e._s(e.formatResourceTypeText(a[n.property]))+" ")])]:[e._v(e._s(a[n.property]))]]}}],null,!0)})})),e._l(e.extensionFieldList,(function(t,a){return r("u-table-column",{key:t.key,attrs:{label:t.key,prop:"ext"+(a+1),"show-overflow-tooltip":!0,formatter:e.formatterExtensionField,"min-width":"120"}})})),r("u-table-column",{attrs:{label:"操作",prop:"handle",fixed:"right","min-width":"180"},scopedSlots:e._u([{key:"header",fn:function(t){var a=t.column;return[r("div",{staticClass:"menu-resource-table__handle-header"},[r("span",[e._v(e._s(a.label))]),r("i",{staticClass:"el-icon-setting",on:{click:e.handleExtensionField}})])]}},{key:"default",fn:function(t){var a=t.row;return[a.parentId||0===a.parentId?r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleAddSubResource(a)}}},[e._v("添加子资源")]):e._e(),a.parentId&&0!==a.parentId?r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑")]):e._e(),a.parentId&&0!==a.parentId?r("el-button",{staticStyle:{color:"#e1251b"},attrs:{type:"text"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")]):e._e()]}}])})],2)}),[],!1,null,"fe738408",null)),ge=be.exports,ve=r("1a71"),ye={name:"MenuResourceDialog",props:{category:{type:String,required:!0},menuResourceDialogVisible:{type:Boolean,required:!0},editable:{type:Boolean,required:!0},menuResourceFormData:{type:Object,required:!0},queryConfig:{type:Function,required:!0},extensionFieldList:{type:Array,required:!0}},data:function(){return{dialogVisible:!1,formData:{resourceCode:"",resourceName:"",resourceType:null,resourceUrl:"",icon:"",remark:""},rules:{resourceCode:[{required:!0,message:"请输入资源编码"},{max:50,message:"资源编码最大长度为50个字符"},{pattern:ve.a.normal,message:"资源编码不可输入特殊字符"}],resourceName:[{required:!0,message:"请输入资源名称"},{max:30,message:"资源名称最大长度为30个字符"}],resourceType:[{required:!0,message:"请选择类型"}],resourceUrl:[{max:400,message:"URL最大长度为400个字符"}],icon:[{max:400,message:"ICON最大长度为400个字符"}],remark:[{max:120,message:"备注最大长度为120个字符"}]},formList:[{label:"资源编码",prop:"resourceCode",placeholder:"请输入资源编码"},{label:"资源名称",prop:"resourceName",placeholder:"请输入资源名称"},{label:"类型",prop:"resourceType",placeholder:"请选择类型"},{label:"URL",prop:"resourceUrl",placeholder:"请输入资源对应的URL"},{label:"ICON",prop:"icon",placeholder:"请输入ICON的链接"}],optionList:[{label:"菜单",value:0},{label:"按钮",value:1},{label:"其它",value:2}],extensionFieldFormData:{}}},computed:{computeMenuResourceDialogTitle:function(){return this.editable?"编辑子资源":"添加子资源"}},watch:{menuResourceDialogVisible:{handler:function(e){this.dialogVisible=e}},menuResourceFormData:{handler:function(e){this.formData=e}}},methods:{createNode:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i,s,c,l,u,d,p,m,f=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.category,r=this.formData.id,a=this.formData,n=a.lopResourceId,i=a.resourceCode,s=a.resourceName,c=a.resourceType,l=a.resourceUrl,u=a.icon,d=a.remark,Object.keys(this.formData).forEach((function(e){e.indexOf("ext")>-1&&(p||(p={}),p[f.extensionFieldList[parseInt(e.replace("ext",""))-1].key]=f.formData[e])})),p&&(p=JSON.stringify(p)),m={category:t,parentId:r,lopResourceId:n,resourceCode:i,resourceName:s,resourceType:c,resourceUrl:l,icon:u,extendedField:p,remark:d},e.next=8,me.a.createNode(m).catch((function(e){var t=e.data.message;throw t&&f.$message.error(t),new Error("createNode")}));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),updateNode:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i,s,c,l,u,d,p,m=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.category,r=this.formData,a=r.id,n=r.lopResourceId,i=r.resourceName,s=r.resourceType,c=r.resourceUrl,l=r.icon,u=r.remark,Object.keys(this.formData).forEach((function(e){e.indexOf("ext")>-1&&(d||(d={}),d[m.extensionFieldList[parseInt(e.replace("ext",""))-1].key]=m.formData[e])})),d&&(d=JSON.stringify(d)),p={category:t,id:a,lopResourceId:n,resourceName:i,resourceType:s,resourceUrl:c,icon:l,extendedField:d,remark:u},e.next=7,me.a.updateNode(p).catch((function(e){var t=e.data.message;throw t&&m.$message.error(t),new Error("updateNode")}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),openDialog:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryConfig();case 2:t=e.sent,r=t.data.data,this.$emit("update:extensionFieldList",r);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),closeDialog:function(){this.$refs.form.resetFields(),this.$emit("update:menuResourceFormData",{resourceCode:"",resourceName:"",resourceType:null,resourceUrl:"",icon:"",remark:""}),this.$emit("update:menuResourceDialogVisible",!1)},submitResourceData:function(){var e=this;this.$refs.form.validate(function(){var t=Object(i.a)(Object(o.a)().mark((function t(r){return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=13;break}if(!e.editable){t.next=6;break}return t.next=4,e.updateNode();case 4:t.next=8;break;case 6:return t.next=8,e.createNode();case 8:e.$message.success("".concat(e.computeMenuResourceDialogTitle,"成功！")),e.dialogVisible=!1,e.$emit("update:afterSubmitResourceData"),t.next=14;break;case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},we=ye,xe=(r("3bd8"),Object(f.a)(we,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"menu-resource-dialog",attrs:{width:"720px",visible:e.dialogVisible,title:e.computeMenuResourceDialogTitle,"close-on-click-modal":!1,"destroy-on-close":!0},on:{"update:visible":function(t){e.dialogVisible=t},open:e.openDialog,close:e.closeDialog}},[r("div",{staticClass:"content-wrapper"},[r("p",{staticClass:"menu-resource-dialog__subtitle"},[e._v("仔细填写并核对信息")]),r("el-form",{ref:"form",attrs:{model:e.formData,"label-width":"auto"}},[e._l(e.formList,(function(t,a){return r("el-form-item",{key:a,attrs:{label:t.label,prop:t.prop,rules:e.rules[t.prop]}},["resourceType"===t.prop?r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.placeholder},model:{value:e.formData[t.prop],callback:function(r){e.$set(e.formData,t.prop,r)},expression:"formData[item.prop]"}},e._l(e.optionList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):r("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:t.placeholder,disabled:e.editable&&"resourceCode"===t.prop},model:{value:e.formData[t.prop],callback:function(r){e.$set(e.formData,t.prop,r)},expression:"formData[item.prop]"}})],1)})),e._l(e.extensionFieldList,(function(t,a){return r("el-form-item",{key:t.key,attrs:{label:t.key,prop:"ext"+(a+1),rules:t.required?[{required:!0,message:"请输入"+t.key}]:null}},[t.enumValue?r("el-select",{staticStyle:{width:"100%"},model:{value:e.formData["ext"+(a+1)],callback:function(t){e.$set(e.formData,"ext"+(a+1),t)},expression:"formData[`ext${index + 1}`]"}},[t.enumValue.indexOf(",")>-1?e._l(t.enumValue.split(","),(function(e,t){return r("el-option",{key:t,attrs:{label:e.split(":")[0],value:e.split(":")[1]}})})):[r("el-option",{attrs:{label:t.enumValue.split(":")[0],value:t.enumValue.split(":")[1]}})]],2):r("el-input",{staticStyle:{width:"100%"},model:{value:e.formData["ext"+(a+1)],callback:function(t){e.$set(e.formData,"ext"+(a+1),t)},expression:"formData[`ext${index + 1}`]"}})],1)})),r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{placeholder:"请输入备注内容",type:"textarea",rows:1},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1)],2)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submitResourceData}},[e._v("确 定")])],1)])}),[],!1,null,"eeb86338",null)),De=xe.exports,Ce={name:"ExtensionFieldDialog",props:{category:{type:String,required:!0},extensionFieldDialogVisible:{type:Boolean,required:!0},queryConfig:{type:Function,required:!0}},data:function(){return{productId:this.$route.params.id,dialogVisible:!1,tableData:Array.from({length:18},(function(){return{required:0,key:"",enumerable:!1,enumValue:""}})),tableList:[{prop:"required",label:"是否必填",width:80},{prop:"key",label:"字段名称",width:240},{prop:"enumerable",label:"是否枚举类型",width:120},{prop:"enumValue",label:"枚举值"}]}},watch:{extensionFieldDialogVisible:{handler:function(e){this.dialogVisible=e}}},methods:{saveConfig:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a,n,i=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.category,a=this.productId,n={category:r,productId:a,configs:t},e.next=4,me.a.saveConfig(n).catch((function(e){var t=e.data.message;throw t&&i.$message.error(t),new Error("saveConfig")}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),openDialog:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryConfig();case 2:t=e.sent,(r=t.data.data)&&r.length>0&&this.initConfig(r);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),closeDialog:function(){this.tableData=Array.from({length:18},(function(){return{required:0,key:"",enumerable:!1,enumValue:""}})),this.$emit("update:extensionFieldDialogVisible",!1)},changeEnumerable:function(e,t){e||(t.enumValue="")},inputEnumValue:function(e,t){t.enumValue=e.replaceAll(" ","")},initConfig:function(e){var t=e.map((function(e){return{required:e.required,key:e.key,enumValue:e.enumValue,enumerable:Boolean(e.enumValue)}}));this.tableData.splice(0,t.length),this.tableData=t.concat(this.tableData)},checkConfig:function(){var e=this,t=[],r=-1;if(this.tableData.forEach((function(e,t){var a=e.required,n=e.key,o=e.enumerable,i=e.enumValue;(a||n||o||i)&&(r=t)})),r>-1&&(t=this.tableData.slice(0,r+1)),t.some((function(e,r){if(r){var a=e.required,n=e.key,o=e.enumerable,i=e.enumValue,s=a||n||o||i,c=t[r-1],l=c.required||c.key||c.enumerable||c.enumValue;return!(!s||l)||void 0}})))this.$message.error("请依次填写扩展字段！");else if(!t.some((function(t,r){var a=t.key;return a?a.length>10?(e.$message.error("请检查字段序号".concat(r+1,"的字段名称，最多可输入").concat(10,"个字符！")),!0):ve.a.zhEngNumUnder.test(a)?void 0:(e.$message.error("请检查字段序号".concat(r+1,"的字段名称，只能包含中文、英文字母、数字、下划线！")),!0):(e.$message.error("请填写字段名称！"),!0)}))&&!t.some((function(t,r){var a=t.enumerable,n=t.enumValue;if(a&&!n)return e.$message.error("枚举类型字段的枚举值不允许为空"),!0;if(n.length>500)return e.$message.error("请检查字段序号".concat(r+1,"的枚举值，最多可输入").concat(500,"个字符！")),!0;if(n){if(!ve.a.enumValue.test(n))return e.$message.error("请检查字段序号".concat(r+1,'的枚举值，格式应为"值内容:值"，枚举值间以英文逗号分隔，值内容、值以英文冒号分隔，并只能包含中文、英文字母、数字、下划线！')),!0;if(n.indexOf(",")>-1){var o=[],i=[];return n.split(",").some((function(t){var a=t.split(":"),n=Object(G.a)(a,2),s=n[0],c=n[1];return o.includes(c)?(e.$message.error("请检查字段序号".concat(r+1,"的枚举值，值").concat(c,"当前不唯一！")),!0):i.includes(s)?(e.$message.error("请检查字段序号".concat(r+1,"的枚举值，值内容").concat(c,"当前不唯一！")),!0):(o.push(c),void i.push(s))}))}}})))return t.map((function(e){return{required:e.required,key:e.key,enumValue:e.enumValue}}))},submitExtensionFieldData:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.checkConfig())){e.next=7;break}return e.next=4,this.saveConfig(t);case 4:this.$message.success("保存成功！"),this.dialogVisible=!1,this.$emit("update:afterSubmitExtensionFieldData");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},Se=Ce,Oe=(r("f8f8"),Object(f.a)(Se,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"extension-field-dialog",attrs:{title:"扩展字段",width:"900px",visible:e.dialogVisible,"close-on-click-modal":!1,"destroy-on-close":!0},on:{"update:visible":function(t){e.dialogVisible=t},open:e.openDialog,close:e.closeDialog}},[r("div",{staticClass:"content-wrapper"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[r("el-table-column",{attrs:{type:"index",label:"字段序号",width:"80",align:"center"}}),e._l(e.tableList,(function(t,a){return r("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,width:t.width,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,n=t.column,o=t.$index;return["required"===n.property?[r("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.tableData[o].required,callback:function(t){e.$set(e.tableData[o],"required",t)},expression:"tableData[$index].required"}})]:"key"===n.property?[r("el-input",{model:{value:e.tableData[o].key,callback:function(t){e.$set(e.tableData[o],"key","string"==typeof t?t.trim():t)},expression:"tableData[$index].key"}})]:"enumerable"===n.property?[r("el-checkbox",{on:{change:function(t){return e.changeEnumerable(t,a)}},model:{value:e.tableData[o].enumerable,callback:function(t){e.$set(e.tableData[o],"enumerable",t)},expression:"tableData[$index].enumerable"}})]:"enumValue"===n.property?[r("el-input",{attrs:{placeholder:"显示值:存储值（多个枚举值请用英文逗号隔开）",disabled:!e.tableData[o].enumerable},on:{input:function(t){return e.inputEnumValue(t,a)}},model:{value:e.tableData[o].enumValue,callback:function(t){e.$set(e.tableData[o],"enumValue","string"==typeof t?t.trim():t)},expression:"tableData[$index].enumValue"}})]:e._e()]}}],null,!0)})}))],2)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submitExtensionFieldData}},[e._v("保 存")])],1)])}),[],!1,null,"6d6855bf",null)),ke=Oe.exports,_e={name:"MenuResource",components:{TagTip:pe.default,MenuResourceTable:ge,MenuResourceDialog:De,ExtensionFieldDialog:ke},data:function(){return{hrefHelpDocument:"//lcp.jdl.com/#/newHand/53054",category:"MENUTREE",productId:this.$route.params.id,loading:!0,refTable:"menuResourceTable",menuResourceDialogVisible:!1,editable:!1,menuResourceFormData:{resourceCode:"",resourceName:"",resourceType:null,resourceUrl:"",icon:"",remark:""},extensionFieldDialogVisible:!1,extensionFieldList:[],scrollTop:0}},methods:{queryResourcesList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.category,r=this.productId,a={category:t,productId:r},e.next=4,me.a.queryResourcesList(a).catch(function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(10029!==t.data.code){e.next=8;break}return e.next=3,n.initSysResources().catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("initSysResources")}));case 3:return e.next=5,me.a.queryResourcesList(a).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("queryResourcesList")}));case 5:return e.abrupt("return",e.sent);case 8:throw(r=t.data.message)&&n.$message.error(r),new Error("queryResourcesList");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),queryConfig:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.category,r=this.productId,a={category:t,productId:r},e.next=4,me.a.queryConfig(a).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("queryConfig")}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),initSysResources:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.category,r=this.productId,a={category:t,productId:r},e.next=4,me.a.initSysResources(a).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("initSysResources")}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleExtensionField:function(){this.extensionFieldDialogVisible=!0},handleAddSubResource:function(e){var t=this;this.editable=!1,this.menuResourceDialogVisible=!0,this.$nextTick((function(){var r=e.id,a=e.lopResourceId;t.menuResourceFormData=Object.assign(JSON.parse(JSON.stringify(t.menuResourceFormData)),{id:r,lopResourceId:a})}))},handleEdit:function(e){var t=this;this.editable=!0,this.menuResourceDialogVisible=!0,this.$nextTick((function(){t.menuResourceFormData=JSON.parse(JSON.stringify(e))}))},refreshTableData:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.queryConfig();case 2:t=e.sent,r=t.data.data,n.extensionFieldList=r;case 5:case"end":return e.stop()}}),e)})))(),t=this.$refs[this.refTable].$refs[this.refTable].getTreeExpandRecords(),e.next=5,this.queryResourcesList();case 5:return r=e.sent,a=r.data,e.next=9,this.$refs[this.refTable].$refs[this.refTable].reloadData([a.data]);case 9:this.$refs[this.refTable].$refs[this.refTable].doLayout(),t.forEach((function(e){n.$refs[n.refTable].$refs[n.refTable].setTreeExpansion(e,!0)})),this.scrollTop>-1?this.$refs[this.refTable].$refs[this.refTable].pagingScrollTopLeft(this.scrollTop,0):this.$refs[this.refTable].$refs[this.refTable].scrollBottom(),this.loading=!1;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},je=_e,Te=(r("dd04"),Object(f.a)(je,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"menu-resource"},[r("TagTip",{staticClass:"tag-tip",attrs:{closable:!1}},[e._v(" 您可在列表中维护该软件全部范围的菜单资源。了解更多请看 "),r("a",{staticClass:"anchor initColor",attrs:{href:e.hrefHelpDocument,target:"_blank"}},[e._v("新手帮助文档")])]),r("div",{staticClass:"menu-resource__table-wrapper"},[r("MenuResourceTable",{ref:e.refTable,attrs:{category:"MENUTREE",refTable:e.refTable,loading:e.loading,queryResourcesList:e.queryResourcesList,extensionFieldList:e.extensionFieldList,queryConfig:e.queryConfig,scrollTop:e.scrollTop},on:{"update:loading":function(t){e.loading=t},"update:extensionFieldList":function(t){e.extensionFieldList=t},"update:extension-field-list":function(t){e.extensionFieldList=t},"update:scrollTop":function(t){e.scrollTop=t},"update:scroll-top":function(t){e.scrollTop=t},"update:handleExtensionField":e.handleExtensionField,"update:handleAddSubResource":e.handleAddSubResource,"update:handleEdit":e.handleEdit}})],1),r("MenuResourceDialog",{attrs:{category:"MENUTREE",menuResourceDialogVisible:e.menuResourceDialogVisible,editable:e.editable,menuResourceFormData:e.menuResourceFormData,queryConfig:e.queryConfig,extensionFieldList:e.extensionFieldList},on:{"update:menuResourceDialogVisible":function(t){e.menuResourceDialogVisible=t},"update:menu-resource-dialog-visible":function(t){e.menuResourceDialogVisible=t},"update:menuResourceFormData":function(t){e.menuResourceFormData=t},"update:menu-resource-form-data":function(t){e.menuResourceFormData=t},"update:extensionFieldList":function(t){e.extensionFieldList=t},"update:extension-field-list":function(t){e.extensionFieldList=t},"update:afterSubmitResourceData":e.refreshTableData}}),r("ExtensionFieldDialog",{attrs:{category:"MENUTREE",extensionFieldDialogVisible:e.extensionFieldDialogVisible,queryConfig:e.queryConfig},on:{"update:extensionFieldDialogVisible":function(t){e.extensionFieldDialogVisible=t},"update:extension-field-dialog-visible":function(t){e.extensionFieldDialogVisible=t},"update:afterSubmitExtensionFieldData":e.refreshTableData}})],1)}),[],!1,null,"e4de0554",null)),Ne={name:"SystemResource",components:{MenuResource:Te.exports},data:function(){return{active:"menuResource",menuTitleList:[{title:"菜单资源管理",index:"menuResource"}]}},methods:{selectMenuItem:function(e){this.active=e}}},Ee=Ne,Ie=(r("e901"),Object(f.a)(Ee,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"system-resource"},[r("div",{staticClass:"system-resource__aside"},[r("el-menu",{attrs:{"default-active":e.active},on:{select:e.selectMenuItem}},e._l(e.menuTitleList,(function(t,a){return r("el-menu-item",{key:a,attrs:{index:t.index}},[r("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])])})),1)],1),r("div",{staticClass:"system-resource__main"},["menuResource"===e.active?r("MenuResource"):e._e()],1)])}),[],!1,null,"56baf825",null)),Fe=Ie.exports,$e=(r("f400"),r("1799")),Le=(r("4f7f"),r("3d85")),Ve=r("ade3"),Pe=r("2909"),Re=(r("7514"),{name:"CheckboxTreeTable",props:{fullScreenHeight:{type:Number,required:!0},styleTop:{type:String,default:"top: 184px"},noEditHeight:{type:Number,default:240},tableColumnList:{type:Array,default:[]},extendedList:{type:Array,default:function(){return[]}},treeConfig:{type:Object,default:function(){return{children:"childNodes",iconClose:"el-icon-arrow-right",iconOpen:"el-icon-arrow-down",indent:10,expandAll:!0}}}},data:function(){return{fullScreen:!1,flatChildren:[],flatParentList:[],selection:[]}},methods:(a={formatResourceTypeClass:function(e){return["normalColor","updateColor","deadColor"][e]},formatResourceTypeText:function(e){return["菜单","按钮","其它"][e]}},Object(Ve.a)(a,"formatResourceTypeText",(function(e){return["菜单","按钮","其它"][e]})),Object(Ve.a)(a,"formatterExtensionField",(function(e,t,r){if(Object.keys(e).includes(t.property)){var a=parseInt(t.property.replace("ext",""))-1,n=this.extendedList[a].enumValue;if(n){if(n.indexOf(",")>-1){var o={};return n.split(",").forEach((function(e){var t=e.split(":")[0],r=e.split(":")[1];o[r]=t})),Object.keys(o).includes(r)?o[r]:r}var i=n.split(":")[0];return r===n.split(":")[1]?i:r}return r}return r})),Object(Ve.a)(a,"getWidth",(function(){return this.fullScreen?"90%":"100%"})),Object(Ve.a)(a,"getMarginLeft",(function(){return this.fullScreen?"100px":"0px"})),Object(Ve.a)(a,"flattenChildren",(function(e){var t=this;this.flatChildren.push(e);var r=this.treeConfig.children;Array.isArray(e[r])&&e[r].length>0&&e[r].forEach((function(e){t.flattenChildren(e)}))})),Object(Ve.a)(a,"flattenParentList",(function(e,t,r){var a=this,n=this.treeConfig.children,o=e.id,i=e.parentId;if(o===t)return this.flatParentList.push(e),void(i&&this.flattenParentList(r,i,r));Array.isArray(e[n])&&e[n].length>0&&e[n].forEach((function(e){a.flattenParentList(e,t,r)}))})),Object(Ve.a)(a,"echoSelection",(function(){var e=this,t=this.$refs.table.getUTreeData(),r=Object(G.a)(t,1)[0];this.flatChildren=[],this.flattenChildren(r);this.selection=[],this.flatChildren.forEach((function(t){t.isPick&&(e.$refs.table.toggleRowSelection([{row:t,selected:true}]),e.selection.push(t))})),this.flatParentList=[]})),Object(Ve.a)(a,"onClickToggleFullScreenButton",(function(){var e=this;this.fullScreen=!this.fullScreen,this.$nextTick((function(){e.$refs.table.doLayout()}))})),Object(Ve.a)(a,"onSelectionChange",(function(e){e=this.$refs.table.getCheckboxRecords(),this.$emit("selectionChange",e)})),Object(Ve.a)(a,"onSelect",(function(e,t){var r=this,a=e.some((function(e){return e===t}));if(t=this.$refs.table.getUTreeData().find((function(e){return e.id===t.id})),this.flatChildren=[],this.flattenChildren(t),this.flatChildren.forEach((function(e){r.$refs.table.toggleRowSelection([{row:e,selected:a}])})),this.flatParentList=[],a){var n=this.$refs.table.getUTreeData(),o=Object(G.a)(n,1)[0],i=t.parentId;this.flattenParentList(o,i,o),this.flatParentList.forEach((function(e){r.$refs.table.toggleRowSelection([{row:e,selected:a}])})),this.selection=Array.from(new Set([].concat(Object(Pe.a)(this.selection),Object(Pe.a)(this.flatChildren),Object(Pe.a)(this.flatParentList))))}else this.selection=this.selection.filter((function(e){return!r.flatChildren.includes(e)}))})),Object(Ve.a)(a,"onSelectAll",(function(e){var t=this.$refs.table.getUTreeData(),r=Object(G.a)(t,1)[0];Array.isArray(e)&&e.length>0?this.onSelect([r],r):this.onSelect([],r)})),Object(Ve.a)(a,"onToggleTreeExpand",(function(){var e=this,t=this.selection;t.forEach((function(t){e.$refs.table.toggleRowSelection([{row:t,selected:true}])}))})),a)}),qe=Re,ze=(r("f3a4"),Object(f.a)(qe,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"check-table-tree",class:{"full-screen":e.fullScreen}},[e.fullScreen?r("div",{staticStyle:{"margin-top":"20px"}},[r("span",{staticStyle:{"font-size":"20px","margin-left":"100px"}},[e._v("选择版本资源")]),r("el-button",{staticClass:"exit-full-btn",staticStyle:{float:"right","margin-right":"100px"},attrs:{size:"medium",icon:"el-icon-full-screen"},on:{click:e.onClickToggleFullScreenButton}},[e._v("退出全屏")]),r("el-divider")],1):e._e(),0==e.fullScreen?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"列表全屏展示",placement:"top"}},[r("i",{staticClass:"el-icon-full-screen el-icon-right",style:e.styleTop,on:{click:e.onClickToggleFullScreenButton}})]):e._e(),r("u-table",{ref:"table",style:{"margin-left":e.getMarginLeft(),width:e.getWidth()},attrs:{"use-virtual":!0,height:e.fullScreen?e.fullScreenHeight:e.noEditHeight,"select-on-indeterminate":!1,"big-data-checkbox":!0,"tree-config":e.treeConfig,"row-id":"id",border:!0,stripe:!0,"beautify-table":!0,"row-height":57,"header-row-style":{color:"#666"},"cell-style":{color:"#333"}},on:{select:e.onSelect,"select-all":e.onSelectAll,"selection-change":e.onSelectionChange,"toggle-tree-expand":e.onToggleTreeExpand}},[r("u-table-column",{attrs:{type:"selection",width:"55"}}),e._l(e.tableColumnList,(function(t,a){return r("u-table-column",{key:a,attrs:{"tree-node":0===a,prop:t.prop,label:t.label,width:t.width,"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,n=t.column;return["resourceType"===n.property?r("span",{class:e.formatResourceTypeClass(a[n.property])},[e._v(" "+e._s(e.formatResourceTypeText(a[n.property]))+" ")]):[e._v(e._s(a[n.property]))]]}}],null,!0)})})),e._l(e.extendedList,(function(t,a){return r("u-table-column",{key:a+"extended",attrs:{prop:"ext"+(a+1),label:t.key,formatter:e.formatterExtensionField,"show-overflow-tooltip":!0}})}))],2)],1)}),[],!1,null,"65bc047a",null)),Me=ze.exports,Ae=r("cea4"),Ue=r("8da1"),Be={name:"CreateVersionDialog",components:{Steps:Le.a,CheckboxTreeTable:Me},props:{dialogVisible:{type:Boolean,required:!0},extendedList:{type:Array,required:!0}},data:function(){return{productId:parseInt(this.$route.params.id),active:0,versionInfoFormData:{versionName:"",versionCode:"",detail:"",price:0,remark:""},versionInfoFormItemList:[{label:"版本名称",prop:"versionName",placeholder:"请输入版本名称"},{label:"版本编码",prop:"versionCode",placeholder:"版本编码唯一，不允许重复创建"},{label:"版本描述",prop:"detail",placeholder:"请输入版本描述"},{label:"版本金额",prop:"price"},{label:"备注",prop:"remark",placeholder:"请输入备注"}],versionInfoFormRules:{versionName:[{required:!0,message:"请输入版本名称",trigger:"blur"},{max:30,message:"版本名称最大长度为30个字符"},{pattern:ve.a.normal,message:"版本名称不可输入特殊字符"}],versionCode:[{required:!0,message:"请输入版本编码",trigger:"blur"},{max:50,message:"版本编码最大长度为50个字符"},{pattern:ve.a.normal,message:"版本编码不可输入特殊字符"}],detail:[{required:!0,message:"请输入版本描述",trigger:"blur"},{max:120,message:"描述最大长度为120个字符"}],price:[{required:!0,message:"请输入版本金额",trigger:"blur"},{pattern:ve.a.number,message:"版本金额只能输入数字及小数点后两位数"}],remark:[{max:120,message:"备注最大长度为120个字符"},{pattern:ve.a.normal,message:"备注不可输入特殊字符"}]},lopResourceId:null,lopResourceIdList:[],loading:!1,tableColumnList:[{prop:"resourceName",width:"300",label:"资源名称"},{prop:"resourceCode",width:"200",label:"资源编码"},{prop:"resourceType",label:"类型"}],selectedId:[],resizeDebounceTimer:null,fullScreenHeight:460}},methods:{queryVersionList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productId,"MENUTREE",1,500,r={productId:t,category:"MENUTREE",pageNum:1,pageSize:500},e.next=7,Ae.a.queryVersionList(r).catch((function(e){throw new Error("queryVersionList, ".concat(e))}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),initSysResources:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productId,"MENUTREE",r={productId:t,category:"MENUTREE"},e.next=5,Ue.a.initSysResources(r).catch((function(e){throw new Error("initSysResources, ".concat(e))}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),queryResourcesList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productId,"MENUTREE",r={productId:t,category:"MENUTREE"},e.next=5,Ue.a.queryResourcesList(r).catch(function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.data,a=r.code,n=r.message,10029!==a){e.next=6;break}throw new Error("queryResourcesList, 10029");case 6:throw new Error("queryResourcesList, ".concat(n||r));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),queryVersionDetails:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.lopResourceId,"MENUTREE",r={lopResourceId:t,category:"MENUTREE"},e.next=5,Ae.a.queryVersionDetails(r).catch((function(e){throw new Error("queryVersionDetails, ".concat(e))}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),checkVersionCode:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productId,r=this.versionInfoFormData.versionCode,a={productId:t,versionCode:r},e.abrupt("return",Ae.a.checkVersionCode(a).catch((function(e){throw new Error("checkVersionCode, ".concat(e))})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),createVersion:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i,s,c,l,u,d;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.selectedId,r=this.productId,a=t,"MENUTREE",n=this.versionInfoFormData,i=n.versionName,s=n.versionCode,c=n.remark,l=n.detail,u=this.versionInfoFormData.price,1,d={ids:a,productId:r,category:"MENUTREE",versionName:i,versionCode:s,remark:c,detail:l,price:u*=100,sysVersionRefType:1},e.next=10,Ae.a.createVersion(d).catch((function(e){throw new Error("createVersion, ".concat(e))}));case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleQueryVersionList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryVersionList().catch((function(e){throw new Error("handleQueryVersionList, ".concat(e))}));case 2:t=e.sent,r=t.data.list,this.lopResourceIdList=Array.isArray(r)?r:[];case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleInitSysResources:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initSysResources().catch((function(e){throw new Error("handleInitSysResources, ".concat(e))}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleQueryResourcesList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryResourcesList().catch(function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("".concat(t).indexOf(10029)>-1)){e.next=8;break}return e.next=3,a.handleInitSysResources().catch((function(e){throw new Error("handleQueryResourcesList, ".concat(e))}));case 3:return e.next=5,a.queryResourcesList().catch((function(e){throw new Error("handleQueryResourcesList, ".concat(e))}));case 5:return e.abrupt("return",e.sent);case 8:throw new Error("handleQueryResourcesList, ".concat(t));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return t=e.sent,r=t.data.data,e.next=6,this.$refs.checkboxTreeTable.$refs.table.reloadData([r||{}]);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleQueryVersionDetails:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryVersionDetails().catch((function(e){throw new Error("handleQueryVersionDetails, ".concat(e))}));case 2:return t=e.sent,r=t.data,e.next=6,this.$refs.checkboxTreeTable.$refs.table.reloadData([r||{}]);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleCheckVersionCode:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkVersionCode().catch((function(e){throw new Error("handleCheckVersionCode, ".concat(e))}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleCreateVersion:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createVersion().catch((function(e){throw new Error("handleCreateVersion, ".concat(e))}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),resizeThrottler:function(){var e=this;clearTimeout(this.resizeDebounceTimer),this.resizeDebounceTimer=setTimeout((function(){e.fullScreenHeight=document.body.offsetHeight-100,e.$refs.checkboxTreeTable.$refs.table.doLayout()}),100)},onOpenedDialog:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.addEventListener("resize",this.resizeThrottler,!1),this.resizeThrottler(),e.next=4,this.handleQueryVersionList().catch((function(e){throw new Error("onOpenedDialog, ".concat(e))}));case 4:return e.next=6,this.handleQueryResourcesList().catch((function(e){throw new Error("onOpenedDialog, ".concat(e))}));case 6:this.$nextTick((function(){var e=t.$refs.checkboxTreeTable.$refs.table.getUTreeData(),r=[Object(G.a)(e,1)[0]];t.$refs.checkboxTreeTable.$refs.table.getUTreeData().forEach((function(e){r.includes(e)||t.$refs.checkboxTreeTable.$refs.table.setTreeExpansion(e,!1)}))}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onCloseDialog:function(){window.removeEventListener("resize",this.resizeThrottler,!1),this.$refs.versionInfoForm.resetFields(),this.$emit("update:dialogVisible",!1)},onClosedDialog:function(){this.active=0,this.lopResourceId=null},onSelectionChange:function(e){this.selectedId=Array.isArray(e)?e.map((function(e){return e.id})):[],this.selectedId=Array.from(new Set(this.selectedId))},onChangeLopResourceId:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a,n,i,s=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.selectedId=[],e.next=3,this.$refs.checkboxTreeTable.$refs.table.reloadData([]);case 3:if(this.loading=!0,!t){e.next=12;break}return e.next=7,this.handleQueryVersionDetails().catch((function(e){throw s.loading=!1,new Error("onChangeLopResourceId, ".concat(e))}));case 7:return e.next=9,this.$nextTick();case 9:this.$refs.checkboxTreeTable.echoSelection(),e.next=14;break;case 12:return e.next=14,this.handleQueryResourcesList().catch((function(e){throw s.loading=!1,new Error("onChangeLopResourceId, ".concat(e))}));case 14:return e.next=16,this.$nextTick();case 16:r=this.$refs.checkboxTreeTable.$refs.table.getUTreeData(),a=Object(G.a)(r,1),n=a[0],i=[n],this.$refs.checkboxTreeTable.$refs.table.getUTreeData().forEach((function(e){i.includes(e)||s.$refs.checkboxTreeTable.$refs.table.setTreeExpansion(e,!1)})),this.loading=!1;case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),onClickNextRuleStepButton:function(e){var t=this;this.$refs[e].validate(function(){var r=Object(i.a)(Object(o.a)().mark((function r(a){return Object(o.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!a){r.next=7;break}if("versionInfoForm"!==e){r.next=5;break}return r.next=4,t.handleCheckVersionCode().catch((function(e){throw new Error("onClickNextRuleStepButton, ".concat(e))}));case 4:t.active+=1;case 5:r.next=8;break;case 7:return r.abrupt("return",!1);case 8:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())},onClickPreviousStepButton:function(){this.active-=1},onClickNextAddStepButton:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleCreateVersion().catch((function(e){throw new Error("onClickNextAddStepButton, ".concat(e))}));case 2:this.active+=1,this.$emit("updateStatus");case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onClickISeeButton:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.$emit("update:dialogVisible",!1),this.$emit("clickISeeButton");case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},Ge=Be,He=(r("f797"),Object(f.a)(Ge,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"create-version-dialog",attrs:{visible:e.dialogVisible,"close-on-click-modal":!1,title:"创建版本",width:"900px",top:"5vh"},on:{opened:e.onOpenedDialog,close:e.onCloseDialog,closed:e.onClosedDialog},scopedSlots:e._u([{key:"footer",fn:function(){return[0===e.active?r("el-button",{on:{click:function(t){return e.$emit("update:dialogVisible",!1)}}},[e._v("取 消")]):e._e(),0===e.active?r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onClickNextRuleStepButton("versionInfoForm")}}},[e._v("下一步")]):e._e(),1===e.active?r("el-button",{on:{click:e.onClickPreviousStepButton}},[e._v("上一步")]):e._e(),1===e.active?r("el-button",{attrs:{type:"primary"},on:{click:e.onClickNextAddStepButton}},[e._v("下一步")]):e._e(),2===e.active?r("el-button",{attrs:{type:"primary"},on:{click:e.onClickISeeButton}},[e._v("我知道了")]):e._e()]},proxy:!0}])},[r("div",{staticClass:"dialog-content"},[r("Steps",{attrs:{active:e.active,titleList:["填写版本信息","选择资源","完成"]}}),r("el-form",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],ref:"versionInfoForm",staticClass:"version-info-form",attrs:{model:e.versionInfoFormData,rules:e.versionInfoFormRules,"label-width":"100px"}},e._l(e.versionInfoFormItemList,(function(t){var a=t.label,n=t.prop,o=t.placeholder;return r("el-form-item",{key:n,attrs:{label:a,prop:n}},[["detail","remark"].includes(n)?[r("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:o,rows:1,type:"textarea"},model:{value:e.versionInfoFormData[n],callback:function(t){e.$set(e.versionInfoFormData,n,t)},expression:"versionInfoFormData[prop]"}})]:"price"===n?[r("el-input-number",{staticStyle:{width:"80%"},attrs:{controls:!1,precision:2,min:0},model:{value:e.versionInfoFormData[n],callback:function(t){e.$set(e.versionInfoFormData,n,t)},expression:"versionInfoFormData[prop]"}}),r("span",{staticStyle:{"margin-left":"16px"}},[e._v("/ 年")])]:[r("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:o},model:{value:e.versionInfoFormData[n],callback:function(t){e.$set(e.versionInfoFormData,n,"string"==typeof t?t.trim():t)},expression:"versionInfoFormData[prop]"}})]],2)})),1),r("div",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],staticClass:"checkbox-tree-table"},[r("div",{staticClass:"revisions-select-wrapper"},[r("p",[e._v("历史版本模板参考（可选）：")]),r("el-select",{staticStyle:{width:"50%"},attrs:{clearable:!0},on:{change:e.onChangeLopResourceId},model:{value:e.lopResourceId,callback:function(t){e.lopResourceId=t},expression:"lopResourceId"}},e._l(e.lopResourceIdList,(function(t){return r("el-option",{key:t.lopResourceId,attrs:{label:t.versionName,value:t.lopResourceId}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.versionName))]),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.versionCode))])])})),1)],1),r("CheckboxTreeTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"checkboxTreeTable",attrs:{fullScreenHeight:e.fullScreenHeight,tableColumnList:e.tableColumnList,extendedList:e.extendedList},on:{selectionChange:e.onSelectionChange}})],1),2===e.active?r("p",{staticClass:"success-step"},[e._v(" 创建成功！您可前往【订阅】为租户开通版本。 ")]):e._e()],1)])}),[],!1,null,"4cb88f1f",null)),Je=He.exports,Qe={name:"CheckboxTreeTable",props:{fullScreenHeight:{type:Number,required:!0},styleTop:{type:String,default:"top: 184px"},noEditHeight:{type:Number,default:240},tableColumnList:{type:Array,default:[]},extendedList:{type:Array,default:function(){return[]}},treeConfig:{type:Object,default:function(){return{children:"childNodes",iconClose:"el-icon-arrow-right",iconOpen:"el-icon-arrow-down",indent:10,expandAll:!0}}}},data:function(){return{fullScreen:!1,flatChildren:[],flatParentList:[],selection:[]}},methods:(n={formatResourceTypeClass:function(e){return["normalColor","updateColor","deadColor"][e]},formatResourceTypeText:function(e){return["菜单","按钮","其它"][e]}},Object(Ve.a)(n,"formatResourceTypeText",(function(e){return["菜单","按钮","其它"][e]})),Object(Ve.a)(n,"formatterExtensionField",(function(e,t,r){if(Object.keys(e).includes(t.property)){var a=parseInt(t.property.replace("ext",""))-1,n=this.extendedList[a].enumValue;if(n){if(n.indexOf(",")>-1){var o={};return n.split(",").forEach((function(e){var t=e.split(":")[0],r=e.split(":")[1];o[r]=t})),Object.keys(o).includes(r)?o[r]:r}var i=n.split(":")[0];return r===n.split(":")[1]?i:r}return r}return r})),Object(Ve.a)(n,"getWidth",(function(){return this.fullScreen?"90%":"100%"})),Object(Ve.a)(n,"getMarginLeft",(function(){return this.fullScreen?"100px":"0px"})),Object(Ve.a)(n,"flattenChildren",(function(e){var t=this;this.flatChildren.push(e);var r=this.treeConfig.children;Array.isArray(e[r])&&e[r].length>0&&e[r].forEach((function(e){t.flattenChildren(e)}))})),Object(Ve.a)(n,"flattenParentList",(function(e,t,r){var a=this,n=this.treeConfig.children,o=e.id,i=e.parentId;if(o===t)return this.flatParentList.push(e),void(i&&this.flattenParentList(r,i,r));Array.isArray(e[n])&&e[n].length>0&&e[n].forEach((function(e){a.flattenParentList(e,t,r)}))})),Object(Ve.a)(n,"echoSelection",(function(){var e=this,t=this.$refs.table.getUTreeData(),r=Object(G.a)(t,1)[0];this.flatChildren=[],this.flattenChildren(r);this.selection=[],this.flatChildren.forEach((function(t){t.isPick&&(e.$refs.table.toggleRowSelection([{row:t,selected:true}]),e.selection.push(t))})),this.flatParentList=[]})),Object(Ve.a)(n,"onClickToggleFullScreenButton",(function(){var e=this;this.fullScreen=!this.fullScreen,this.$nextTick((function(){e.$refs.table.doLayout()}))})),Object(Ve.a)(n,"onSelectionChange",(function(e){e=this.$refs.table.getCheckboxRecords(),this.$emit("selectionChange",e)})),Object(Ve.a)(n,"onSelect",(function(e,t){var r=this,a=e.some((function(e){return e===t}));if(t=this.$refs.table.getUTreeData().find((function(e){return e.id===t.id})),this.flatChildren=[],this.flattenChildren(t),this.flatChildren.forEach((function(e){r.$refs.table.toggleRowSelection([{row:e,selected:a}])})),this.flatParentList=[],a){var n=this.$refs.table.getUTreeData(),o=Object(G.a)(n,1)[0],i=t.parentId;this.flattenParentList(o,i,o),this.flatParentList.forEach((function(e){r.$refs.table.toggleRowSelection([{row:e,selected:a}])})),this.selection=Array.from(new Set([].concat(Object(Pe.a)(this.selection),Object(Pe.a)(this.flatChildren),Object(Pe.a)(this.flatParentList))))}else this.selection=this.selection.filter((function(e){return!r.flatChildren.includes(e)}))})),Object(Ve.a)(n,"onSelectAll",(function(e){var t=this.$refs.table.getUTreeData(),r=Object(G.a)(t,1)[0];Array.isArray(e)&&e.length>0?this.onSelect([r],r):this.onSelect([],r)})),Object(Ve.a)(n,"onToggleTreeExpand",(function(){var e=this,t=this.selection;t.forEach((function(t){e.$refs.table.toggleRowSelection([{row:t,selected:true}])}))})),n)},Ke=Qe,We=(r("3df2"),Object(f.a)(Ke,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"check-table-tree",class:{"full-screen":e.fullScreen}},[e.fullScreen?r("div",{staticStyle:{"margin-top":"20px"}},[r("span",{staticStyle:{"font-size":"20px","margin-left":"100px"}},[e._v("选择版本资源")]),r("el-button",{staticClass:"exit-full-btn",staticStyle:{float:"right","margin-right":"100px"},attrs:{size:"medium",icon:"el-icon-full-screen"},on:{click:e.onClickToggleFullScreenButton}},[e._v("退出全屏")]),r("el-divider")],1):e._e(),0==e.fullScreen?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"列表全屏展示",placement:"top"}},[r("i",{staticClass:"el-icon-full-screen el-icon-right",style:e.styleTop,on:{click:e.onClickToggleFullScreenButton}})]):e._e(),r("u-table",{ref:"table",style:{"margin-left":e.getMarginLeft(),width:e.getWidth()},attrs:{"use-virtual":!0,height:e.fullScreen?e.fullScreenHeight:e.noEditHeight,"select-on-indeterminate":!1,"big-data-checkbox":!0,"tree-config":e.treeConfig,"row-id":"id",border:!0,stripe:!0,"beautify-table":!0,"row-height":57,"header-row-style":{color:"#666"},"cell-style":{color:"#333"}},on:{select:e.onSelect,"select-all":e.onSelectAll,"selection-change":e.onSelectionChange,"toggle-tree-expand":e.onToggleTreeExpand}},[r("u-table-column",{attrs:{type:"selection",width:"55"}}),e._l(e.tableColumnList,(function(t,a){return r("u-table-column",{key:a,attrs:{"tree-node":0===a,prop:t.prop,label:t.label,width:t.width,"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,n=t.column;return["resourceType"===n.property?r("span",{class:e.formatResourceTypeClass(a[n.property])},[e._v(" "+e._s(e.formatResourceTypeText(a[n.property]))+" ")]):[e._v(e._s(a[n.property]))]]}}],null,!0)})})),e._l(e.extendedList,(function(t,a){return r("u-table-column",{key:a+"extended",attrs:{prop:"ext"+(a+1),label:t.key,formatter:e.formatterExtensionField,"show-overflow-tooltip":!0}})}))],2)],1)}),[],!1,null,"bfd66f84",null)),Ze={name:"ViewResourcesDialog",components:{CheckboxTreeTable:We.exports},props:{dialogVisible:{type:Boolean,required:!0},extendedList:{type:Array,required:!0},lopResourceId:{type:Number}},data:function(){return{loading:!1,tableColumnList:[{prop:"resourceName",width:"300",label:"资源名称"},{prop:"resourceCode",width:"200",label:"资源编码"},{prop:"resourceType",label:"类型"}],resizeDebounceTimer:null,fullScreenHeight:460}},methods:{queryVersionDetails:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.lopResourceId,"MENUTREE",r={lopResourceId:t,category:"MENUTREE"},e.next=5,Ae.a.queryVersionDetails(r).catch((function(e){throw new Error("queryVersionDetails, ".concat(e))}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleQueryVersionDetails:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryVersionDetails().catch((function(e){throw new Error("handleQueryVersionDetails, ".concat(e))}));case 2:return t=e.sent,r=t.data,e.next=6,this.$refs.checkboxTreeTable.$refs.table.reloadData([r||{}]);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),resizeThrottler:function(){var e=this;clearTimeout(this.resizeDebounceTimer),this.resizeDebounceTimer=setTimeout((function(){e.fullScreenHeight=document.body.offsetHeight-100,e.$refs.checkboxTreeTable.$refs.table.doLayout()}),100)},onOpenedDialog:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,window.addEventListener("resize",this.resizeThrottler,!1),this.resizeThrottler(),e.next=5,this.handleQueryVersionDetails().catch((function(e){throw new Error("onOpenedDialog, ".concat(e))}));case 5:return e.next=7,this.$nextTick();case 7:return this.$refs.checkboxTreeTable.echoSelection(),e.next=10,this.$nextTick();case 10:t=this.$refs.checkboxTreeTable.$refs.table.getUTreeData(),r=Object(G.a)(t,1),a=r[0],n=[a],this.$refs.checkboxTreeTable.$refs.table.getUTreeData().forEach((function(e){n.includes(e)||i.$refs.checkboxTreeTable.$refs.table.setTreeExpansion(e,!1)})),this.loading=!1;case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onCloseDialog:function(){window.removeEventListener("resize",this.resizeThrottler,!1),this.$emit("update:dialogVisible",!1)}}},Xe=Ze,Ye=(r("78871"),Object(f.a)(Xe,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"view-resources-dialog",attrs:{visible:e.dialogVisible,"close-on-click-modal":!1,title:"查看资源",width:"900px",top:"5vh"},on:{opened:e.onOpenedDialog,close:e.onCloseDialog}},[r("div",{staticClass:"dialog-content"},[r("div",{staticClass:"checkbox-tree-table"},[r("CheckboxTreeTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"checkboxTreeTable",attrs:{fullScreenHeight:e.fullScreenHeight,tableColumnList:e.tableColumnList,extendedList:e.extendedList,noEditHeight:360,styleTop:"top: 60px"}})],1)])])}),[],!1,null,"4030f9e9",null)),et=Ye.exports,tt=r("754e"),rt={props:{title:{type:String,required:!0},showConfigurationDialog:{type:Boolean,required:!0},configureType:{type:Number,required:!0},productInfo:{type:Object,required:!0},associateIdList:{type:Array,required:!0},currentRow:{type:Object,required:!0}},data:function(){return{queryForm:{productSysGroupId:null},tableCloumnList:[],tableData:[],classificationOptions:[],rids:[],multipleSelection:[],loading:!0}},methods:{handleSelectionChange:function(e){this.multipleSelection=e},handleClose:function(){this.$emit("update:showConfigurationDialog",!1)},cancelConfiguration:function(){this.$emit("update:showConfigurationDialog",!1)},saveConfigurationData:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i,s=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.rids=[],this.multipleSelection.forEach((function(e){s.rids.push(e.id)})),this.rids=Array.from(new Set(this.rids)),t=this.rids,r=this.configureType,a=this.currentRow.id,n=this.productInfo.code,i={rids:t,sysVersionRefType:r,versionId:a,productCode:n},e.next=10,tt.a.packageSysVersion(i);case 10:e.sent&&(this.$message.success("保存成功"),this.$emit("update:showConfigurationDialog",!1),this.$emit("updateStatus"));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),queryProductSysgroupList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productInfo.code,r=this.configureType,a={productCode:t,type:r},e.next=5,tt.a.queryProductSysgroupList(a);case 5:n=e.sent,this.classificationOptions=n.data;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),queryOpenApiList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,t=this.productInfo.code,r=this.queryForm.productSysGroupId,1,1e3,a={productCode:t,productSysGroupId:r,pageNumb:1,pageSize:1e3},e.next=8,tt.a.queryOpenApiList(a);case 8:n=e.sent,this.tableData=n.data.list,this.associateIdList?this.echoSelection():(this.$refs.multipleTable.clearSelection(),this.loading=!1);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),querySpiList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,t=this.productInfo.code,r=this.queryForm.productSysGroupId,1,1e3,a={productCode:t,productSysGroupId:r,pageNumb:1,pageSize:1e3},e.next=8,tt.a.querySpiList(a);case 8:n=e.sent,this.tableData=n.data.list,this.associateIdList?this.echoSelection():(this.$refs.multipleTable.clearSelection(),this.loading=!1);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),echoSelection:function(){var e=this;this.tableData.forEach((function(t){e.associateIdList.forEach((function(r){t.id===r&&e.$nextTick((function(){e.$refs.multipleTable.toggleRowSelection(t,!0)}))}))})),this.loading=!1}},watch:{showConfigurationDialog:function(e){if(e){this.tableCloumnList=[[],[],[{label:"接口名称",prop:"methodName"},{label:"中文名称",prop:"cnName"},{label:"接口描述",prop:"remark"},{label:"别名",prop:"alias"},{label:"所属分类",prop:"productSysGroupCnName"}],[{label:"所属分类",prop:"productSysGroupCnName"},{label:"中文名称",prop:"cnName"},{label:"触发场景",prop:"docJssKey"},{label:"URL",prop:"uri"}],[{label:"TOPIC",prop:""},{label:"消息名称",prop:""},{label:"描述",prop:""},{label:"所属分类",prop:""}]][this.configureType],2===this.configureType?this.queryOpenApiList():3===this.configureType&&this.querySpiList(),this.queryProductSysgroupList()}}}},at=rt,nt=(r("333e"),Object(f.a)(at,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.showConfigurationDialog,title:e.title,"close-on-click-modal":!1,"before-close":e.handleClose,width:"900px",top:"5vh"},on:{"update:visible":function(t){e.showConfigurationDialog=t},close:e.handleClose}},[r("div",{staticClass:"dialog-wrapper"},[r("el-form",{attrs:{inline:!0,model:e.queryForm}},[r("el-form-item",[r("el-select",{attrs:{placeholder:"请选择分类"},model:{value:e.queryForm.productSysGroupId,callback:function(t){e.$set(e.queryForm,"productSysGroupId",t)},expression:"queryForm.productSysGroupId"}},e._l(e.classificationOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.cnName,value:e.id}})})),1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.queryOpenApiList}},[e._v("查询")])],1)],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"element-loading-background":"#ffffff",data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),e._l(e.tableCloumnList,(function(e,t){return[r("el-table-column",{key:t,attrs:{prop:e.prop,label:e.label,"show-overflow-tooltip":""}})]}))],2)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancelConfiguration}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveConfigurationData}},[e._v("保 存")])],1)])}),[],!1,null,"53880dbd",null)),ot=nt.exports,it={name:"VersionComparisonDialog",components:{Pagination:$e.a},data:function(){return{options:[{value:0,label:"全部"},{value:1,label:"新增"},{value:3,label:"减少"}],tableData:[],pageNumb:1,pageSize:10,total:0,status:0,versionComparisonList:[],tableCompareLoading:!1}},props:{showVersionComparisonDialog:{type:Boolean,default:!1},versionRow:{type:Object,required:!0},tenementRow:{type:Object,required:!0}},watch:{showVersionComparisonDialog:{handler:function(e){!0===e&&(this.status=0,this.queryVersionComparisonList())}}},methods:{formatStatusText:function(e){return{1:"新增",3:"减少"}[e]},closeVersionComparisonDialog:function(){this.$emit("update:showVersionComparisonDialog",!1)},queryVersionComparisonList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tableCompareLoading=!0,e.next=3,this.compare().catch((function(e){throw r.tableCompareLoading=!1,new Error("queryVersionComparisonList",e)}));case 3:t=e.sent,this.versionComparisonList=t.data,this.tableCompareLoading=!1,this.queryVersionComparisonPaginationList(1);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),queryVersionComparisonPaginationList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.pageNumb=t||this.pageNumb;var r=0===this.status?this.versionComparisonList:this.versionComparisonList.filter((function(t){return t.status===e.status}));r.length>0?(this.tableData=r.slice((this.pageNumb-1)*this.pageSize,this.pageNumb*this.pageSize),this.total=r.length):(this.tableData=[],this.total=0)},compare:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"MENUTREE",t=this.versionRow.lopResourceId,r=this.tenementRow.lopResourceId,a={category:"MENUTREE",currentLopResourceId:t,targetLopResourceId:r},e.next=6,Ae.a.compare(a).catch((function(e){throw new Error("compare",e)}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},st=it,ct=(r("44f5"),Object(f.a)(st,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"version-comparison-dialog"},[r("el-dialog",{attrs:{title:"版本对比详情",width:"700px","close-on-click-modal":!1,"before-close":e.closeVersionComparisonDialog,visible:e.showVersionComparisonDialog}},[r("el-form",{staticClass:"dialog-form"},[r("el-form-item",{attrs:{label:"差异类别"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.queryVersionComparisonPaginationList(1)}},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.options,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableCompareLoading,expression:"tableCompareLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"350"}},[r("el-table-column",{attrs:{prop:"status",label:"差异类别"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatStatusText(t.row.status)))]}}])}),r("el-table-column",{attrs:{prop:"resourceCode",label:"菜单资源编码"}}),r("el-table-column",{attrs:{prop:"resourceName",label:"菜单资源名称"}}),r("el-table-column",{attrs:{prop:"path",label:"菜单资源所处位置"}})],1),r("Pagination",{attrs:{currentPage:e.pageNumb,pageSize:e.pageSize,total:e.total,reloadTableData:e.queryVersionComparisonPaginationList},on:{"update:currentPage":function(t){e.pageNumb=t},"update:current-page":function(t){e.pageNumb=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"update:total":function(t){e.total=t}}})],1)],1)}),[],!1,null,"742d0826",null)),lt=ct.exports,ut=r("45e9"),dt=r.n(ut),pt={name:"DistributeDrawer",components:{VersionComparisonDialog:lt,Steps:Le.a,Pagination:$e.a},props:{showDrawerVisible:{type:Boolean,required:!0,default:!1},currentRow:{type:Object,required:!0}},data:function(){return{active:0,titleList:["选择租户","二次确认","下发结果"],tableHeight:500,pageNumb:1,pageSize:10,total:0,tenantListData:[],confirmationTableData:[],multipleSelection:[],showVersionComparisonDialog:!1,tenementRow:{},confirmation:{pageNumb:1,pageSize:10,total:0}}},mounted:function(){this.syncResourcesList(),this.resizeHeight(),window.addEventListener("resize",this.resizeHeight,!1)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeHeight,!1)},methods:{resizeHeight:dt.a.debounce((function(){this.tableHeight=window.innerHeight-350}),200),getRowKeys:function(e){return e.id},handleClose:function(){this.$emit("update:showDrawerVisible",!1),this.$emit("update:showDistributeDrawer",!1)},previousStep:function(){this.active-=1},submitBatchSync:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.batchSync().catch((function(e){throw new Error("submitBatchSync",e)}));case 2:this.active+=1;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),batchSync:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.multipleSelection.length>0&&this.multipleSelection.forEach((function(e){t.push(e.id)})),r=this.currentRow.id,a={activateIds:t,versionId:r},e.next=6,tt.a.batchSync(a).catch((function(e){throw new Error("batchSync",e)}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),selectTenantNextStep:function(){0===this.multipleSelection.length?this.$message.error("请至少选择一个租户！"):this.active+=1},handleCompareDetail:function(e){this.tenementRow=e,this.showVersionComparisonDialog=!0},syncResourcesList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i,s;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.currentRow.productId,2,r={productId:t,status:2},a=this.pageSize,n=this.pageNumb,i={pageSize:a,pageNumb:n},e.next=7,tt.a.syncResourcesList(r,i).catch((function(e){throw new Error("syncResourcesList",e)}));case 7:s=e.sent,this.tenantListData=s.data.list,this.total=s.data.total;case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleSelectionChange:function(e){this.multipleSelection=e,this.queryConfirmationPagination()},queryConfirmationPagination:function(){this.multipleSelection.length>0?(this.confirmationTableData=this.multipleSelection.slice((this.confirmation.pageNumb-1)*this.confirmation.pageSize,this.confirmation.pageNumb*this.confirmation.pageSize),this.confirmation.total=this.multipleSelection.length):(this.confirmationTableData=[],this.confirmation.total=0)}}},mt=pt,ft=(r("24ba"),Object(f.a)(mt,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"distribute-drawer"},[r("el-drawer",{attrs:{size:"708px",title:"下发资源",visible:e.showDrawerVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.showDrawerVisible=t}}},[r("Steps",{attrs:{active:e.active,titleList:e.titleList}}),r("div",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],staticClass:"drawer-content"},[r("p",{staticClass:"drawer-content-desc"},[e._v(" 请调整分页器后，在当页内勾选要使用新版本"+e._s(e.currentRow.versionCode)+"的租户，完成后点击下一步。 ")]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tenantListData,"row-key":e.getRowKeys,height:e.tableHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":!0}}),r("el-table-column",{attrs:{prop:"tenementName",label:"租户名称"}}),r("el-table-column",{attrs:{prop:"tenementCode",label:"租户编码"}}),r("el-table-column",{attrs:{prop:"envName",label:"开通环境"}}),r("el-table-column",{attrs:{prop:"versionName",label:"当前版本名称"}}),r("el-table-column",{attrs:{prop:"versionCode",label:"当前版本号"}}),r("el-table-column",{attrs:{label:"操作",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.handleCompareDetail(t.row)}}},[e._v("查看对比详情")])]}}])})],1),r("Pagination",{attrs:{currentPage:e.pageNumb,pageSize:e.pageSize,total:e.total,reloadTableData:e.syncResourcesList},on:{"update:currentPage":function(t){e.pageNumb=t},"update:current-page":function(t){e.pageNumb=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"update:total":function(t){e.total=t}}}),r("div",{staticClass:"drawer-content-footer"},[r("el-button",{on:{click:e.handleClose}},[e._v("返回")]),r("el-button",{attrs:{type:"primary"},on:{click:e.selectTenantNextStep}},[e._v("下一步")])],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],staticClass:"drawer-content"},[r("p",{staticClass:"drawer-content-desc"},[e._v(" 请再次确认是否要将新版本"+e._s(e.currentRow.versionCode)+"覆盖到如下租户中，确认无误请点下一步。 ")]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.confirmationTableData,height:e.tableHeight}},[r("el-table-column",{attrs:{prop:"tenementName",label:"租户名称"}}),r("el-table-column",{attrs:{prop:"tenementCode",label:"租户编码"}}),r("el-table-column",{attrs:{prop:"envName",label:"开通环境"}}),r("el-table-column",{attrs:{prop:"versionName",label:"当前版本名称"}}),r("el-table-column",{attrs:{prop:"versionCode",label:"当前版本号"}})],1),r("Pagination",{attrs:{currentPage:e.confirmation.pageNumb,pageSize:e.confirmation.pageSize,total:e.confirmation.total,reloadTableData:e.queryConfirmationPagination},on:{"update:currentPage":function(t){return e.$set(e.confirmation,"pageNumb",t)},"update:current-page":function(t){return e.$set(e.confirmation,"pageNumb",t)},"update:pageSize":function(t){return e.$set(e.confirmation,"pageSize",t)},"update:page-size":function(t){return e.$set(e.confirmation,"pageSize",t)},"update:total":function(t){return e.$set(e.confirmation,"total",t)}}}),r("div",{staticClass:"drawer-content-footer"},[r("el-button",{on:{click:e.previousStep}},[e._v("上一步")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submitBatchSync}},[e._v("下一步")])],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active === 2"}],staticClass:"drawer-content"},[r("div",{staticClass:"drawer-content-result"},[r("p",[e._v("由于本次下发资源量较大，系统正在异步下发，")]),r("p",[e._v("下发结果将通过邮件/咚咚通知，请注意查收。")])])])],1),r("VersionComparisonDialog",{attrs:{showVersionComparisonDialog:e.showVersionComparisonDialog,versionRow:e.currentRow,tenementRow:e.tenementRow},on:{"update:showVersionComparisonDialog":function(t){e.showVersionComparisonDialog=t},"update:show-version-comparison-dialog":function(t){e.showVersionComparisonDialog=t}}})],1)}),[],!1,null,"f62fd3b4",null)),ht=ft.exports,bt={name:"EditVersionDialog",data:function(){return{formLabelWidth:"100px",editVersionForm:{},editVersionRules:{versionName:[{required:!0,message:"请输入版本名称",trigger:"blur"},{max:30,message:"版本名称最大长度为30个字符"},{pattern:ve.a.normal,message:"版本名称不可输入特殊字符"}],versionCode:[{required:!0,message:"请输入版本编码",trigger:"blur"},{max:50,message:"版本编码最大长度为50个字符"},{pattern:ve.a.normal,message:"版本编码不可输入特殊字符"}],remark:[{max:120,message:"备注最大长度为120个字符"},{pattern:ve.a.normal,message:"备注不可输入特殊字符"}],detail:[{required:!0,message:"请输入版本描述",trigger:"blur"},{max:120,message:"描述最大长度为120个字符"}],price:[{required:!0,message:"请输入版本金额",trigger:"blur"},{pattern:ve.a.number,message:"版本金额只能输入数字及小数点后两位数"}]}}},props:{showEditVersionDialog:{type:Boolean,default:!1},currentRow:{type:Object,required:!0}},mounted:function(){this.getEditVersionDetail()},methods:{closeEditVersionDialog:function(e){this.$refs.editVersionForm&&this.$refs.editVersionForm.resetFields(),this.$emit("update:showEditVersionDialog",!1),e()},getEditVersionDetail:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.editVersionForm=JSON.parse(JSON.stringify(this.currentRow)),this.editVersionForm.price=this.editVersionForm.price/100;case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),updateVersion:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(i.a)(Object(o.a)().mark((function e(r){var a,n,i,s,c,l,u,d,p;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=13;break}return"MENUTREE",a=t.currentRow,n=a.lopResourceId,i=a.id,s=100*t.editVersionForm.price,c=t.editVersionForm,l=c.versionName,u=c.remark,d=c.detail,p={category:"MENUTREE",lopResourceId:n,versionName:l,remark:u,id:i,detail:d,price:s},e.next=8,tt.a.updateVersion(p).catch((function(e){throw new Error("updateVersion")}));case 8:t.$emit("updateStatus"),t.$emit("queryVersionList"),t.$emit("update:showEditVersionDialog",!1),e.next=14;break;case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},gt=bt,vt=(r("a283"),Object(f.a)(gt,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"edit-version-dialog"},[r("el-dialog",{attrs:{title:"编辑版本",width:"700px",top:"5vh","close-on-click-modal":!1,"before-close":e.closeEditVersionDialog,visible:e.showEditVersionDialog}},[r("div",{staticClass:"dialog-wrapper"},[r("el-form",{ref:"editVersionForm",staticClass:"wrapper-form",attrs:{model:e.editVersionForm,rules:e.editVersionRules}},[r("el-form-item",{attrs:{label:"版本名称:",prop:"versionName","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.editVersionForm.versionName,callback:function(t){e.$set(e.editVersionForm,"versionName",t)},expression:"editVersionForm.versionName"}})],1),r("el-form-item",{attrs:{label:"版本编码:",prop:"versionCode","label-width":e.formLabelWidth}},[r("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:e.editVersionForm.versionCode,callback:function(t){e.$set(e.editVersionForm,"versionCode",t)},expression:"editVersionForm.versionCode"}})],1),r("el-form-item",{attrs:{prop:"detail",label:"版本描述:","label-width":e.formLabelWidth}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",autocomplete:"off"},model:{value:e.editVersionForm.detail,callback:function(t){e.$set(e.editVersionForm,"detail",t)},expression:"editVersionForm.detail"}})],1),r("el-form-item",{attrs:{prop:"price",label:"版本金额:","label-width":e.formLabelWidth}},[r("el-input-number",{staticStyle:{width:"70%"},attrs:{min:0,controls:!1,precision:2,placeholder:"0.00",autocomplete:"off"},model:{value:e.editVersionForm.price,callback:function(t){e.$set(e.editVersionForm,"price",t)},expression:"editVersionForm.price"}}),r("span",{staticStyle:{"margin-left":"20px"}},[e._v("/ 年")])],1),r("el-form-item",{attrs:{prop:"remark",label:"备注:","label-width":e.formLabelWidth}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",autocomplete:"off"},model:{value:e.editVersionForm.remark,callback:function(t){e.$set(e.editVersionForm,"remark",t)},expression:"editVersionForm.remark"}})],1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){return e.$emit("update:showEditVersionDialog",!1)}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateVersion("editVersionForm")}}},[e._v("完 成")])],1)])],1)}),[],!1,null,"2a280733",null)),yt=vt.exports,wt=r("13b9"),xt={name:"ProductVersion",components:{TagTip:pe.default,Pagination:$e.a,CreateVersionDialog:Je,ViewResourcesDialog:et,ConfigurationDialog:ot,EditVersionDialog:yt,DistributeDrawer:ht},props:{productInfo:{type:Object,required:!0}},data:function(){return{productId:parseInt(this.$route.params.id),hrefHelpDocument:"//lcp.jdl.com/#/newHand/53054",tableData:[],tableColumnList:[{label:"序号",type:"index",width:"60"},{label:"版本名称",prop:"versionName",minWidth:"180",showOverflowTooltip:!0},{label:"版本编码",prop:"versionCode",minWidth:"180",showOverflowTooltip:!0},{label:"版本描述",prop:"detail",minWidth:"240",showOverflowTooltip:!0},{label:"版本金额",prop:"price",minWidth:"120"},{label:"创建人",prop:"createUser",minWidth:"160"},{label:"创建时间",prop:"createTime",minWidth:"180"},{label:"操作",minWidth:"360",fixed:"right"}],pageNum:1,pageSize:10,total:0,currentRow:{},createVersionDialogVisible:!1,extendedList:[],viewResourcesDialogVisible:!1,showEditVersionDialog:!1,showDrawerVisible:!1,showDistributeDrawer:!1,versionId:0,loading:!1,hasSubscription:!1,showConfigurationDialog:!1,title:"",configureType:2,associateIdList:[]}},filters:{formatTableColumnPriceText:function(e){return"number"==typeof e?"".concat(parseFloat(e/100).toFixed(2)):""}},methods:{queryVersionList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productId,r=this.pageNum,a=this.pageSize,"MENUTREE",n={productId:t,category:"MENUTREE",pageNum:r,pageSize:a},e.next=5,Ae.a.queryVersionList(n).catch((function(e){throw new Error("queryVersionList, ".concat(e))}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),queryConfig:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productId,"MENUTREE",r={productId:t,category:"MENUTREE"},e.next=5,wt.a.queryConfig(r).catch((function(e){throw new Error("queryConfig, ".concat(e))}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),query:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a,n,i;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.currentRow.id,a=r,n=this.productInfo.code,i={versionId:a,sysVersionRefType:t,productCode:n},e.next=7,Ae.a.ref.query(i).catch((function(e){throw new Error("query, ".concat(e))}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),checkVersionOpenStatus:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.currentRow.id,r={id:t},e.next=4,Ae.a.checkVersionOpenStatus(r).catch((function(e){throw new Error("checkVersionOpenStatus, ".concat(e))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),deleteVersion:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.currentRow.id,"MENUTREE",r={id:t,category:"MENUTREE"},e.next=5,Ae.a.deleteVersion(r).catch((function(e){throw new Error("deleteVersion, ".concat(e))}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleQueryVersionList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.queryVersionList().catch((function(e){throw new Error("handleQueryVersionList, ".concat(e))}));case 3:t=e.sent,r=t.data,a=r.list,n=r.total,this.tableData=Array.isArray(a)?a.map((function(e){return Object(B.a)(Object(B.a)({},e),{},{isOpen:!1})})):[],this.total=n||0,this.loading=!1;case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleQueryConfig:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryConfig().catch((function(e){throw new Error("handleQueryConfig, ".concat(e))}));case 2:t=e.sent,r=t.data,this.extendedList=Array.isArray(r)?r:[];case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleQuery:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query(t).catch((function(e){throw new Error("handleQuery, ".concat(e))}));case 2:r=e.sent,a=r.data,this.associateIdList=Array.isArray(a)?a.map((function(e){return e.id})):[],n=(new Map).set(2,"配置API").set(3,"配置扩展点"),this.showConfigurationDialog=!0,this.title=n.get(t)||"",this.configureType=t;case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),handleCheckVersionOpenStatus:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkVersionOpenStatus().catch((function(e){throw new Error("handleCheckVersionOpenStatus, ".concat(e))}));case 2:t=e.sent,r=t.data,this.hasSubscription=r||!1;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleDeleteVersion:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deleteVersion().catch((function(e){throw new Error("handleDeleteVersion, ".concat(e))}));case 2:this.$message.success("版本删除成功！");case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onClickCreateVersionButton:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.createVersionDialogVisible=!0,this.addVersionForm={},this.active=0,e.next=5,this.handleQueryConfig().catch((function(e){throw new Error("onClickCreateVersionButton, ".concat(e))}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onClickViewResources:function(e){this.currentRow=e,this.viewResourcesDialogVisible=!0},onClickDistributeButton:function(e){var t=this;this.showDistributeDrawer=!0,this.$nextTick((function(){t.showDrawerVisible=!0})),this.currentRow=e},onClickEditButton:function(e){this.showEditVersionDialog=!0,this.currentRow=e},onClickConfigureApiButton:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentRow=t,e.next=3,this.handleQuery(2).catch((function(e){throw new Error("onClickConfigureApiButton, ".concat(e))}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),onClickConfigureExtensionButton:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentRow=t,e.next=3,this.handleQuery(3).catch((function(e){throw new Error("onClickConfigureApiButton, ".concat(e))}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),onClickConfirmDeleteButton:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentRow=t,t.isOpen=!1,e.next=4,this.handleDeleteVersion().catch((function(e){throw new Error("onClickConfirmDeleteButton, ".concat(e))}));case 4:return this.$emit("updateStatus"),e.next=7,this.handleQueryVersionList().catch((function(e){throw new Error("onClickConfirmDeleteButton, ".concat(e))}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),onClickDeleteButton:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,r){var a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentRow=t,e.next=3,this.handleCheckVersionOpenStatus().catch((function(e){throw new Error("onClickDeleteButton, ".concat(e))}));case 3:t.isOpen=!0,this.$nextTick((function(){a.$refs[r][1].$refs.popper.previousSibling.remove()})),this.tableData=JSON.parse(JSON.stringify(this.tableData));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},created:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleQueryVersionList().catch((function(e){throw new Error("created, ".concat(e))}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},Dt=xt,Ct=(r("4cba"),Object(f.a)(Dt,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"product-version"},[r("TagTip",{attrs:{closable:!1}},[e._v(" 您可在列表中维护该软件全部版本。了解更多请看 "),r("a",{attrs:{href:e.hrefHelpDocument,target:"_blank"}},[e._v("新手帮助文档")])]),r("el-button",{staticStyle:{"margin-bottom":"8px",float:"right"},attrs:{type:"primary"},on:{click:e.onClickCreateVersionButton}},[e._v("创建版本")]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"hide-empty-img":!0}},e._l(e.tableColumnList,(function(t){var a=t.label,n=t.prop,o=t.width,i=t.minWidth,s=t.showOverflowTooltip,c=t.type,l=t.fixed;return r("el-table-column",{key:a,attrs:{label:a,prop:n,width:o,"min-width":i,"show-overflow-tooltip":s,type:c,fixed:l},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,o=t.row.price,i=t.column.property,s=t.$index;return["序号"===a?[e._v(" "+e._s(s+1)+" ")]:"price"===i?[r("span",[e._v(e._s(e._f("formatTableColumnPriceText")(o)))])]:"操作"===a?[r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.onClickViewResources(n)}}},[e._v("查看资源")]),r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.onClickDistributeButton(n)}}},[e._v("下发")]),r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.onClickEditButton(n)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.onClickConfigureApiButton(n)}}},[e._v("配置API")]),r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.onClickConfigureExtensionButton(n)}}},[e._v("配置扩展点")]),r("el-popover",{ref:"popover-"+s,refInFor:!0,attrs:{width:"200",placement:"top-end",trigger:"manual"},model:{value:n.isOpen,callback:function(t){e.$set(n,"isOpen",t)},expression:"row.isOpen"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.hasSubscription,expression:"hasSubscription"}]},[r("p",[e._v(" 当前版本已开通给租户，请先在[订阅]中关闭该租户版本再删除！ ")]),r("div",{staticStyle:{"text-align":"right",margin:"0"}},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){n.isOpen=!1}}},[e._v("我知道了")])],1)]),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.hasSubscription,expression:"!hasSubscription"}]},[r("p",[e._v(" 删除后，无法再创建相同【版本编码】的产品版本，确认删除吗？ ")]),r("div",{staticStyle:{"text-align":"right",margin:"0"}},[r("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){n.isOpen=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.onClickConfirmDeleteButton(n)}}},[e._v("删除")])],1)]),r("el-button",{staticStyle:{"margin-left":"8px",color:"#e1251b"},attrs:{slot:"reference",type:"text"},on:{click:function(t){return e.onClickDeleteButton(n,"popover-"+s)}},slot:"reference"},[e._v("删除")])],1)]:[r("span",[e._v(e._s(n[i]))])]]}}],null,!0)})})),1),r("Pagination",{attrs:{currentPage:e.pageNum,pageSize:e.pageSize,total:e.total,reloadTableData:e.handleQueryVersionList},on:{"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}}),r("CreateVersionDialog",{attrs:{dialogVisible:e.createVersionDialogVisible,extendedList:e.extendedList},on:{"update:dialogVisible":function(t){e.createVersionDialogVisible=t},"update:dialog-visible":function(t){e.createVersionDialogVisible=t},clickISeeButton:e.handleQueryVersionList,updateStatus:function(t){return e.$emit("updateStatus")}}}),r("ViewResourcesDialog",{attrs:{dialogVisible:e.viewResourcesDialogVisible,extendedList:e.extendedList,lopResourceId:e.currentRow.lopResourceId},on:{"update:dialogVisible":function(t){e.viewResourcesDialogVisible=t},"update:dialog-visible":function(t){e.viewResourcesDialogVisible=t}}}),e.showDistributeDrawer?r("DistributeDrawer",{attrs:{showDistributeDrawer:e.showDistributeDrawer,showDrawerVisible:e.showDrawerVisible,currentRow:e.currentRow},on:{"update:showDistributeDrawer":function(t){e.showDistributeDrawer=t},"update:show-distribute-drawer":function(t){e.showDistributeDrawer=t},"update:showDrawerVisible":function(t){e.showDrawerVisible=t},"update:show-drawer-visible":function(t){e.showDrawerVisible=t}}}):e._e(),e.showEditVersionDialog?r("EditVersionDialog",{attrs:{showEditVersionDialog:e.showEditVersionDialog,currentRow:e.currentRow},on:{"update:showEditVersionDialog":function(t){e.showEditVersionDialog=t},"update:show-edit-version-dialog":function(t){e.showEditVersionDialog=t},queryVersionList:e.handleQueryVersionList}}):e._e(),e.productInfo?r("ConfigurationDialog",{attrs:{showConfigurationDialog:e.showConfigurationDialog,title:e.title,configureType:e.configureType,productInfo:e.productInfo,associateIdList:e.associateIdList,currentRow:e.currentRow},on:{"update:showConfigurationDialog":function(t){e.showConfigurationDialog=t},"update:show-configuration-dialog":function(t){e.showConfigurationDialog=t},updateStatus:function(t){return e.$emit("updateStatus")}}}):e._e()],1)}),[],!1,null,"5df7c6fd",null)),St=Ct.exports,Ot=r("7aef"),kt={list:function(e){return Ot.a.post("/product/openapi/list",e)},apiRepositories:function(e){return Ot.a.post("/product/openapi/apiRepositories",e)},add:function(e){return Ot.a.post("/product/openapi/add",e)},delete:function(e){return Ot.a.get("/product/openapi/delete",{params:e})}},_t=kt,jt={list:function(e){return Ot.a.post("/product/spi/list",e)},upload:function(e){return Ot.a.post("/product/spi/upload",e)},save:function(e){return Ot.a.post("/product/spi/save",e)},update:function(e){return Ot.a.post("/product/spi/update",e)},delete:function(e){return Ot.a.get("/product/spi/delete",{params:e})},getDoc:function(e){return Ot.a.get("/product/spi/getDoc",{params:e})},editDoc:function(e){return Ot.a.post("/product/spi/editDoc",e)},settingIsOnline:function(e){return Ot.a.post("/product/spi/settingIsOnline",e)},settingUatIsOnline:function(e){return Ot.a.post("/product/spi/settingUatIsOnline",e)},cancelOnlineState:function(e){return Ot.a.post("/product/spi/cancelOnlineState",e,{headers:{"Content-Type":"application/json;charset=UTF-8"}})},cancelUatOnlineState:function(e){return Ot.a.post("/product/spi/cancelUatOnlineState",e,{headers:{"Content-Type":"application/json;charset=UTF-8"}})},hide:function(e){return Ot.a.post("/product/spi/hide",e,{headers:{"Content-Type":"application/json;charset=UTF-8"}})},show:function(e){return Ot.a.post("/product/spi/show",e,{headers:{"Content-Type":"application/json;charset=UTF-8"}})},deleteSysGroup:function(e){return c.a.delete("/product/sysGroup/delete/".concat(e))},saveSysGroup:function(e){return c.a.post("/product/sysGroup/batchSave",e)}},Tt=jt,Nt={list:function(e){return Ot.a.post("/product/sysGroup/list",e)},save:function(e){return Ot.a.post("/product/sysGroup/save",e)},openInterface:_t,openExtensionPoint:Tt},Et=Nt,It={name:"AddInterface",components:{Steps:Le.a},props:{addable:{type:Boolean,required:!0},productCode:{type:String,required:!0},type:{type:Number,required:!0},groupList:{type:Function}},data:function(){return{active:0,titleList:["选择接口","完成"],selectInterfaceFormData:{interfaceName:"",methodName:"",productSysGroupId:null},selectInterfaceFormRules:{interfaceName:[{required:!0,message:"请输入API中文或英文名称"}],methodName:[{required:!0,message:"请输入Method英文名称"}],productSysGroupId:[{required:!0,message:"请选择API所属分组"}]},interfaceNameOptionList:[],selectInterfaceNameLoading:!1,methodOptionList:[],selectMethodNameLoading:!1,groupOptionList:[],selectProductSysGroupIdLoading:!1,dialogVisible:!1,createCategoryFormData:{cnName:"",enName:""},createCategoryFormRules:{cnName:[{required:!0,message:"请输入分类中文名称"},{max:20,message:"长度不超过20个字符"},{pattern:ve.a.chinese,message:"请输入中文字符"}],enName:[{required:!0,message:"请输入分类英文名称"},{max:20,message:"长度不超过20个字符"},{pattern:ve.a.english,message:"请输入英文字母"}]}}},watch:{active:{handler:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t){e.next=3;break}return e.next=3,this.reloadGroupList().catch((function(){throw new Error("watch active")}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),immediate:!0}},methods:{apiRepositories:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={keyWords:t},e.next=3,_t.apiRepositories(r).catch((function(e){var t=e.data.message;throw t&&a.$message.error(t),new Error("apiRepositories")}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),groupSave:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i,s,c=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productCode,r=this.type,a=this.createCategoryFormData,n=a.cnName,i=a.enName,s={productCode:t,type:r,cnName:n,enName:i},e.next=5,Et.save(s).catch((function(e){var t=e.data.message;throw t&&c.$message.error(t),new Error("groupSave")}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),add:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i,s,c=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productCode,r=this.selectInterfaceFormData,a=r.interfaceName,n=r.methodName,i=r.productSysGroupId,s={productCode:t,interfaceName:a,methodName:n,productSysGroupId:i},e.next=5,_t.add(s).catch((function(e){var t=e.data.message;throw t&&c.$message.error(t),new Error("add")}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),remoteMethodInterfaceName:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===t){e.next=10;break}return this.selectInterfaceNameLoading=!0,e.next=4,this.apiRepositories(t).catch((function(){throw new Error("remoteMethodInterfaceName")}));case 4:r=e.sent,a=r.data.data,this.interfaceNameOptionList=a,this.selectInterfaceNameLoading=!1,e.next=11;break;case 10:this.interfaceNameOptionList=[];case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),changeSelectInterfaceName:function(e){var t=this;this.$refs.selectInterfaceForm.$children[1].resetField(),this.selectMethodNameLoading=!0,this.interfaceNameOptionList.some((function(r){var a=r.apiName,n=r.methodNameList;if(a===e)return t.methodOptionList=n,!0;t.methodOptionList=[]})),this.selectMethodNameLoading=!1},reloadGroupList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.selectProductSysGroupIdLoading=!0,e.next=3,this.groupList().catch((function(){throw new Error("reloadGroupList")}));case 3:t=e.sent,r=t.data.data,this.groupOptionList=r,this.selectProductSysGroupIdLoading=!1;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleConfirmAddInterface:function(){var e=this;this.$refs.selectInterfaceForm.validate(function(){var t=Object(i.a)(Object(o.a)().mark((function t(r){return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=8;break}return t.next=3,e.add().catch((function(){throw new Error("handleConfirmAddInterface")}));case 3:e.$refs.selectInterfaceForm.resetFields(),e.active=1,e.$emit("updateStatus"),t.next=9;break;case 8:return t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleConfirmCreateCategory:function(){var e=this;this.$refs.createCategoryForm.validate(function(){var t=Object(i.a)(Object(o.a)().mark((function t(r){return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=7;break}return t.next=3,e.groupSave().catch((function(){throw new Error("handleConfirmCreateCategory")}));case 3:e.reloadGroupList(),e.dialogVisible=!1,t.next=8;break;case 7:return t.abrupt("return",!1);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},closeDialog:function(){this.$refs.createCategoryForm.resetFields()}}},Ft=It,$t=(r("3b77"),Object(f.a)(Ft,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"add-interface"},[r("el-page-header",{attrs:{content:"添加接口"},on:{back:function(t){return e.$emit("update:addable",!1)}}}),r("Steps",{attrs:{active:e.active,titleList:e.titleList}}),r("div",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],staticClass:"select-interface-form-wrapper"},[r("p",{staticClass:"form-title"},[e._v("从API仓库选择接口")]),r("p",{staticClass:"form-tip"},[e._v(" 从API仓库中选择软件系统的相关接口，这些接口将在前台-软件系统对应的API文档中展示。 ")]),r("el-form",{ref:"selectInterfaceForm",staticClass:"select-interface-form",attrs:{model:e.selectInterfaceFormData,rules:e.selectInterfaceFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"API",prop:"interfaceName"}},[r("el-select",{staticStyle:{width:"70%"},attrs:{filterable:!0,remote:!0,"remote-method":e.remoteMethodInterfaceName,loading:e.selectInterfaceNameLoading,placeholder:"请输入API中文或英文名称"},on:{change:e.changeSelectInterfaceName},model:{value:e.selectInterfaceFormData.interfaceName,callback:function(t){e.$set(e.selectInterfaceFormData,"interfaceName",t)},expression:"selectInterfaceFormData.interfaceName"}},e._l(e.interfaceNameOptionList,(function(e){return r("el-option",{key:e.apiName,attrs:{label:e.apiName,value:e.apiName}})})),1)],1),r("el-form-item",{attrs:{label:"Method",prop:"methodName"}},[r("el-select",{staticStyle:{width:"70%"},attrs:{filterable:!0,loading:e.selectMethodNameLoading,placeholder:"请输入Method英文名称"},model:{value:e.selectInterfaceFormData.methodName,callback:function(t){e.$set(e.selectInterfaceFormData,"methodName",t)},expression:"selectInterfaceFormData.methodName"}},e._l(e.methodOptionList,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"所属分类",prop:"productSysGroupId"}},[r("el-select",{staticStyle:{width:"70%"},attrs:{loading:e.selectProductSysGroupIdLoading,placeholder:"请选择API所属分组"},model:{value:e.selectInterfaceFormData.productSysGroupId,callback:function(t){e.$set(e.selectInterfaceFormData,"productSysGroupId",t)},expression:"selectInterfaceFormData.productSysGroupId"}},e._l(e.groupOptionList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.cnName,value:e.id}})})),1),r("el-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("新增分类")])],1)],1),r("el-dialog",{attrs:{visible:e.dialogVisible,"close-on-click-modal":!1,title:"新增分类",width:"480px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.closeDialog}},[r("div",{staticClass:"dialog-content"},[r("el-form",{ref:"createCategoryForm",staticClass:"create-category-form",attrs:{model:e.createCategoryFormData,rules:e.createCategoryFormRules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"分类中文名称",prop:"cnName"}},[r("el-input",{attrs:{placeholder:"请输入分类中文名称，长度不超过20个字符"},model:{value:e.createCategoryFormData.cnName,callback:function(t){e.$set(e.createCategoryFormData,"cnName","string"==typeof t?t.trim():t)},expression:"createCategoryFormData.cnName"}})],1),r("el-form-item",{attrs:{label:"分类英文名称",prop:"enName"}},[r("el-input",{attrs:{placeholder:"请输入分类英文名称，长度不超过20个字符"},model:{value:e.createCategoryFormData.enName,callback:function(t){e.$set(e.createCategoryFormData,"enName","string"==typeof t?t.trim():t)},expression:"createCategoryFormData.enName"}})],1)],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirmCreateCategory}},[e._v("确 定")])],1)])],1),1===e.active?[e._m(0)]:e._e(),r("div",{staticClass:"button-wrapper"},[0===e.active?r("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirmAddInterface}},[e._v("确认添加")]):1===e.active?r("div",{staticClass:"button-wrapper__inner"},[r("el-button",{on:{click:function(t){return e.$emit("update:addable",!1)}}},[e._v("返回接口列表")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.active=0}}},[e._v("继续添加接口")])],1):e._e()],1)],2)}),[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"finish-wrapper"},[r("i",{staticClass:"el-icon-success"}),r("p",{staticClass:"finish-title"},[e._v("添加成功")]),r("p",{staticClass:"finish-tip"},[e._v("您可继续添加接口")])])}],!1,null,"167c4229",null)),Lt=$t.exports,Vt={name:"InterfaceList",components:{Pagination:$e.a},props:{addable:{type:Boolean,required:!0},productCode:{type:String,required:!0}},data:function(){return{productSysGroupId:void 0,keyWords:"",tableDataLoading:!0,tableData:[],tableList:[{prop:"methodName",label:"接口","min-width":"300"},{prop:"cnName",label:"中文名称","min-width":"180"},{prop:"remark",label:"接口描述","min-width":"180"},{prop:"supportedVersions",label:"支持的版本","min-width":"180"},{prop:"productSysGroupCnName",label:"所属分类","min-width":"180"}],currentPage:1,pageSize:10,total:0}},methods:{openInterfaceList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i,s,c=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productCode,r=this.productSysGroupId,a=this.keyWords,n=this.currentPage,i=this.pageSize,s={productCode:t,productSysGroupId:r,keyWords:a,pageNum:n,pageSize:i},e.next=5,_t.list(s).catch((function(e){var t=e.data.message;throw t&&c.$message.error(t),new Error("openInterfaceList")}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),delete:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={id:t},e.next=3,_t.delete(r).catch((function(e){var t=e.data.message;throw t&&a.$message.error(t),new Error("delete")}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),linkToApiDoc:function(e){var t=e.interfaceName,r=e.methodName;window.open("".concat(window.location.origin,"#/apiMethodList?qualifiedName=").concat(t,"&methodName=").concat(r),"_blank")},reloadTableData:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tableDataLoading=!0,e.next=3,this.openInterfaceList().catch((function(){throw new Error("reloadTableData")}));case 3:t=e.sent,r=t.data.data,a=r.total,n=r.list,this.total=a,this.tableData=n.map((function(e){return Object(B.a)(Object(B.a)({},e),{},{popoverVisible:!1})})),this.tableDataLoading=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleDeleteButton:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,r){var a,n,i,s;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openInterfaceList().catch((function(){throw new Error("handleDeleteButton")}));case 2:if(a=e.sent,n=a.data.data,i=n.list,s=i.some((function(e){var r=e.id,a=e.supportedVersions;return t.id===r&&a})),!s){e.next=11;break}return e.next=9,this.handleConfirmDeleteInterface(t);case 9:e.next=12;break;case 11:this.openDoubleCheckPopover(t,r);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),openDoubleCheckPopover:function(e,t){var r=this;e.popoverVisible=!0,this.$nextTick((function(){r.$refs[t].$refs.popper.previousSibling.remove()}))},handleConfirmDeleteInterface:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,e.next=3,this.delete(r).catch((function(){throw new Error("handleConfirmDeleteInterface")}));case 3:t.popoverVisible=!1,this.$message.success("删除接口成功！"),this.$emit("updateStatus"),this.reloadTableData();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},mounted:function(){this.reloadTableData()}},Pt=Vt,Rt=(r("2ce8"),Object(f.a)(Pt,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"interface-list"},[r("div",{staticClass:"search-wrapper"},[r("div"),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("update:addable",!0)}}},[e._v("添加接口")])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableDataLoading,expression:"tableDataLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,hideEmptyImg:!0}},[r("el-table-column",{attrs:{type:"index",label:"序号","min-width":"80"}}),e._l(e.tableList,(function(t,a){return r("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,"min-width":t["min-width"],"show-tooltip-when-overflow":!0},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,n=t.column;return["methodName"===n.property?[r("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.linkToApiDoc(a)}}},[e._v(e._s(a[n.property]))])]:[r("span",[e._v(e._s(a[n.property]))])]]}}],null,!0)})})),r("el-table-column",{attrs:{prop:"handle",label:"操作","min-width":"80",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,n=t.$index;return[r("el-popover",{ref:"popover-"+n,attrs:{placement:"top-end",width:"204",trigger:"manual","popper-class":"interface-list__table-column__popover"},model:{value:a.popoverVisible,callback:function(t){e.$set(a,"popoverVisible",t)},expression:"row.popoverVisible"}},[r("p",[e._v("删除后，API文档中将不显示该接口，但不会影响用户调用。")]),r("p",[e._v("是否仍要删除？")]),r("div",{staticStyle:{"text-align":"right",margin:"0"}},[r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){a.popoverVisible=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleConfirmDeleteInterface(a)}}},[e._v("确定")])],1),r("el-button",{staticStyle:{color:"#e1251b"},attrs:{slot:"reference",type:"text"},on:{click:function(t){return e.handleDeleteButton(a,"popover-"+n)}},slot:"reference"},[e._v("删除")])],1)]}}])})],2),e.total>0?r("Pagination",{attrs:{currentPage:e.currentPage,pageSize:e.pageSize,total:e.total,reloadTableData:e.reloadTableData},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"update:total":function(t){e.total=t}}}):e._e()],1)}),[],!1,null,"5ba87a20",null)),qt={name:"OpenInterface",components:{AddInterface:Lt,InterfaceList:Rt.exports},props:{productCode:{type:String,required:!0}},data:function(){return{addable:!1,type:2}},methods:{groupList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productCode,r=this.type,a={productCode:t,type:r},e.next=4,Et.list(a).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("groupList")}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},zt=qt,Mt=(r("bc4f"),Object(f.a)(zt,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"open-interface"},[e.addable?r("AddInterface",{attrs:{addable:e.addable,productCode:e.productCode,type:e.type,groupList:e.groupList},on:{"update:addable":function(t){e.addable=t},updateStatus:function(t){return e.$emit("updateStatus")}}}):r("InterfaceList",{attrs:{addable:e.addable,productCode:e.productCode},on:{"update:addable":function(t){e.addable=t},updateStatus:function(t){return e.$emit("updateStatus")}}})],1)}),[],!1,null,"42209974",null)),At=Mt.exports,Ut={name:"ClassificationDialog",props:{showClassificationDialog:{type:Boolean,required:!0},productCode:{type:String,required:!0},tableData:{type:Array,default:[]},queryTableList:{type:Function,default:null}},data:function(){return{type:3}},methods:{handleClose:function(){this.$emit("update:showClassificationDialog",!1)},newClassification:function(){this.tableData.push({cnName:"",enName:"",editNameState:!0,editCodeState:!0})},handleEdit:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.editNameState=!0,t.editCodeState=!1;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),handleDelete:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,r){var a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=t.id)){e.next=8;break}return e.next=4,Tt.deleteSysGroup(a).catch((function(e){throw new Error("handleDelete Error")}));case 4:return e.next=6,this.queryTableList();case 6:e.next=9;break;case 8:this.tableData.splice(r,1);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),handleSave:dt.a.debounce(Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productCode,r=this.type,a=[],this.tableData.forEach((function(e){a.push({id:e.id,cnName:e.cnName,enName:e.enName})})),n={productCode:t,type:r,groupList:a},e.next=6,this.saveSysGroup(n).catch((function(e){throw new Error("saveSysGroup Error")}));case 6:this.handleClose();case 7:case"end":return e.stop()}}),e,this)}))),300),saveSysGroup:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.saveSysGroup(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},Bt=Ut,Gt=(r("64a7"),Object(f.a)(Bt,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"classification-dialog",attrs:{width:"670px",title:"管理扩展点所属分类",visible:e.showClassificationDialog,"close-on-click-modal":!1},on:{close:e.handleClose}},[r("div",{staticClass:"dialog__header"},[r("p",{staticClass:"header__desc"},[e._v(" 创建扩展点分类，便于使用方在扩展点文档中根据分类快速找到目标扩展点。 ")]),e.tableData.length>=50?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"最多可添加50个分类",placement:"top"}},[r("el-button",{staticStyle:{color:"#7f7f7f"},attrs:{type:"text"}},[e._v("+ 新增分类")])],1):r("el-button",{attrs:{type:"text"},on:{click:e.newClassification}},[e._v("+ 新增分类")])],1),r("el-table",{staticClass:"dialog__table",attrs:{data:e.tableData,height:"350"}},[r("el-table-column",{attrs:{prop:"cnName",label:"分类名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.editNameState?r("el-input",{model:{value:t.row.cnName,callback:function(r){e.$set(t.row,"cnName","string"==typeof r?r.trim():r)},expression:"scope.row.cnName"}}):r("span",[e._v(e._s(t.row.cnName))])]}}])}),r("el-table-column",{attrs:{prop:"enName",label:"分类编码"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.editCodeState?r("el-input",{model:{value:t.row.enName,callback:function(r){e.$set(t.row,"enName","string"==typeof r?r.trim():r)},expression:"scope.row.enName"}}):r("span",[e._v(e._s(t.row.enName))])]}}])}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,n=t.$index;return[a.editNameState?e._e():r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑")]),r("el-button",{staticClass:"table__delete",attrs:{type:"text"},on:{click:function(t){return e.handleDelete(a,n)}}},[e._v("删除")])]}}])})],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.handleClose}},[e._v("关闭")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1)],1)}),[],!1,null,"07106d7f",null)),Ht=Gt.exports,Jt={name:"RegisterExtensionPoint",components:{Steps:Le.a,ClassificationDialog:Ht,MarkdownEditor:se.a},props:{currentDisplayComponentName:{type:String,required:!0},productCode:{type:String,required:!0},type:{type:Number,required:!0},groupList:{type:Function}},data:function(){return{active:0,titleList:["上传SPI定义文件","填写基础信息","描述触发场景","注册成功"],hrefHelpDocument:"//lcp.jdl.com/#".concat(window.env.docDescription),fileList:[],interfaceName:"",xmlJssKey:"",basicInfoFormData:{methodName:"",productSysGroup:{id:null},cnName:"",uri:""},basicInfoFormRules:{methodName:[{required:!0,message:"请输入方法名称"}],productSysGroup:[{required:!0,message:"请选择扩展点所属分类"}],cnName:[{required:!0,message:"请输入中文名称"}],uri:[{required:!0,message:"请输入URI"},{pattern:/^\//,message:"URI必须以/开头，例如：/u1"}]},methodOptionList:[],selectMethodNameLoading:!1,groupOptionList:[],selectProductSysGroupIdLoading:!1,docJssKey:"",createCategoryFormRules:{cnName:[{required:!0,message:"请输入分类中文名称"},{max:20,message:"长度不超过20个字符"},{pattern:ve.a.chinese,message:"请输入中文字符"}],enName:[{required:!0,message:"请输入分类英文名称"},{max:20,message:"长度不超过20个字符"},{pattern:ve.a.english,message:"请输入英文字母"}]},debounceTimer:null,confirmRegisterLoading:!1,showClassificationDialog:!1,spiTableData:[]}},computed:{computeHref:function(){var e=this.$store.state.tools.dictionary;try{return e.docLink.apiDescrFile.value}catch(e){return""}}},watch:{active:{handler:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==t){e.next=3;break}return e.next=3,this.reloadGroupList().catch((function(){throw new Error("watch active")}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),immediate:!0}},methods:{upload:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("file",t),e.next=4,Tt.upload(r).catch((function(e){var t=e.data.message;throw t&&a.$message.error(t),new Error("upload")}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),save:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i,s,c,l,u,d,p,m=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.docJssKey=this.$refs.MarkdownEditor.getValue(),t=this.productCode,r=this.interfaceName,a=this.xmlJssKey,n=this.docJssKey,i=this.basicInfoFormData,s=i.methodName,c=i.productSysGroup,l=i.cnName,u=i.uri,d=c.id,p={productCode:t,interfaceName:r,xmlJssKey:a,methodName:s,productSysGroupId:d,cnName:l,uri:u,docJssKey:n},e.next=7,Tt.save(p).catch((function(e){var t=e.data.message;throw t&&m.$message.error(t),new Error("save")}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),changeUploadFileList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a,n,i,s,c,l=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("text/xml"===(r=t.raw).type){e.next=5;break}return this.$message.error("只支持xml格式的文件！"),this.fileList=[],e.abrupt("return",!1);case 5:return e.next=7,this.upload(r).catch((function(){throw l.fileList=[],new Error("changeUploadFileList")}));case 7:a=e.sent,n=a.data.data,i=n.interfaceName,s=n.xmlJssKey,c=n.methodNameList,this.interfaceName=i||"",i&&i.length<255?(this.xmlJssKey=s,this.methodOptionList=c,this.$message.success("上传API描述文件成功！"),this.active=1):(this.fileList=[],this.$message.error("服务名称必须小于255个字符!"));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),reloadGroupList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.selectProductSysGroupIdLoading=!0,e.next=3,this.groupList().catch((function(){throw new Error("reloadGroupList")}));case 3:t=e.sent,r=t.data.data,this.groupOptionList=r,this.selectProductSysGroupIdLoading=!1;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),changeMethodName:function(e){var t=this.interfaceName,r=this.basicInfoFormData.productSysGroup.enName,a=void 0===r?"":r,n=t.split(".").slice(-1)[0];this.basicInfoFormData.uri="".concat(a,"/").concat(n,"/").concat(e)},verifyBasicInfoForm:function(){var e=this;this.$refs.basicInfoForm.validate((function(t){if(!t)return!1;e.active=2}))},resetFields:function(){this.fileList=[],this.$refs.basicInfoForm.resetFields(),this.docJssKey=""},handleConfirmRegisterExtensionPoint:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.confirmRegisterLoading=!0,e.next=3,t.save().catch((function(){throw t.confirmRegisterLoading=!1,new Error("handleConfirmRegisterExtensionPoint")}));case 3:t.active=3,t.resetFields(),t.$emit("updateStatus"),t.$nextTick((function(){t.confirmRegisterLoading=!1}));case 7:case"end":return e.stop()}}),e)}))),300);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleSpiClassification:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryTableList();case 2:this.showClassificationDialog=!0;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),queryTableList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryGroupList();case 2:t=e.sent,(r=t.data.data).forEach((function(e){e.editNameState=!1,e.editCodeState=!1})),this.spiTableData=r;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),queryGroupList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productCode,3,r={productCode:t,type:3},e.next=5,Et.list(r).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("queryGroupList")}));case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},Qt=Jt,Kt=(r("0d19"),Object(f.a)(Qt,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"register-extension-point"},[r("el-page-header",{attrs:{content:"注册扩展点"},on:{back:function(t){return e.$emit("update:currentDisplayComponentName","ExtensionPointList")}}}),r("Steps",{attrs:{active:e.active,titleList:e.titleList}}),0===e.active?r("el-upload",{staticClass:"upload-wrapper",attrs:{action:"upload",drag:!0,"auto-upload":!1,"file-list":e.fileList,"on-change":e.changeUploadFileList}},[r("i",{staticClass:"el-icon-upload"}),r("div",{staticClass:"el-upload__text"},[e._v(" 将IDEA插件生成的API描述文件拖到此处，或 "),r("em",[e._v("点击上传")])]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[r("a",{attrs:{href:e.computeHref,target:"_blank"}},[e._v("如何获取API描述文件?")])])]):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],staticClass:"basic-info-form-wrapper"},[r("el-form",{ref:"basicInfoForm",staticClass:"basic-info-form",attrs:{model:e.basicInfoFormData,rules:e.basicInfoFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"方法名称",prop:"methodName"}},[r("el-select",{staticStyle:{width:"70%"},attrs:{loading:e.selectMethodNameLoading,filterable:!0,clearable:!0,placeholder:"请选择方法名称"},on:{change:e.changeMethodName},model:{value:e.basicInfoFormData.methodName,callback:function(t){e.$set(e.basicInfoFormData,"methodName",t)},expression:"basicInfoFormData.methodName"}},e._l(e.methodOptionList,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"所属分类",prop:"productSysGroup"}},[r("el-select",{staticStyle:{width:"70%"},attrs:{"value-key":"id",loading:e.selectProductSysGroupIdLoading,placeholder:"请选择扩展点所属分组"},on:{focus:e.reloadGroupList},model:{value:e.basicInfoFormData.productSysGroup,callback:function(t){e.$set(e.basicInfoFormData,"productSysGroup",t)},expression:"basicInfoFormData.productSysGroup"}},e._l(e.groupOptionList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.cnName,value:e}})})),1),r("el-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleSpiClassification}},[e._v("管理分类")])],1),r("el-form-item",{attrs:{label:"中文名称",prop:"cnName"}},[r("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"请输入中文名称"},model:{value:e.basicInfoFormData.cnName,callback:function(t){e.$set(e.basicInfoFormData,"cnName","string"==typeof t?t.trim():t)},expression:"basicInfoFormData.cnName"}})],1),r("el-form-item",{attrs:{label:"URI",prop:"uri"}},[r("el-input",{staticStyle:{width:"70%"},attrs:{disabled:""},model:{value:e.basicInfoFormData.uri,callback:function(t){e.$set(e.basicInfoFormData,"uri","string"==typeof t?t.trim():t)},expression:"basicInfoFormData.uri"}})],1)],1),r("ClassificationDialog",{attrs:{showClassificationDialog:e.showClassificationDialog,tableData:e.spiTableData,productCode:e.productCode,queryTableList:e.queryTableList},on:{"update:showClassificationDialog":function(t){e.showClassificationDialog=t},"update:show-classification-dialog":function(t){e.showClassificationDialog=t},"update:tableData":function(t){e.spiTableData=t},"update:table-data":function(t){e.spiTableData=t},"update:productCode":function(t){e.productCode=t},"update:product-code":function(t){e.productCode=t}}})],1),2===e.active?r("MarkdownEditor",{ref:"MarkdownEditor",staticClass:"markdown-editor",model:{value:e.docJssKey,callback:function(t){e.docJssKey=t},expression:"docJssKey"}}):3===e.active?[r("div",{staticClass:"finish-wrapper"},[r("i",{staticClass:"el-icon-success"}),r("p",{staticClass:"finish-title"},[e._v("注册成功")]),r("p",{staticClass:"finish-tip"},[e._v("您可继续注册扩展点")])])]:e._e(),r("div",{staticClass:"button-wrapper"},[1===e.active?r("el-button",{attrs:{type:"primary"},on:{click:e.verifyBasicInfoForm}},[e._v("下一步")]):2===e.active?r("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirmRegisterExtensionPoint}},[e._v("确认注册")]):3===e.active?r("div",{staticClass:"button-wrapper__inner"},[r("el-button",{on:{click:function(t){return e.$emit("update:currentDisplayComponentName","ExtensionPointList")}}},[e._v("返回扩展点列表")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.active=0}}},[e._v("继续注册扩展点")])],1):e._e()],1)],2)}),[],!1,null,"4ce9f817",null)),Wt=Kt.exports,Zt={name:"ExtensionPointList",components:{Pagination:$e.a,MarkdownEditor:se.a},props:{currentDisplayComponentName:{type:String,required:!0},productCode:{type:String,required:!0},extensionPointId:{type:Number},methodName:{type:String,required:!0}},data:function(){return{env:window.env.buildEnv,productSysGroupId:void 0,keyWords:"",configMavenDialogVisible:!1,maven:"",mavenPlaceholder:"示例：\n<dependency>\n  <groupId>com.jd.lcp.test</groupId>\n  <artifactId>test-api</artifactId>\n  <version>1.3.0-TEST</version>\n</dependency>",tableDataLoading:!0,tableData:[],tableList:[{prop:"productSysGroupCnName",label:"所属分类","min-width":"180"},{prop:"cnName",label:"中文名称","min-width":"180"},{prop:"uri",label:"URI","min-width":"300"},{prop:"spiStatus",label:"状态","min-width":"80"},{prop:"supportedVersions",label:"支持的版本","min-width":"180"},{prop:"docJssKey",label:"触发场景","min-width":"280"},{prop:"isHide",label:"显示/隐藏","min-width":"100"}],docJssKeyDialogVisible:!1,docJssKeyData:{id:null,docJssKey:""},currentPage:1,pageSize:10,total:0}},computed:{computeCurrentEnvFormItemLabel:function(){return{local:"开发环境：",devtest:"开发环境：",publictest:"测试环境：",uat:"生产环境：",prod:"生产环境："}[this.env]||""},computeUatEnvFormItemLabel:function(){return{publictest:"开发环境：",uat:"预发环境：",prod:"预发环境："}[this.env]||""},computeUatEnvFormItemVisible:function(){return["publictest","uat","prod"].includes(this.env)}},methods:{list:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i,s,c=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productCode,r=this.productSysGroupId,a=this.keyWords,n=this.currentPage,i=this.pageSize,s={productCode:t,productSysGroupId:r,keyWords:a,pageNum:n,pageSize:i},e.next=5,Tt.list(s).catch((function(e){var t=e.data.message;throw t&&c.$message.error(t),new Error("list")}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),product:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.$route.params.id,r={id:t},e.abrupt("return",T.a.product(r).catch((function(e){var t=e.data.message;throw t&&a.$message.error(t),new Error("product")})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),SaveMaven:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=parseInt(this.$route.params.id),r=this.maven,a={productId:t,maven:r},e.next=5,T.a.maven(a).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("SaveMaven")}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),delete:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={id:t},e.next=3,Tt.delete(r).catch((function(e){var t=e.data.message;throw t&&a.$message.error(t),new Error("delete")}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,r){var a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:t,docJssKey:r},e.next=3,Tt.update(a).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("update")}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),settingIsOnline:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,r){var a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:t,spiIsOnline:r},e.next=3,Tt.settingIsOnline(a).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("settingIsOnline")}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),settingUatIsOnline:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,r){var a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:t,spiUatIsOnline:r},e.next=3,Tt.settingUatIsOnline(a).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("settingUatIsOnline")}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),cancelOnlineState:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.cancelOnlineState(t).catch((function(e){var t=e.data.message;throw t&&r.$message.error(t),new Error("cancelOnlineState")}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),cancelUatOnlineState:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.cancelUatOnlineState(t).catch((function(e){var t=e.data.message;throw t&&r.$message.error(t),new Error("cancelUatOnlineState")}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),hide:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.hide(t).catch((function(e){var t=e.data.message;throw t&&r.$message.error(t),new Error("hide")}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),show:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.show(t).catch((function(e){var t=e.data.message;throw t&&r.$message.error(t),new Error("show")}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),formatDocJssKeyText:function(e){return e&&e.length>20?"".concat(e.slice(0,20),"..."):e||""},formatSpiStatusText:function(e){var t=this.$store.state.tools.dictionary;try{return t.spiStatus[e].value}catch(t){return e||""}},formatSpiStatusClassName:function(e){return{0:"initColor",1:"normalColor",2:"updateColor"}[e]||""},formatIsHideText:function(e){var t=this.$store.state.tools.dictionary;try{return t.isHide[e].value}catch(e){return spiStatus||""}},judgeDeleteExtensionPointButtonVisible:function(e){return[0].includes(e)},judgeSpiRunningStatusButtonVisible:function(e){return[0,1,2,3].includes(e)},formatSpiRunningStatusText:function(e,t){var r=this.$store.state.tools.dictionary;try{return r[t][e].value}catch(t){return e||"-"}},formatSpiRunningStatusButtonText:function(e){return{0:"上线",1:"下线",2:"取消上线",3:"取消下线"}[e]||""},formatHideOrCancelHideButtonText:function(e){return{0:"隐藏",1:"取消隐藏"}[e]||""},handleHideOrCancelHideExtensionPoint:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a,n,s=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.id,a=t.isHide,n={0:function(){s.$confirm("隐藏后，前台扩展点文档以及之后创建的扩展点应用中将隐藏该扩展点，历史创建的应用将提示该扩展点即将下线。是否仍要隐藏？",{confirmButtonText:"隐 藏",cancelButtonText:"取 消",type:"warning",showClose:!1,closeOnClickModal:!1}).then(Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.hide(r).catch((function(){throw new Error("handleHideOrCancelHideExtensionPoint hide")}));case 2:s.$message.success("操作成功！"),s.reloadTableData();case 4:case"end":return e.stop()}}),e)}))))},1:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.show(r).catch((function(){throw new Error("handleHideOrCancelHideExtensionPoint show")}));case 2:s.$message.success("操作成功！"),s.reloadTableData();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},n[a]&&n[a]();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),toggleSpiRunningStatus:function(e,t){var r=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n={0:function(){return this[1]()},1:function(){return r.handleSpiRunningStatusOnlineOrOffline(e,t,a)},2:function(){return this[3]()},3:function(){return r.handleSpiRunningStatusCancelOnlineOrOffline(e,a)}};n[t]&&n[t]()},handleSpiRunningStatusOnlineOrOffline:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,r,a){var n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Number(!Boolean(r)),!a){e.next=6;break}return e.next=4,this.settingUatIsOnline(t,n).catch((function(){throw new Error("handleSpiRunningStatusOnlineOrOffline settingUatIsOnline")}));case 4:e.next=8;break;case 6:return e.next=8,this.settingIsOnline(t,n).catch((function(){throw new Error("handleSpiRunningStatusOnlineOrOffline settingIsOnline")}));case 8:this.$message.success("操作成功！"),this.reloadTableData();case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,a){return e.apply(this,arguments)}}(),handleSpiRunningStatusCancelOnlineOrOffline:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,r){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=5;break}return e.next=3,this.cancelUatOnlineState(t).catch((function(){throw new Error("handleSpiRunningStatusCancelOnlineOrOffline cancelUatOnlineState")}));case 3:e.next=7;break;case 5:return e.next=7,this.cancelOnlineState(t).catch((function(){throw new Error("handleSpiRunningStatusCancelOnlineOrOffline cancelOnlineState")}));case 7:this.$message.success("操作成功！"),this.reloadTableData();case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),reloadTableData:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.$emit("updateStatus"),this.tableDataLoading=!0,e.next=4,this.list().catch((function(){throw new Error("reloadTableData")}));case 4:t=e.sent,r=t.data.data,a=r.total,n=r.list,this.total=a||0,this.tableData=n||[],this.tableDataLoading=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),openConfigMavenDialog:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.product().catch((function(){throw new Error("openConfigMavenDialog")}));case 2:t=e.sent,r=t.data.data,a=r.maven,this.maven=a;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),closeConfigMavenDialog:function(){this.maven=""},handleSaveMavenConfig:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SaveMaven().catch((function(){throw new Error("handleSaveMavenConfig")}));case 2:this.$message.success("保存Maven配置成功！"),this.configMavenDialogVisible=!1;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleExpandDocJssKey:function(e){this.docJssKeyDialogVisible=!0;var t=e.id,r=e.docJssKey;this.docJssKeyData={id:t,docJssKey:r}},closeDocJssKeyDialog:function(){this.docJssKeyData={id:null,docJssKey:""}},handleSaveDocJssKey:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.docJssKeyData.docJssKey=this.$refs.MarkdownEditor.getValue(),t=this.docJssKeyData,r=t.id,a=t.docJssKey,e.next=4,this.update(r,a).catch((function(){throw new Error("handleSaveDocJssKey")}));case 4:this.$message.success("保存触发场景成功！"),this.docJssKeyDialogVisible=!1,this.reloadTableData();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleEditExtensionPointDocumentButton:function(e){var t=e.id,r=e.methodName;this.$emit("update:extensionPointId",t),this.$emit("update:methodName",r),this.$emit("update:currentDisplayComponentName","EditExtensionPointDocument")},handleDeleteExtensionPoint:function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,e.next=3,this.delete(r).catch((function(){throw new Error("handleDeleteExtensionPoint")}));case 3:this.$message.success("删除扩展点成功！"),this.reloadTableData();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),onCopy:function(e){this.$message.success("复制成功")},onError:function(e){this.$message.error("复制失败")}},mounted:function(){this.reloadTableData()}},Xt=Zt,Yt=(r("f4b6"),Object(f.a)(Xt,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"extension-point-list"},[r("div",{staticClass:"search-wrapper"},[r("div"),r("div",{staticClass:"button-wrapper"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("update:currentDisplayComponentName","RegisterExtensionPoint")}}},[e._v("注册扩展点")])],1)]),r("el-dialog",{staticClass:"config-maven-dialog",attrs:{visible:e.configMavenDialogVisible,"close-on-click-modal":!1,title:"配置扩展点Maven坐标",width:"560px"},on:{"update:visible":function(t){e.configMavenDialogVisible=t},open:e.openConfigMavenDialog,close:e.closeConfigMavenDialog}},[r("div",{staticClass:"dialog-content"},[r("p",[e._v("请填写Maven坐标：")]),r("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",resize:"none",rows:7,placeholder:e.mavenPlaceholder},model:{value:e.maven,callback:function(t){e.maven=t},expression:"maven"}})],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.configMavenDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handleSaveMavenConfig}},[e._v("保 存")])],1)]),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableDataLoading,expression:"tableDataLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,hideEmptyImg:!0}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,n=a.id,o=a.spiRunningStatus,i=a.spiUatRunningStatus;return[r("p",{staticClass:"expand-row__title"},[e._v("扩展点运行状态：")]),r("el-form",{staticClass:"expand-row__form",attrs:{"label-position":"left",model:{}}},[r("el-form-item",{attrs:{label:e.computeCurrentEnvFormItemLabel}},[r("span",[e._v(" "+e._s(e.formatSpiRunningStatusText(o,"spiRunningStatus"))+" ")]),e.judgeSpiRunningStatusButtonVisible(o)?r("el-button",{staticStyle:{"margin-left":"16px"},attrs:{type:"text"},on:{click:function(t){return e.toggleSpiRunningStatus(n,o)}}},[e._v(" "+e._s(e.formatSpiRunningStatusButtonText(o))+" ")]):e._e()],1),e.computeUatEnvFormItemVisible?r("el-form-item",{attrs:{label:e.computeUatEnvFormItemLabel}},[r("span",[e._v(" "+e._s(e.formatSpiRunningStatusText(i,"spiUatRunningStatus"))+" ")]),e.judgeSpiRunningStatusButtonVisible(i)?r("el-button",{staticStyle:{"margin-left":"16px"},attrs:{type:"text"},on:{click:function(t){return e.toggleSpiRunningStatus(n,i,!0)}}},[e._v(" "+e._s(e.formatSpiRunningStatusButtonText(i))+" ")]):e._e()],1):e._e()],1)]}}])}),r("el-table-column",{attrs:{type:"index",label:"序号","min-width":"80"}}),e._l(e.tableList,(function(t,a){return r("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,"min-width":t["min-width"],"show-tooltip-when-overflow":!0},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,n=t.column;return["uri"===n.property?[r("div",{staticClass:"table-cell__uri"},[r("p",{staticClass:"table-cell__uri__text",domProps:{textContent:e._s(a[n.property])}}),r("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a[n.property],expression:"row[column.property]",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},[r("i",{staticClass:"el-icon-document-copy"})])])]:"docJssKey"===n.property?[r("div",{staticClass:"table-cell__doc-jss-key"},[r("p",{staticClass:"table-cell__doc-jss-key__text",domProps:{textContent:e._s(e.formatDocJssKeyText(a[n.property]))}}),r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleExpandDocJssKey(a)}}},[e._v("展开")])],1)]:"spiStatus"===n.property?[r("span",{class:e.formatSpiStatusClassName(a[n.property]),domProps:{textContent:e._s(e.formatSpiStatusText(a[n.property]))}})]:"isHide"===n.property?[r("span",{domProps:{textContent:e._s(e.formatIsHideText(a[n.property]))}})]:[r("span",[e._v(e._s(a[n.property]))])]]}}],null,!0)})})),r("el-table-column",{attrs:{prop:"handle",label:"操作","min-width":"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,n=t.row,o=n.spiStatus,i=n.isHide;return[r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEditExtensionPointDocumentButton(a)}}},[e._v("对外文档")]),r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleHideOrCancelHideExtensionPoint(a)}}},[e._v(" "+e._s(e.formatHideOrCancelHideButtonText(i))+" ")]),e.judgeDeleteExtensionPointButtonVisible(o)?r("el-button",{staticStyle:{color:"#e1251b"},attrs:{type:"text"},on:{click:function(t){return e.handleDeleteExtensionPoint(a)}}},[e._v("删除")]):e._e()]}}])})],2),e.total>0?r("Pagination",{attrs:{currentPage:e.currentPage,pageSize:e.pageSize,total:e.total,reloadTableData:e.reloadTableData},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"update:total":function(t){e.total=t}}}):e._e(),e.docJssKeyDialogVisible?r("el-dialog",{staticClass:"doc-jss-key-dialog",attrs:{visible:e.docJssKeyDialogVisible,"close-on-click-modal":!1,title:"扩展点触发场景",width:"640px"},on:{"update:visible":function(t){e.docJssKeyDialogVisible=t},close:e.closeDocJssKeyDialog}},[r("div",{staticClass:"dialog-content"},[r("MarkdownEditor",{ref:"MarkdownEditor",staticClass:"markdown-editor",model:{value:e.docJssKeyData.docJssKey,callback:function(t){e.$set(e.docJssKeyData,"docJssKey",t)},expression:"docJssKeyData.docJssKey"}})],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.docJssKeyDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handleSaveDocJssKey}},[e._v("保 存")])],1)]):e._e()],1)}),[],!1,null,"667cd9a6",null)),er=Yt.exports,tr={name:"ApiTable",props:{tableColumnInfo:{type:Array,default:[]},tableData:{type:Array,default:function(){return[]}},showOperation:{type:Boolean,default:!1},editer:{type:Boolean,default:!0},inputMaxL:50,hideEmptyImg:{type:Boolean,default:!1}},data:function(){return{options:[{value:0,label:"否"},{value:1,label:"是"}]}},methods:{tableRowClassName:function(e){var t=e.row;if(e.rowIndex,t.modify){if(1==t.modify)return"api_update_del";if(2==t.modify)return"api_update_modify";if(3==t.modify)return"api_update_add"}return""}}},rr=tr,ar=(r("78c7"),Object(f.a)(rr,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-table",{staticClass:"api-table",staticStyle:{"margin-bottom":"24px"},attrs:{data:e.tableData,"tree-props":{children:"children"},"row-key":"id","row-class-name":e.tableRowClassName,stripe:"","default-expand-all":"","hide-empty-img":e.hideEmptyImg}},[e._t("customColumn",[e._l(e.tableColumnInfo,(function(t,a){return[t.modify?e._e():r("el-table-column",{key:t.prop+"-"+a,attrs:{prop:t.prop,label:t.label,width:t.width,"min-width":t.min_width,align:t.align||"left","show-tooltip-when-overflow":e.editer},scopedSlots:e._u([{key:"default",fn:function(t){return["modify"==t.column.property&&1==t.row[t.column.property]?r("span",[e._v("删除参数")]):e._e(),"modify"==t.column.property&&2==t.row[t.column.property]?r("span",[e._v("变更参数类型")]):e._e(),"modify"==t.column.property&&3==t.row[t.column.property]?r("span",[e._v("增加参数")]):e._e(),"modify"!=t.column.property?r("span",[e._v(e._s(t.row[t.column.property]))]):e._e()]}}],null,!0)}),t.modify&&"input"==t.type?r("el-table-column",{key:t.prop+"-"+a,attrs:{prop:t.prop,label:t.label,width:t.width,"min-width":t.min_width,align:t.align||"left","show-tooltip-when-overflow":e.editer},scopedSlots:e._u([{key:"default",fn:function(t){return["exampleValue"==t.column.property?r("div",["Long"==t.row.oldtype||"long"==t.row.type||"Integer"==t.row.oldtype||"int"==t.row.type||"java.math.BigInteger"==t.row.type?r("div",[e.editer||t.row.judgeChildren?e._e():r("el-input-number",{attrs:{placeholder:t.column.label,size:"medium",precision:0,step:1},model:{value:t.row[t.column.property],callback:function(r){e.$set(t.row,t.column.property,r)},expression:"scope.row[scope.column.property]"}})],1):"Double"==t.row.oldtype||"double"==t.row.type||"Float"==t.row.oldtype||"float"==t.row.type||"java.math.BigDecimal"==t.row.type?r("div",[e.editer||t.row.judgeChildren?e._e():r("el-input-number",{attrs:{placeholder:t.column.label,size:"medium",step:.1},model:{value:t.row[t.column.property],callback:function(r){e.$set(t.row,t.column.property,r)},expression:"scope.row[scope.column.property]"}})],1):"java.util.Date"==t.row.type||"java.sql.Timestamp"==t.row.type?r("div",[e.editer||t.row.judgeChildren?e._e():r("el-date-picker",{attrs:{type:"datetime",placeholder:t.column.label,"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.row[t.column.property],callback:function(r){e.$set(t.row,t.column.property,r)},expression:"scope.row[scope.column.property]"}})],1):"java.lang.Boolean"==t.row.type||"boolean"==t.row.type?r("div",[e.editer||t.row.judgeChildren?e._e():r("el-select",{attrs:{placeholder:t.column.label},model:{value:t.row[t.column.property],callback:function(r){e.$set(t.row,t.column.property,r)},expression:"scope.row[scope.column.property]"}},[r("el-option",{attrs:{value:!0}}),r("el-option",{attrs:{value:!1}})],1)],1):r("div",[e.editer||t.row.judgeChildren?e._e():r("el-input",{attrs:{maxlength:"100",placeholder:t.column.label},model:{value:t.row[t.column.property],callback:function(r){e.$set(t.row,t.column.property,"string"==typeof r?r.trim():r)},expression:"scope.row[scope.column.property]"}})],1)]):r("div",[e.editer?e._e():r("el-input",{attrs:{maxlength:"100",placeholder:t.column.label},model:{value:t.row[t.column.property],callback:function(r){e.$set(t.row,t.column.property,"string"==typeof r?r.trim():r)},expression:"scope.row[scope.column.property]"}})],1),e.editer?r("div",[e._v(e._s(t.row[t.column.property]))]):e._e()]}}],null,!0)}):e._e(),t.modify&&"textarea"==t.type?r("el-table-column",{key:t.prop+"-"+a,attrs:{prop:t.prop,label:t.label,width:t.width,"min-width":t.min_width,align:t.align||"left","show-tooltip-when-overflow":e.editer},scopedSlots:e._u([{key:"default",fn:function(t){return[e.editer?e._e():r("el-input",{attrs:{type:"textarea",resize:"none",rows:1,maxlength:"255",placeholder:"错误消息"===t.column.label?"错误消息，长度不超过255":t.column.label},model:{value:t.row[t.column.property],callback:function(r){e.$set(t.row,t.column.property,r)},expression:"scope.row[scope.column.property]"}}),e.editer?r("div",{staticClass:"wb-doc-title"},[e._v(" "+e._s(t.row[t.column.property])+" ")]):e._e()]}}],null,!0)}):e._e(),t.modify&&"select"==t.type?r("el-table-column",{key:t.prop+"-"+a,attrs:{prop:t.prop,label:t.label,width:t.width,"min-width":t.min_width,align:t.align||"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.editer?r("div",[0===t.row[t.column.property]?r("span",[e._v("否")]):e._e(),1===t.row[t.column.property]?r("span",[e._v("是")]):e._e()]):e._e(),e.editer?e._e():r("el-select",{attrs:{placeholder:"请选择"},model:{value:t.row[t.column.property],callback:function(r){e.$set(t.row,t.column.property,r)},expression:"scope.row[scope.column.property]"}},e._l(e.options,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}],null,!0)}):e._e()]}))])],2)}),[],!1,null,"12fdb558",null)),nr=ar.exports,or={name:"EditExtensionPointDocument",components:{StickyWrapper:R.a,ApiTable:nr,ClassificationDialog:Ht},props:{productCode:{type:String,required:!0},extensionPointId:{type:Number,required:!0},methodName:{type:String,required:!0}},data:function(){return{loading:!0,editable:!0,extensionPointFormData:{cnName:"",remark:"",productSysGroupId:null},showClassificationDialog:!1,extensionPointFormRules:{cnName:[{required:!0,message:"扩展点中文名称不能为空"},{min:2,max:255,message:"长度在 2 到 20 个字符"}],remark:[{required:!0,message:"扩展点描述不能为空"},{min:2,max:255,message:"长度在 2 到 255 个字符"}]},methodObj:{},oldMethodObj:{},errorCodeForm:{tableData:[],oldTableData:[]},errorCodeFormRules:{errorCode:[{required:!0,message:"请输入错误码"},{min:1,max:200,message:"长度在 1 到 200 个字符"}],errorMsg:[{required:!0,message:"请输入错误消息"},{min:2,max:255,message:"长度在 2 到 255 个字符"}]},columnsErrorCode:[{prop:"errorCode",label:"错误码",modify:!0,min_width:"35%"},{prop:"errorMsg",label:"错误消息",modify:!0,min_width:"60%"}],columnsInParams:[{prop:"name",label:"名称",min_width:"30%"},{prop:"oldtype",label:"类型",min_width:"30%"},{prop:"required",label:"是否必填",min_width:"21%",modify:!0,type:"select"},{prop:"exampleValue",label:"示例",min_width:"20%",modify:!0,type:"input"},{prop:"remark",label:"描述",min_width:"25%",modify:!0,type:"textarea"}],columnsOutParams:[{prop:"name",label:"名称",min_width:"30%"},{prop:"oldtype",label:"类型",min_width:"30%"},{prop:"exampleValue",label:"示例",min_width:"20%",modify:!0,type:"input"},{prop:"remark",label:"描述",min_width:"25%",modify:!0,type:"textarea"}],saveLoading:!1,sysGroupOptions:[],spiTableData:[]}},methods:{getDoc:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.extensionPointId,r={id:t},e.next=5,Tt.getDoc(r).catch((function(e){var t=e.data.message;throw t&&a.$message.error(t),new Error("getDoc")}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),editDoc:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n,i,s,c,l,u,d,p,m,f,h,b=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productCode,r=this.extensionPointId,a=r,n=this.extensionPointFormData,i=n.cnName,s=n.remark,c=n.productSysGroupId,l=this.methodObj,u=l.inParamList,d=void 0===u?[]:u,p=l.outParamList,m=void 0===p?[]:p,f=l.errorCodeList,h={productCode:t,id:a,cnName:i,remark:s,inParamList:d,outParamList:m,errorCodeList:void 0===f?[]:f,productSysGroupId:c},e.next=7,Tt.editDoc(h).catch((function(e){var t=e.data.message;throw t&&b.$message.error(t),new Error("editDoc")}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),deleteRow:function(e,t){t.splice(e,1)},insertRow:function(){this.errorCodeForm.tableData.push({errorCode:"",errorMsg:"",objId:this.methodObj.id})},handleSave:function(){var e=this;this.methodObj.errorCodeList=JSON.parse(JSON.stringify(this.errorCodeForm.tableData)),this.methodObj.cnName=this.extensionPointFormData.cnName,this.methodObj.remark=this.extensionPointFormData.remark,this.methodObj.productSysGroupId=this.extensionPointFormData.productSysGroupId;var t=!1;this.$refs.extensionPointForm.validate((function(e){if(!e)return!1;t=!0})),this.$refs.errorCodeFormRef.validate(function(){var r=Object(i.a)(Object(o.a)().mark((function r(a){return Object(o.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!a){r.next=16;break}if(!t){r.next=13;break}return e.saveLoading=!0,r.next=5,e.editDoc().catch((function(){throw e.saveLoading=!1,new Error("handleSave")}));case 5:return e.$message.success("保存成功！"),e.saveLoading=!1,r.next=9,e.reloadDocument();case 9:e.$emit("updateStatus"),e.$emit("update:currentDisplayComponentName","ExtensionPointList"),r.next=14;break;case 13:case 16:return r.abrupt("return",!1);case 14:r.next=17;break;case 17:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())},reloadDocument:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.getDoc().catch((function(){throw new Error("reloadDocument")}));case 3:t=e.sent,r=t.data.data,this.oldMethodObj={},this.methodObj=r,this.methodObj.inParamList&&this.methodObj.inParamList.length>0&&this.setSelectVal(this.methodObj.inParamList),this.methodObj.outParamList&&this.methodObj.inParamList.length>0&&this.setSelectVal(this.methodObj.outParamList),this.oldMethodObj=this.copyDeep(this.methodObj),this.extensionPointFormData.cnName=this.methodObj.cnName,this.extensionPointFormData.remark=this.methodObj.remark,this.extensionPointFormData.productSysGroupId=this.methodObj.productSysGroupId,this.initErrorCodeData(),this.loading=!1;case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),initErrorCodeData:function(){this.errorCodeForm.oldTableData=[],this.methodObj.errorCodeList?(this.errorCodeForm.tableData=this.methodObj.errorCodeList,this.errorCodeForm.oldTableData=this.copyDeep(this.errorCodeForm.tableData)):this.errorCodeForm.tableData=[]},copyDeep:function(e){return JSON.parse(JSON.stringify(e))},setSelectVal:function(e){if(e)for(var t in e){var r=e[t];""===r.required&&(r.required=1),r.oldtype=this.setTypeValue(r.type),r.children&&this.setSelectVal(r.children)}},setTypeValueDeep:function(e){if(e)for(var t in e){var r=e[t];r.oldtype=this.setTypeValue(r.type),r.children&&this.setSelectVal(r.children)}},setTypeValue:function(e){if(e){if(""===e)return"";for(var t=e.split("."),r="",a=0;a<t.length;a++){if(a===t.length-1){r+=t[a];break}-1!==t[a].indexOf("<")&&(r+=t[a].substring(0,t[a].indexOf("<")+1)),-1!==t[a].indexOf(",")&&(r+=t[a].substring(0,t[a].indexOf(",")+1)),-1!==t[a].indexOf(">")&&(r+=t[a])}return r}return""},handleSpiClassification:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryTableList();case 2:this.showClassificationDialog=!0;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleSysOptions:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryGroupList();case 2:t=e.sent,this.sysGroupOptions=t.data.data;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),queryTableList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryGroupList();case 2:t=e.sent,(r=t.data.data).forEach((function(e){e.editNameState=!1,e.editCodeState=!1})),this.spiTableData=r;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),queryGroupList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productCode,3,r={productCode:t,type:3},e.next=5,Et.list(r).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("queryGroupList")}));case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},created:function(){this.reloadDocument(),this.handleSysOptions()},destroyed:function(){this.$emit("update:extensionPointId",null)}},ir=or,sr=(r("b0fa"),Object(f.a)(ir,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"edit-extension-point-document"},[r("el-page-header",{attrs:{content:"编辑文档 ( "+e.methodName+" )"},on:{back:function(t){return e.$emit("update:currentDisplayComponentName","ExtensionPointList")}}}),r("div",{directives:[{name:"loading",rawName:"v-loading.lock",value:e.loading,expression:"loading",modifiers:{lock:!0}}],staticClass:"extension-point-document"},[r("el-form",{ref:"extensionPointForm",staticClass:"extension-point-form",attrs:{model:e.extensionPointFormData,rules:e.extensionPointFormRules,"label-position":"left"}},[r("el-form-item",{attrs:{label:"中文名称",prop:"cnName","label-width":"110px"}},[r("el-input",{staticStyle:{width:"360px"},attrs:{"show-word-limit":!0,maxlength:"20"},model:{value:e.extensionPointFormData.cnName,callback:function(t){e.$set(e.extensionPointFormData,"cnName","string"==typeof t?t.trim():t)},expression:"extensionPointFormData.cnName"}})],1),r("el-form-item",{attrs:{prop:"cnName","label-width":"110px"}},[r("span",{attrs:{slot:"label"},slot:"label"},[e._v(" 所属分类 "),r("el-tooltip",{attrs:{content:"创建扩展点分类，便于使用方在扩展点文档中根据分类快速找到目标扩展点。",placement:"top"}},[r("i",{staticClass:"el-icon-help",staticStyle:{color:"#3c6ef0"}})])],1),r("el-select",{staticStyle:{width:"360px"},on:{focus:e.handleSysOptions},model:{value:e.extensionPointFormData.productSysGroupId,callback:function(t){e.$set(e.extensionPointFormData,"productSysGroupId",t)},expression:"extensionPointFormData.productSysGroupId"}},e._l(e.sysGroupOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.cnName,value:e.id}})})),1),r("el-button",{staticClass:"classification-button",attrs:{type:"text"},on:{click:e.handleSpiClassification}},[e._v("管理分类")])],1),r("el-form-item",{attrs:{label:" ",prop:"remark"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{"show-word-limit":!0,rows:4,resize:"none",type:"textarea",maxlength:"255"},model:{value:e.extensionPointFormData.remark,callback:function(t){e.$set(e.extensionPointFormData,"remark",t)},expression:"extensionPointFormData.remark"}})],1)],1),r("h4",{staticClass:"document-sub-title"},[e._v("请求参数")]),r("ApiTable",{attrs:{tableData:null===e.methodObj.inParamList?new Array:e.methodObj.inParamList,tableColumnInfo:e.columnsInParams,editer:!e.editable,hideEmptyImg:!0}}),r("h4",{staticClass:"document-sub-title"},[e._v("响应参数")]),r("ApiTable",{attrs:{tableData:null==e.methodObj.outParamList?new Array:e.methodObj.outParamList,tableColumnInfo:e.columnsOutParams,editer:!e.editable,hideEmptyImg:!0}}),r("h4",{staticClass:"document-sub-title"},[e._v("错误码")]),r("el-form",{ref:"errorCodeFormRef",attrs:{model:e.errorCodeForm,rules:e.errorCodeFormRules}},[r("ApiTable",{attrs:{tableData:e.errorCodeForm.tableData,tableColumnInfo:e.columnsErrorCode,editer:!e.editable,showOperation:!0,hideEmptyImg:!0},scopedSlots:e._u([{key:"customColumn",fn:function(){return[r("el-table-column",{staticStyle:{margin:"0px",padding:"0px"},attrs:{prop:"errorCode",label:"错误码","min-width":"35%","show-tooltip-when-overflow":!e.editable},scopedSlots:e._u([{key:"default",fn:function(t){return[e.editable?r("el-form-item",{attrs:{prop:"tableData."+t.$index+".errorCode",rules:e.errorCodeFormRules.errorCode}},[e.editable?r("el-input",{attrs:{maxlength:"200",placeholder:"错误码"},model:{value:t.row.errorCode,callback:function(r){e.$set(t.row,"errorCode","string"==typeof r?r.trim():r)},expression:"scope.row.errorCode"}}):e._e()],1):r("span",[e._v(e._s(t.row.errorCode))])]}}])}),r("el-table-column",{staticStyle:{margin:"0px",padding:"0px"},attrs:{prop:"errorMsg",label:"错误消息","min-width":"60%","show-tooltip-when-overflow":!e.editable},scopedSlots:e._u([{key:"default",fn:function(t){return[e.editable?r("el-form-item",{attrs:{prop:"tableData."+t.$index+".errorMsg",rules:e.errorCodeFormRules.errorMsg}},[e.editable?r("el-input",{attrs:{maxlength:"255",type:"text",placeholder:"错误消息，长度在 2 到 255 个字符"},model:{value:t.row.errorMsg,callback:function(r){e.$set(t.row,"errorMsg","string"==typeof r?r.trim():r)},expression:"scope.row.errorMsg"}}):e._e()],1):r("span",[e._v(e._s(t.row.errorMsg))])]}}])}),e.editable?r("el-table-column",{attrs:{"min-width":"6%"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-form-item",[r("a",{staticClass:"link2",attrs:{href:"javascript:;"},on:{click:function(r){return e.deleteRow(t.$index,e.errorCodeForm.tableData)}}},[r("i",{staticClass:"el-icon-delete"})])])]}}],null,!1,1528131726)}):e._e()]},proxy:!0}])})],1),e.editable?r("el-row",{staticClass:"add-row"},[r("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.insertRow()}}},[r("i",{staticClass:"el-icon-plus"}),r("span",{staticStyle:{color:"#3c6ef0"}},[e._v("添加")])])]):e._e(),r("StickyWrapper",[r("div",{staticClass:"button-wrapper"},[r("el-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:e.handleSave}},[e._v("保存")])],1)]),r("ClassificationDialog",{attrs:{showClassificationDialog:e.showClassificationDialog,tableData:e.spiTableData,productCode:e.productCode,queryTableList:e.queryTableList},on:{"update:showClassificationDialog":function(t){e.showClassificationDialog=t},"update:show-classification-dialog":function(t){e.showClassificationDialog=t},"update:tableData":function(t){e.spiTableData=t},"update:table-data":function(t){e.spiTableData=t},"update:productCode":function(t){e.productCode=t},"update:product-code":function(t){e.productCode=t}}})],1)],1)}),[],!1,null,"1bdfd1f3",null)),cr=sr.exports,lr={name:"OpenExtensionPoint",components:{TagTip:pe.default,RegisterExtensionPoint:Wt,ExtensionPointList:er,EditExtensionPointDocument:cr},props:{productCode:{type:String,required:!0}},data:function(){return{currentDisplayComponentName:"ExtensionPointList",type:3,extensionPointId:null,methodName:""}},computed:{computeHref:function(){var e=this.$store.state.tools.dictionary;try{return e.docLink.spiIntro.value}catch(e){return""}}},methods:{groupList:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a,n=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.productCode,r=this.type,a={productCode:t,type:r},e.next=4,Et.list(a).catch((function(e){var t=e.data.message;throw t&&n.$message.error(t),new Error("groupList")}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},ur=lr,dr=(r("dbd4"),Object(f.a)(ur,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"open-extension-point"},["EditExtensionPointDocument"!==e.currentDisplayComponentName?r("TagTip",{staticClass:"tag-tip",attrs:{closable:!1}},[e._v(" 了解更多请查看 "),r("a",{staticClass:"anchor initColor",attrs:{href:e.computeHref,target:"_blank"}},[e._v("扩展点介绍")])]):e._e(),"RegisterExtensionPoint"===e.currentDisplayComponentName?r("RegisterExtensionPoint",{attrs:{currentDisplayComponentName:e.currentDisplayComponentName,productCode:e.productCode,type:e.type,groupList:e.groupList},on:{"update:currentDisplayComponentName":function(t){e.currentDisplayComponentName=t},"update:current-display-component-name":function(t){e.currentDisplayComponentName=t},updateStatus:function(t){return e.$emit("updateStatus")}}}):"EditExtensionPointDocument"===e.currentDisplayComponentName&&e.extensionPointId?r("EditExtensionPointDocument",{attrs:{currentDisplayComponentName:e.currentDisplayComponentName,productCode:e.productCode,extensionPointId:e.extensionPointId,methodName:e.methodName},on:{"update:currentDisplayComponentName":function(t){e.currentDisplayComponentName=t},"update:current-display-component-name":function(t){e.currentDisplayComponentName=t},"update:extensionPointId":function(t){e.extensionPointId=t},"update:extension-point-id":function(t){e.extensionPointId=t},"update:methodName":function(t){e.methodName=t},"update:method-name":function(t){e.methodName=t},updateStatus:function(t){return e.$emit("updateStatus")}}}):"ExtensionPointList"===e.currentDisplayComponentName?r("ExtensionPointList",{attrs:{currentDisplayComponentName:e.currentDisplayComponentName,productCode:e.productCode,extensionPointId:e.extensionPointId,methodName:e.methodName},on:{"update:currentDisplayComponentName":function(t){e.currentDisplayComponentName=t},"update:current-display-component-name":function(t){e.currentDisplayComponentName=t},"update:extensionPointId":function(t){e.extensionPointId=t},"update:extension-point-id":function(t){e.extensionPointId=t},"update:methodName":function(t){e.methodName=t},"update:method-name":function(t){e.methodName=t},updateStatus:function(t){return e.$emit("updateStatus")}}}):e._e()],1)}),[],!1,null,"d0e1a384",null)),pr={name:"DeveloperResource",components:{OpenInterface:At,OpenExtensionPoint:dr.exports},props:{productCode:{type:String,required:!0}},data:function(){return{radioValue:"开放接口"}}},mr=(r("9299"),Object(f.a)(pr,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"developer-resource"},[r("el-radio-group",{staticClass:"developer-resource__radio-group",model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[r("el-radio-button",{attrs:{label:"开放接口"}}),r("el-radio-button",{attrs:{label:"开放扩展点"}})],1),"开放接口"===e.radioValue?r("OpenInterface",{attrs:{productCode:e.productCode},on:{updateStatus:function(t){return e.$emit("updateStatus")}}}):"开放扩展点"===e.radioValue?r("OpenExtensionPoint",{attrs:{productCode:e.productCode},on:{updateStatus:function(t){return e.$emit("updateStatus")}}}):e._e()],1)}),[],!1,null,"972510cc",null)),fr={name:"SoftwareSystemDetail",components:{Overview:ae,SoftwareSystemManual:de,SoftwareSystemSubscribe:P,SystemResource:Fe,ProductVersion:St,DeveloperResource:mr.exports},data:function(){return{tabName:"overview",id:this.$route.params.id,name:"",createUser:"",createTime:"",updateTime:"",status:"",firstRadio:"产品基本信息",productCode:"",productInfo:{}}},computed:{computeProductStatusClassName:function(){return{0:"com-tag initBtnColor",1:"com-tag normalBtnColor",2:"com-tag updateBtnColor"}[this.status]||""},computeProductStatusText:function(){var e=this.status,t=this.$store.state.tools.dictionary;try{return t.productStatus[e].value}catch(t){return e||""}},computePublishButtonVisible:function(){var e=this.status;return[0,2].includes(e)}},methods:{dry:function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,r,a=this;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.id,r={id:t},e.next=4,T.a.dry(r).catch((function(e){var t=e.data.message;throw t&&a.$message.error(t),new Error("dry")}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handlePublishButton:function(){var e=this,t=this.id;return"overview"===this.tabName&&this.$refs.overview.editable?this.$message.warning("发布失败，请保存当前概览信息。"):this.dry().then((function(){return e.$router.push({name:"SoftwareSystemDetailPublish",params:{id:t}})})).catch((function(){throw new Error("handlePublishButton")}))},fetchProductSummary:function(e){var t=this;Object(c.a)({url:"/product",method:"get",params:{id:e}}).then((function(e){t.productCode=e.data.code,t.updateTitle(e.data)})).catch((function(e){}))},updateTitle:function(e){this.productInfo=e,this.id=e.id,this.name=e.name,this.createUser=e.createUser,this.createTime=Object(l.c)(e.createTime,"{y}-{m}-{d} {h}:{i}"),this.updateTime=Object(l.c)(e.updateTime,"{y}-{m}-{d} {h}:{i}"),this.status=e.status},changeTab:function(e,t){if("overview"===t&&this.$refs.overview.editable)return this.$message.warning("切换操作失败，请保存当前概览信息。"),!1;this.tabName=e;var r=this.tabName;this.$router.push({query:{tabName:r}})}},created:function(){this.tabName=this.$route.query.tabName||"overview",this.fetchProductSummary(this.id)}},hr=fr,br=(r("37c8"),Object(f.a)(hr,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"software-system-detail"},[r("div",{staticClass:"com-view-dep com-tit-view",staticStyle:{margin:"auto","margin-bottom":"20px"}},[r("div",{staticClass:"tit-wrap"},[r("div",[r("h2",{staticClass:"tit"},[e._v(" "+e._s(e.name)+" ")]),r("div",{class:e.computeProductStatusClassName},[e._v(" "+e._s(e.computeProductStatusText)+" ")])]),r("p",{staticClass:"tip"},[e._v(e._s(e.createUser)+" 创建于 "+e._s(e.createTime))])]),r("div",{staticClass:"btn-wrap"},[r("el-tooltip",{attrs:{placement:"top"}},[r("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 如果控制台中的软件系统概述信息或使用手册有变更，则需发布到前台，才会实际生效。 ")]),e.computePublishButtonVisible?r("el-button",{attrs:{type:"primary"},on:{click:e.handlePublishButton}},[e._v("发 布")]):e._e()],1)],1)]),r("el-tabs",{attrs:{type:"card","before-leave":e.changeTab},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[r("el-tab-pane",{attrs:{label:"概览",name:"overview"}},["overview"===e.tabName?r("Overview",{ref:"overview",attrs:{productCode:e.productCode},on:{updateTitle:e.updateTitle,updateStatus:function(t){return e.fetchProductSummary(e.id)}}}):e._e()],1),r("el-tab-pane",{attrs:{label:"使用手册",name:"manual"}},["manual"===e.tabName?r("SoftwareSystemManual",{ref:"manual"}):e._e()],1),r("el-tab-pane",{attrs:{label:"系统资源",name:"systemResource"}},["systemResource"===e.tabName?r("SystemResource"):e._e()],1),r("el-tab-pane",{attrs:{label:"产品版本",name:"productVersion"}},["productVersion"===e.tabName?r("ProductVersion",{ref:"productVersion",attrs:{productInfo:e.productInfo},on:{"update:productInfo":function(t){e.productInfo=t},"update:product-info":function(t){e.productInfo=t},updateStatus:function(t){return e.fetchProductSummary(e.id)}}}):e._e()],1),r("el-tab-pane",{attrs:{label:"开发者资源",name:"developerResource"}},["developerResource"===e.tabName&&e.productCode?r("DeveloperResource",{ref:"developerResource",attrs:{productCode:e.productCode},on:{updateStatus:function(t){return e.fetchProductSummary(e.id)}}}):e._e()],1),r("el-tab-pane",{attrs:{label:"订阅",name:"subscribe"}},["subscribe"===e.tabName?r("SoftwareSystemSubscribe",{ref:"subscribe"}):e._e()],1)],1)],1)}),[],!1,null,"d4e57332",null));t.default=br.exports},"0d19":function(e,t,r){"use strict";r("ddde")},"155c":function(e,t,r){"use strict";r("d1d0")},"16d8":function(e,t,r){"use strict";var a=(r("7f7f"),r("c5f6"),r("2a53")),n={name:"MarkdownEditor",props:{value:{type:String,default:""},height:{type:Number,default:400},placeholder:{type:String,default:""}},data:function(){return{contentEditor:""}},mounted:function(){var e=this,t=this;this.contentEditor=new Vditor("vditor",{mode:"wysiwyg",height:this.height,placeholder:this.placeholder,toolbarConfig:{pin:!0},cdn:"/vditor",cache:{enable:!1},fullscreen:{index:1e4},after:function(){e.contentEditor.setValue(e.value)},upload:{accept:"image/*,.mp3, .wav, .rar",headers:{"Account-Type":Object(a.a)()?"erp":"passport"},url:"/lcp-rest/api/imageUpload",fieldName:"imageFile",format:function(e,r){var a=JSON.parse(r),n=a.code,o=a.message,i=e[0].name;if(2e4===n){var s=a.data,c={};return c[i]=s,JSON.stringify({msg:o,code:n,data:{errFiles:[],succMap:c}})}t.$message.error("图片上传失败！")}}})},methods:{getValue:function(){return this.contentEditor.getValue()},setValue:function(e){return this.contentEditor.setValue(e)}}},o=n,i=(r("155c"),r("2877")),s=Object(i.a)(o,(function(){var e=this.$createElement;return(this._self._c||e)("div",{attrs:{id:"vditor"}})}),[],!1,null,"31aae780",null);t.a=s.exports},1799:function(e,t,r){"use strict";var a=(r("c5f6"),{name:"Pagination",props:{currentPage:{type:Number,required:!0},pageSize:{type:Number,required:!0},total:{type:Number,default:0},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},reloadTableData:{type:Function,default:function(){}}},methods:{onCurrentChange:function(e){this.$emit("update:currentPage",e),this.reloadTableData()},onSizeChange:function(e){this.$emit("update:pageSize",e),this.reloadTableData()}}}),n=a,o=(r("3fca"),r("2877")),i=Object(o.a)(n,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("el-pagination",{staticClass:"pagination",attrs:{background:!0,"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":e.pageSizes,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.onCurrentChange,"size-change":e.onSizeChange}})}),[],!1,null,"52f386a2",null);t.a=i.exports},"197d":function(e,t,r){"use strict";r("781b")},"19a6":function(e,t,r){"use strict";r("a30f")},"1a71":function(e,t,r){"use strict";t.a={normal:/^[a-zA-Z0-9_\-.#\u4e00-\u9fa5]+$/,email:/^[a-zA-Z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,chinese:/^[\u4e00-\u9fa5]*$/,english:/^[a-zA-Z]*$/,url:/^(http|https)?(:\/\/)?[-A-Za-z0-9+&@#\/%?=~_|!:,.;]+[-A-Za-z0-9+&@#\/%=~_|]$/,engNumUnder:/^[a-zA-Z0-9_]*$/,mobile:/^1[3456789]{1}[0-9]{9}$/,zhEngNumUnder:/^[\u4E00-\u9FA5\uF900-\uFA2D0-9a-zA-Z_]+$/,enumValue:/^([\u4E00-\u9FA5\uF900-\uFA2D0-9a-zA-Z_]+\:[\u4E00-\u9FA5\uF900-\uFA2D0-9a-zA-Z_]+)(,[\u4E00-\u9FA5\uF900-\uFA2D0-9a-zA-Z_]+\:[\u4E00-\u9FA5\uF900-\uFA2D0-9a-zA-Z_]+)*$/,number:/^\d+.?\d{0,2}$/}},"1d09":function(e,t,r){"use strict";r("c0f9")},"1e2e":function(e,t,r){},"1edf":function(e,t,r){"use strict";r("b60f")},"24ba":function(e,t,r){"use strict";r("3bf0")},"24ec":function(e,t,r){e.exports=r.p+"img/noData.aadb7b7d.png"},"2ce8":function(e,t,r){"use strict";r("5068")},"2d17":function(e,t,r){},"2d60":function(e,t,r){},"333d":function(e,t,r){"use strict";r("c5f6"),Math.easeInOutQuad=function(e,t,r,a){return(e/=a/2)<1?r/2*e*e+t:-r/2*(--e*(e-2)-1)+t};var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};function n(e,t,r){var n=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,o=e-n,i=0;t=void 0===t?500:t;!function e(){i+=20,function(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}(Math.easeInOutQuad(i,n,o,t)),i<t?a(e):r&&"function"==typeof r&&r()}()}var o={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&n(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&n(0,800)}}},i=o,s=(r("8d79"),r("2877")),c=Object(s.a)(i,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[r("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)}),[],!1,null,"0a87263c",null);t.a=c.exports},"333e":function(e,t,r){"use strict";r("6134")},"37c8":function(e,t,r){"use strict";r("deda")},"386d":function(e,t,r){"use strict";var a=r("cb7c"),n=r("83a1"),o=r("5f1b");r("214f")("search",1,(function(e,t,r,i){return[function(r){var a=e(this),n=null==r?void 0:r[t];return void 0!==n?n.call(r,a):new RegExp(r)[t](String(a))},function(e){var t=i(r,e,this);if(t.done)return t.value;var s=a(e),c=String(this),l=s.lastIndex;n(l,0)||(s.lastIndex=0);var u=o(s,c);return n(s.lastIndex,l)||(s.lastIndex=l),null===u?-1:u.index}]}))},3978:function(e,t,r){},"3b77":function(e,t,r){"use strict";r("c6d9")},"3bd8":function(e,t,r){"use strict";r("51c00")},"3bf0":function(e,t,r){},"3c94":function(e,t,r){"use strict";r.r(t);var a={name:"TagTip",props:{text:{type:String,default:""},closable:{type:Boolean,default:!0}},data:function(){return{tagList:["tag"]}},methods:{handleCloseTag:function(e){this.tagList.splice(this.tagList.indexOf(e),1)}}},n=a,o=(r("1d09"),r("2877")),i=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tagTip"},e._l(e.tagList,(function(t,a){return r("el-tag",{key:a,staticClass:"tagTip__tag",attrs:{closable:e.closable,"disable-transitions":!0,type:"info"},on:{close:function(r){return e.handleCloseTag(t)}}},[r("p",{staticClass:"tagTip__content"},[r("i",{staticClass:"el-icon-info"}),e._v(" "),e._t("default",[e._v(e._s(e.text))])],2)])})),1)}),[],!1,null,"0c343daa",null);t.default=i.exports},"3d85":function(e,t,r){"use strict";var a=(r("c5f6"),{name:"Steps",props:{titleList:{type:Array,default:function(){return[]}},active:{type:Number,required:!0}}}),n=(r("e75f"),r("2877")),o=Object(n.a)(a,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-steps",{staticClass:"steps",attrs:{active:e.active,"align-center":!0,"finish-status":"success"}},e._l(e.titleList,(function(e,t){return r("el-step",{key:t,attrs:{title:e}})})),1)}),[],!1,null,"443b202a",null);t.a=o.exports},"3df2":function(e,t,r){"use strict";r("3978")},"3fca":function(e,t,r){"use strict";r("848d")},4496:function(e,t,r){},"44f5":function(e,t,r){"use strict";r("c152")},"4cba":function(e,t,r){"use strict";r("9462")},"504c":function(e,t,r){var a=r("9e1e"),n=r("0d58"),o=r("6821"),i=r("52a7").f;e.exports=function(e){return function(t){for(var r,s=o(t),c=n(s),l=c.length,u=0,d=[];l>u;)r=c[u++],a&&!i.call(s,r)||d.push(e?[r,s[r]]:s[r]);return d}}},5068:function(e,t,r){},"51c00":function(e,t,r){},6134:function(e,t,r){},"63c9":function(e,t,r){},"64a7":function(e,t,r){"use strict";r("7de1f")},"6ea4":function(e,t,r){"use strict";var a=(r("c5f6"),{name:"steps",props:{active:{required:!0,type:Number},title:{required:!1,type:String},tiptitle:{required:!0,type:Array}}}),n=(r("e7be"),r("2877")),o=Object(n.a)(a,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.title?r("h2",{staticClass:"com-tit-mini"},[e._v(e._s(e.title))]):e._e(),r("div",{staticClass:"my-step-bar"},[r("el-steps",{staticClass:"my-steps",attrs:{active:e.active,"finish-status":"success","align-center":""}},e._l(e.tiptitle,(function(e,t){return r("el-step",{key:t,attrs:{title:e}})})),1)],1)])}),[],!1,null,"16bbb482",null);t.a=o.exports},"726a":function(e,t,r){},7469:function(e,t,r){"use strict";r("63c9")},"751f":function(e,t,r){e.exports=r.p+"img/usfSass.1c63abfa.png"},"753e":function(e,t,r){},"781b":function(e,t,r){},78871:function(e,t,r){"use strict";r("cf49")},"78c7":function(e,t,r){"use strict";r("e15c")},"7a12":function(e,t,r){},"7de1f":function(e,t,r){},"81db":function(e,t,r){},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},"848d":function(e,t,r){},8615:function(e,t,r){var a=r("5ca1"),n=r("504c")(!1);a(a.S,"Object",{values:function(e){return n(e)}})},"889d":function(e,t,r){"use strict";r("ba73")},"8b9c":function(e,t,r){"use strict";r("e316")},"8d37":function(e,t,r){},"8d79":function(e,t,r){"use strict";r("753e")},9299:function(e,t,r){"use strict";r("2d17")},9462:function(e,t,r){},"998e":function(e,t,r){},"9cc8":function(e,t,r){"use strict";r("a3bf")},"9cd8":function(e,t,r){"use strict";r("1e2e")},"9dbb":function(e,t,r){"use strict";r("a451")},"9f9e":function(e,t,r){},a283:function(e,t,r){"use strict";r("7a12")},a30f:function(e,t,r){},a3bf:function(e,t,r){},a451:function(e,t,r){},ac8d:function(e,t,r){"use strict";r("726a")},b0fa:function(e,t,r){"use strict";r("049e")},b60f:function(e,t,r){},b7ee:function(e,t,r){"use strict";r("8d37")},ba73:function(e,t,r){},bc4f:function(e,t,r){"use strict";r("fd41")},c0f9:function(e,t,r){},c152:function(e,t,r){},c6d9:function(e,t,r){},cf49:function(e,t,r){},d1d0:function(e,t,r){},d4bb:function(e,t,r){},d6a5:function(e,t,r){},dbd4:function(e,t,r){"use strict";r("4496")},dd04:function(e,t,r){"use strict";r("fe15")},dd34:function(e,t,r){},ddde:function(e,t,r){},deda:function(e,t,r){},e02a:function(e,t,r){},e15c:function(e,t,r){},e316:function(e,t,r){},e33f:function(e,t,r){"use strict";r("d4bb")},e75f:function(e,t,r){"use strict";r("9f9e")},e7be:function(e,t,r){"use strict";r("d6a5")},e901:function(e,t,r){"use strict";r("2d60")},f3a4:function(e,t,r){"use strict";r("998e")},f4b6:function(e,t,r){"use strict";r("e02a")},f688:function(e,t,r){e.exports=r.p+"img/seatImg.61bf93c9.png"},f797:function(e,t,r){"use strict";r("dd34")},f8f8:function(e,t,r){"use strict";r("81db")},fd41:function(e,t,r){},fe15:function(e,t,r){}}]);