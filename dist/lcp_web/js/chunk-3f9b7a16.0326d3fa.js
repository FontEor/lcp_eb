(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3f9b7a16"],{"0be6":function(e,t,r){},"0e07":function(e,t,r){"use strict";var a=r("7aef"),s=r("7562"),i=(r("b775"),{queryList:function(e){return s.a.post("/ApiManagerService/queryCloudClusterList",[e])},cloudClusterSave:function(e){return s.a.post("/ApiManagerService/saveCloudCluster",[e])},cloudClusterUpdate:function(e){return s.a.post("/ApiManagerService/updateCloudCluster",[e])},findUser:function(e){return a.a.get("/hrInfo/findUser",{params:e})},findSupplierUserByErp:function(e){return a.a.get("/supplier/findSupplierUserByErp",{params:e})},saveBaseInfo:function(e){return s.a.post("/HttpApiService/saveBaseInfo",[e])},queryApiReleaseByCondition:function(e){return s.a.post("/ApiDepotService/queryApiReleaseByCondition",JSON.stringify(e))},queryAliasByInterface:function(e){return s.a.post("/JsfApiMetaService/queryAliasByInterface",JSON.stringify(e))},getMethodList:function(e){return s.a.post("/ApiDepotService/queryApiReleaseByCondition",JSON.stringify(e))},queryMethodByInterface:function(e){return s.a.post("/JsfApiMetaService/queryMethodByInterface",JSON.stringify(e))},getSensitiveLabelForest:function(){return s.a.post("/HttpApiService/querySensitiveLabelForest")}});t.a=i},"0fbd":function(e,t,r){},"10b4f":function(e,t,r){"use strict";r("3e29")},3935:function(e,t,r){"use strict";var a=r("c7eb"),s=(r("96cf"),r("1da1")),i=r("0e07"),n={name:"ErpPrincipal",props:{showPopover:{type:Boolean,default:!1},formDataPrincipal:{type:String,required:!0},placeholder:{type:String,default:"请输入负责人的ERP账号"},disabled:{type:Boolean,default:!1}},data:function(){return{dataPrincipal:"",principalVisible:!1,principalLoading:!1,principalOptionList:[]}},watch:{formDataPrincipal:{handler:function(e){this.dataPrincipal=e},immediate:!0}},methods:{findUser:function(){var e=Object(s.a)(Object(a.a)().mark((function e(t){var r,s=this;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={erp:t},e.next=3,i.a.findUser(r).catch((function(e){var t=e.data.message;throw t&&s.$message.error(t),new Error(t)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),findSupplierUserByErp:function(){var e=Object(s.a)(Object(a.a)().mark((function e(t){var r,s=this;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={erp:t},e.next=3,i.a.findSupplierUserByErp(r).catch((function(e){var t=e.data.message;throw t&&s.$message.error(t),new Error(e)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),changePrincipal:function(){var e=Object(s.a)(Object(a.a)().mark((function e(t){var r,s;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.$emit("update:formDataPrincipal",t),!this.showPopover){e.next=7;break}return e.next=4,this.findSupplierUserByErp(t);case 4:r=e.sent,s=r.data.data,this.principalVisible=!s;case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),remotePrincipal:function(){var e=Object(s.a)(Object(a.a)().mark((function e(t){var r,s;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===t){e.next=10;break}return this.principalLoading=!0,e.next=4,this.findUser(t);case 4:r=e.sent,s=r.data.data,this.principalOptionList=s,this.principalLoading=!1,e.next=11;break;case 10:this.principalOptionList=[];case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}},o=n,c=(r("7780"),r("2877")),p=Object(c.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"erp-principal"},[r("el-popover",{attrs:{placement:"top-start",width:"280","popper-class":"erp-info-popover"},model:{value:e.principalVisible,callback:function(t){e.principalVisible=t},expression:"principalVisible"}},[r("div",{staticClass:"content-wrapper"},[r("i",{staticClass:"el-icon-info"}),r("p",{staticClass:"text"},[e._v(" 【"+e._s(e.formDataPrincipal)+"】不在您的团队下，为了不影响接口审批，建议去【个人中心】将该用户拉入您的团队。 ")])]),r("div",{staticClass:"button-wrapper"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.principalVisible=!1}}},[e._v("我知道了")])],1),r("span",{attrs:{slot:"reference"},slot:"reference"})]),r("el-select",{staticStyle:{width:"100%"},attrs:{loading:e.principalLoading,filterable:!0,remote:!0,"remote-method":e.remotePrincipal,placeholder:e.placeholder,disabled:e.disabled,"value-key":"userName","popper-class":"erp-info-dropdown__list"},on:{change:e.changePrincipal},model:{value:e.dataPrincipal,callback:function(t){e.dataPrincipal=t},expression:"dataPrincipal"}},e._l(e.principalOptionList,(function(t){return r("el-option",{key:t.userName,attrs:{label:t.userName,value:t.userName}},[r("div",{staticClass:"photo-wrapper"},[r("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:t.headImg}})]),r("div",{staticClass:"info-wrapper"},[r("p",{staticClass:"name"},[e._v(e._s(t.userName)+"（"+e._s(t.realName)+"）")]),r("p",{staticClass:"organization"},[e._v(" "+e._s(t.organizationFullName)+" ")])])])})),1)],1)}),[],!1,null,"1a467d82",null);t.a=p.exports},"3e29":function(e,t,r){},"585e":function(e,t,r){"use strict";r("bcf2")},"59a6":function(e,t,r){"use strict";r("0fbd")},"69c8":function(e,t,r){"use strict";r("e173")},"6ea4":function(e,t,r){"use strict";var a=(r("c5f6"),{name:"steps",props:{active:{required:!0,type:Number},title:{required:!1,type:String},tiptitle:{required:!0,type:Array}}}),s=(r("e7be"),r("2877")),i=Object(s.a)(a,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.title?r("h2",{staticClass:"com-tit-mini"},[e._v(e._s(e.title))]):e._e(),r("div",{staticClass:"my-step-bar"},[r("el-steps",{staticClass:"my-steps",attrs:{active:e.active,"finish-status":"success","align-center":""}},e._l(e.tiptitle,(function(e,t){return r("el-step",{key:t,attrs:{title:e}})})),1)],1)])}),[],!1,null,"16bbb482",null);t.a=i.exports},7562:function(e,t,r){"use strict";var a=r("c7eb"),s=(r("96cf"),r("1da1")),i=r("bc3a"),n=r.n(i),o=r("7a3a"),c=r("3cfb"),p=r("c24f"),u=r("2a53"),l=r("a78e"),m=r.n(l),f=!1,d=n.a.create({baseURL:window.env.gatewayApiDecoupling,withCredentials:!0,timeout:1e4,headers:{"LOP-DN":window.env.gatewayApiDecouplingLop,"Account-Type":Object(u.a)()?"erp":"passport","X-Requested-With":"XMLHttpRequest"}});function v(){return b.apply(this,arguments)}function b(){return b=Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.a.dispatch("user/resetUser"),sessionStorage.setItem("store",JSON.stringify(c.a.state)),o.MessageBox.confirm("您的登录状态已失效，是否重新登录？","提示",{confirmButtonText:"登录",cancelButtonText:"不登录",type:"warning"}).then(Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=!1,e.next=3,Object(p.a)();case 3:if(!u.a){e.next=8;break}return e.next=6,c.a.dispatch("user/handleIntranetGetUserInfo");case 6:e.next=9;break;case 8:window.location.reload();case 9:case"end":return e.stop()}}),e)})))).catch((function(){f=!1}));case 3:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}d.interceptors.request.use((function(e){return e.headers.groupCode=m.a.get("groupCode")||"",e}),(function(e){return Promise.reject(e)})),d.interceptors.response.use((function(e){var t=e.status;if(e.data.error_response)return o.Message.error("服务异常"),Promise.reject(e);if(401===t||520===t)return f||(f=!0,v()),Promise.reject(e);if(e.data.response){var r=e.data.response,a=r.code,s=r.message;return 2e4===a?e.data.response:(10003===a||s&&o.Message.error(s),Promise.reject(e.data.response))}return Promise.reject(e)}),(function(e){var t=e.response.status;return e.response.data.error_response&&o.Message.error("服务异常"),401!==t&&520!==t||f||(f=!0,v()),Promise.reject(e.response)})),t.a=d},7780:function(e,t,r){"use strict";r("0be6")},"8b9d":function(e,t,r){"use strict";r.r(t);var a=(r("7f7f"),r("c7eb")),s=(r("96cf"),r("1da1")),i=r("6ea4"),n={props:{groupMessageForm:Object},data:function(){return{groupMessageRules:{cnName:[{required:!0,message:"请输入中文名称"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9]*$/,message:"请输入中文、英文字母或数字"},{min:2,max:20,message:"请输入2到20个字符"}],intr:[{required:!0,message:"请输入描述"}]}}},methods:{nextStep:function(){var e=this;this.$refs.groupMessageForm.validate((function(t){if(!t)return!1;e.$emit("nextStep")}))},backApiGroupDetail:function(){this.$router.push({name:"ApiManagerMobileApiGroupDetail",params:{id:this.$route.params.id}})}}},o=n,c=(r("10b4f"),r("2877")),p=Object(c.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"fill-group-message"},[r("div",{staticClass:"form-content"},[r("el-form",{ref:"groupMessageForm",attrs:{rules:e.groupMessageRules,model:e.groupMessageForm,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"英文名称"}},[r("span",[e._v(e._s(e.groupMessageForm.code))])]),r("el-form-item",{attrs:{label:"中文名称",prop:"cnName"}},[r("el-input",{attrs:{placeholder:"请输入中文名称"},model:{value:e.groupMessageForm.cnName,callback:function(t){e.$set(e.groupMessageForm,"cnName",t)},expression:"groupMessageForm.cnName"}})],1),r("el-form-item",{attrs:{label:"描述",prop:"intr"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"描述"},model:{value:e.groupMessageForm.intr,callback:function(t){e.$set(e.groupMessageForm,"intr",t)},expression:"groupMessageForm.intr"}})],1)],1)],1),r("div",{staticClass:"footer"},[r("el-button",{on:{click:function(t){return e.backApiGroupDetail()}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.nextStep()}}},[e._v("下一步")])],1)])}),[],!1,null,"3845f4b3",null),u=p.exports,l=r("3935"),m=r("7562"),f={props:{groupMessageForm:Object,callVolumeForm:Object},components:{ErpPrincipal:l.a},data:function(){return{fullscreenLoading:!1,approverForm:{approver:""},approverRules:{approver:[{required:!0,message:"审批人ERP账号不能为空"}]}}},methods:{submitForm:function(){var e=this;this.$refs.approverForm.validate((function(t){if(!t)return!1;e.cloudDomainServicePublish()}))},previous:function(){this.$emit("previous")},cloudDomainServicePublish:function(){var e=Object(s.a)(Object(a.a)().mark((function e(){var t,r=this;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"/CloudDomainService/publish",t=[{id:this.groupMessageForm.id,code:this.groupMessageForm.code,name:this.groupMessageForm.cnName,description:this.groupMessageForm.intr,approveErp:this.approverForm.approver,tps:this.callVolumeForm.tps,dailyCall:this.callVolumeForm.dailyCall}],m.a.post("/CloudDomainService/publish",t).then((function(e){2e4===e.code&&r.$emit("nextStep")})).catch((function(e){r.loading=!1}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},d=f,v=(r("d75a"),Object(c.a)(d,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"fill-approver"},[r("p",{staticClass:"title"},[e._v("请填写指定的审批人ERP账号")]),r("p",{staticClass:"title"},[e._v("审批通过后，发布内容生效")]),r("div",{staticClass:"form-content"},[r("el-form",{ref:"approverForm",attrs:{rules:e.approverRules,model:e.approverForm,"label-width":"126px"}},[r("el-form-item",{attrs:{label:"审批人ERP账号",prop:"approver"}},[r("ErpPrincipal",{attrs:{formDataPrincipal:e.approverForm.approver,placeholder:"审批人可在京ME流程中心审批"},on:{"update:formDataPrincipal":function(t){return e.$set(e.approverForm,"approver",t)},"update:form-data-principal":function(t){return e.$set(e.approverForm,"approver",t)}}})],1)],1)],1),r("div",{staticClass:"footer"},[r("el-button",{on:{click:e.previous}},[e._v("上一步")]),r("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("发布")])],1)])}),[],!1,null,"0491b322",null)),b=v.exports,h={methods:{gotoGroupList:function(){this.$router.push({name:"ApiManagerMobileApiGroup"})},backGroupDetail:function(){this.$router.push({name:"ApiManagerMobileApiGroupDetail",params:{id:this.$route.params.id}})}}},g=(r("69c8"),Object(c.a)(h,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"publish-success"},[e._m(0),r("p",{staticClass:"success-title"},[e._v("提交成功")]),r("p",{staticClass:"success-tip"},[e._v("提醒审批人尽快审批吧，审批通过后发布内容生效")]),r("div",{staticClass:"footer",staticStyle:{"text-align":"center"}},[r("el-button",{on:{click:e.gotoGroupList}},[e._v("返回分组列表")]),r("el-button",{attrs:{type:"primary"},on:{click:e.backGroupDetail}},[e._v("继续管理分组")])],1)])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"submit-success"},[t("i",{staticClass:"el-icon-success"})])}],!1,null,"a021988a",null)),y=g.exports,x={name:"GroupAdjustment",props:{callVolumeForm:{type:Object,default:!0}},data:function(){return{callVolumeRules:{tps:[{required:!0,message:"每秒调用量峰值不能为空"},{type:"number",min:0,max:1e10,message:"每秒调用量峰值为数字且长度为1-10"}],dailyCall:[{required:!0,message:"每日调用量峰值不能为空"},{type:"number",min:0,max:1e10,message:"每日调用量峰值为数字且长度为1-10"}]}}},methods:{nextStep:function(){var e=this;this.$refs.callVolumeForm.validate((function(t){if(!t)return!1;e.$emit("nextStep")}))},previous:function(){this.$emit("previous")}}},j=x,F=(r("585e"),Object(c.a)(j,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"group-adjustment"},[e._m(0),r("el-form",{ref:"callVolumeForm",attrs:{model:e.callVolumeForm,rules:e.callVolumeRules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"每秒调用量峰值",prop:"tps"}},[r("el-input",{attrs:{placeholder:"请输入API分组的每秒调用量峰值"},model:{value:e.callVolumeForm.tps,callback:function(t){e.$set(e.callVolumeForm,"tps",e._n(t))},expression:"callVolumeForm.tps"}})],1),r("el-form-item",{attrs:{label:"每日调用量峰值",prop:"dailyCall"}},[r("el-input",{attrs:{placeholder:"请输入API分组的每日调用量峰值"},model:{value:e.callVolumeForm.dailyCall,callback:function(t){e.$set(e.callVolumeForm,"dailyCall",e._n(t))},expression:"callVolumeForm.dailyCall"}})],1)],1),r("div",{staticClass:"group-adjustment-btn"},[r("el-button",{on:{click:function(t){return e.previous()}}},[e._v("上一步")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.nextStep()}}},[e._v("下一步")])],1)],1)}),[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"group-adjustment-desc"},[r("p",{staticClass:"desc-content"},[e._v("请填写分组的每秒/日调用量峰值")]),r("p",{staticClass:"desc-content"},[e._v("物流开放平台会参考调用量峰值，判断是否需要扩容")])])}],!1,null,"5f286e7b",null)),C=F.exports,O={components:{steps:i.a,FillGroupMessage:u,FillApprover:b,PublishSuccess:y,GroupAdjustment:C},name:"publish",data:function(){return{loading:!0,stepsObj:{active:0,title:"发布分组",tiptitle:["确认分组信息","填写分组调用量","填写审批人ERP账号","提交发布请求成功"]},groupMessageForm:{id:this.$route.params.id,code:"",cnName:"",intr:""},callVolumeForm:{tps:"",dailyCall:""}}},created:function(){var e=Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.publishMessage();case 2:e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),methods:{nextStep:function(){this.stepsObj.active<3&&this.stepsObj.active++},previous:function(){this.stepsObj.active>0&&this.stepsObj.active--},publishMessage:function(){var e=Object(s.a)(Object(a.a)().mark((function e(){var t,r=this;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"/CloudDomainService/info",t=[{id:this.$route.params.id}],m.a.post("/CloudDomainService/info",t).then((function(e){r.groupMessageForm.id=e.data.id,r.groupMessageForm.code=e.data.code,r.groupMessageForm.cnName=e.data.name,r.groupMessageForm.intr=e.data.description,r.callVolumeForm.dailyCall=e.data.dailyCall,r.callVolumeForm.tps=e.data.tps,r.loading=!1})).catch((function(e){r.loading=!1}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},_=O,w=(r("59a6"),Object(c.a)(_,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("steps",e._b({},"steps",e.stepsObj,!1)),r("div",{staticClass:"form-container"},[0===e.stepsObj.active?r("div",[r("FillGroupMessage",{attrs:{groupMessageForm:e.groupMessageForm},on:{nextStep:e.nextStep}})],1):1===e.stepsObj.active?r("div",[r("GroupAdjustment",{attrs:{callVolumeForm:e.callVolumeForm},on:{nextStep:e.nextStep,previous:e.previous}})],1):2===e.stepsObj.active?r("div",[r("FillApprover",{attrs:{groupMessageForm:e.groupMessageForm,callVolumeForm:e.callVolumeForm},on:{nextStep:e.nextStep,previous:e.previous}})],1):3===e.stepsObj.active?r("div",[r("PublishSuccess")],1):e._e()])],1)}),[],!1,null,"15c24640",null));t.default=w.exports},bcf2:function(e,t,r){},bcfd:function(e,t,r){},d6a5:function(e,t,r){},d75a:function(e,t,r){"use strict";r("bcfd")},e173:function(e,t,r){},e7be:function(e,t,r){"use strict";r("d6a5")}}]);