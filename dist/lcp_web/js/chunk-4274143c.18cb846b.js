(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4274143c"],{"00d5":function(e,t,a){"use strict";a("f30d")},"07d5":function(e,t,a){},"0be6":function(e,t,a){},"0bee":function(e,t,a){"use strict";var i=a("c7eb"),r=(a("7f7f"),a("96cf"),a("1da1")),s=(a("3b2b"),a("ac6a"),a("456d"),a("0e07")),n={name:"CreateClusterDialog",props:{createClusterDialogVisible:{type:Boolean,required:!0}},data:function(){var e=this;return{active:0,stepList:[{title:"填写基本信息"},{title:"添加IP端口"},{title:"设置超时时间"},{title:"创建成功"}],clusterBasicInfoData:{name:"",useType:null,type:null,desc:""},clusterBasicInfoRules:{name:[{required:!0,message:"请输入集群名称"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9]*$/,message:"请输入中文、英文字母或数字"},{min:2,max:20,message:"请输入2到20个字符"}],useType:[{required:!0,message:"请选择集群用途"}],type:[{required:!0,message:"请选择集群类型"}],desc:[{required:!0,message:"请描述集群的使用场景"}]},useTypeOptionList:[{value:1,label:"服务路由"}],typeOptionList:[{value:2,label:"HTTP服务"},{value:3,label:"HTTP流"}],addIpPortData:{cloudServerList:[{host:"",port:null,weight:1,isBackup:0,down:0,resolve:0}]},addIpPortRules:{host:[{validator:function(t,a,i,r){var s=Object.keys(r)[0],n=s.indexOf("[")+1,l=s.indexOf("]"),o=s.slice(n,l);if(0===e.addIpPortData.cloudServerList[o].resolve)if(""===a)i(new Error("请输入IP"));else{RegExp(/^((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)(\.((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)){3}$/).test(a)?i():i(new Error("请输入正确的IP"))}else if(1===e.addIpPortData.cloudServerList[o].resolve)if(""===a)i(new Error("请输入域名"));else{RegExp(/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/).test(a)?i():i(new Error("请输入正确的域名"))}else i(new Error("请选择IP/域名"))}}],port:[{required:!0,message:"请输入端口"},{pattern:/^[0-9]*$/,message:"请输入数字"}],weight:[{required:!0,message:"请输入权重"},{pattern:/^[0-9]*$/,message:"请输入数字"}]},cloudServerListColumnList:[{label:"IP/域名",prop:"host",width:"240"},{label:"端口",prop:"port"},{label:"权重",prop:"weight"},{label:"是否备用",prop:"isBackup"},{label:"是否停用",prop:"down"}],resolveOptionList:[{value:0,label:"IP"},{value:1,label:"域名"}],isBackupOptionList:[{value:0,label:"否"},{value:1,label:"是"}],downOptionList:[{value:0,label:"否"},{value:1,label:"是"}],setTheTimeoutData:{connectTimeout:500,readTimeout:5e3,sendTimeout:5e3,reliveTimeout:1e4},setTheTimeoutRules:{connectTimeout:[{required:!0,message:"请设置连接超时时间/ms"}],readTimeout:[{required:!0,message:"请设置读取超时时间/ms"}],sendTimeout:[{required:!0,message:"请设置发送超时时间/ms"}],reliveTimeout:[{required:!0,message:"请设置自动复活时间/ms"}]},setTheTimeoutList:[{label:"连接超时时间/ms",prop:"connectTimeout"},{label:"读取超时时间/ms",prop:"readTimeout"},{label:"发送超时时间/ms",prop:"sendTimeout"},{label:"自动复活时间/ms",prop:"reliveTimeout"}],nextStepLoading:!1}},computed:{computeNextStepText:function(){return 2===this.active?"保存":"下一步"}},methods:{cloudClusterSave:function(){var e=Object(r.a)(Object(i.a)().mark((function e(){var t,a,r,n,l,o,u,c,p,d,f,m,h=this;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.clusterBasicInfoData,a=t.name,r=t.useType,n=t.type,l=t.desc,o=this.addIpPortData.cloudServerList,u=this.setTheTimeoutData,c=u.connectTimeout,p=u.sendTimeout,d=u.readTimeout,f=u.reliveTimeout,m={name:a,useType:r,type:n,desc:l,cloudServerList:o,connectTimeout:c,sendTimeout:p,readTimeout:d,reliveTimeout:f,sceneType:1},e.next=6,s.a.cloudClusterSave(m).catch((function(e){var t=e.data.message;throw t&&h.$message.error(t),new Error(e)}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),judgeHostPlaceholder:function(e){return{0:"请输入IP",1:"请输入域名"}[this.addIpPortData.cloudServerList[e].resolve]},addRowData:function(){this.addIpPortData.cloudServerList.push({host:"",port:null,weight:1,isBackup:0,down:0,resolve:0})},removeRowData:function(e){this.addIpPortData.cloudServerList.splice(e,1)},dialogBeforeClose:function(){var e=this;["clusterBasicInfoData","addIpPortData","setTheTimeoutData"].forEach((function(t){e.$refs[t].resetFields()})),this.active=0,this.$emit("update:createClusterDialogVisible",!1),this.$emit("queryRefresh",!0)},nextStep:function(){var e=this;this.$refs[{0:"clusterBasicInfoData",1:"addIpPortData",2:"setTheTimeoutData"}[this.active]].validate(function(){var t=Object(r.a)(Object(i.a)().mark((function t(a){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=9;break}if(2!==e.active){t.next=5;break}return e.nextStepLoading=!0,t.next=5,e.cloudClusterSave().catch((function(t){e.nextStepLoading=!1;var a=t.data.message;throw a&&e.$message.error(a),new Error(t)}));case 5:e.active+=1,e.nextStepLoading=!1,t.next=10;break;case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},continueCreate:function(){var e=this;["clusterBasicInfoData","addIpPortData","setTheTimeoutData"].forEach((function(t){e.$refs[t].resetFields()})),this.active=0}}},l=n,o=(a("b4a3"),a("2877")),u=Object(o.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"create-cluster-dialog",attrs:{visible:e.createClusterDialogVisible,"close-on-click-modal":!1,title:"创建集群",width:"800px"},on:{close:e.dialogBeforeClose}},[a("div",{staticClass:"create-cluster-dialog__content"},[a("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},e._l(e.stepList,(function(e,t){return a("el-step",{key:t,attrs:{title:e.title}})})),1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],ref:"clusterBasicInfoData",staticClass:"create-cluster-dialog__form",attrs:{model:e.clusterBasicInfoData,rules:e.clusterBasicInfoRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"集群名称",prop:"name"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入集群名称"},model:{value:e.clusterBasicInfoData.name,callback:function(t){e.$set(e.clusterBasicInfoData,"name","string"==typeof t?t.trim():t)},expression:"clusterBasicInfoData.name"}})],1),a("el-form-item",{attrs:{label:"集群用途",prop:"useType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择集群用途"},model:{value:e.clusterBasicInfoData.useType,callback:function(t){e.$set(e.clusterBasicInfoData,"useType",t)},expression:"clusterBasicInfoData.useType"}},e._l(e.useTypeOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"集群类型",prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择集群类型"},model:{value:e.clusterBasicInfoData.type,callback:function(t){e.$set(e.clusterBasicInfoData,"type",t)},expression:"clusterBasicInfoData.type"}},e._l(e.typeOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"集群描述",prop:"desc"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",placeholder:"请描述集群的使用场景"},model:{value:e.clusterBasicInfoData.desc,callback:function(t){e.$set(e.clusterBasicInfoData,"desc","string"==typeof t?t.trim():t)},expression:"clusterBasicInfoData.desc"}})],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],ref:"addIpPortData",staticClass:"create-cluster-dialog__second-form",attrs:{model:e.addIpPortData,rules:e.addIpPortRules}},[a("el-table",{attrs:{data:e.addIpPortData.cloudServerList,"max-height":"180"}},[e._l(e.cloudServerListColumnList,(function(t,i){return a("el-table-column",{key:i,attrs:{label:t.label,prop:t.prop,width:t.width},scopedSlots:e._u([{key:"default",fn:function(i){var r=i.$index;return["host"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].host",rules:e.addIpPortRules.host}},[a("div",{staticClass:"item-content"},[a("el-select",{staticStyle:{width:"40%"},model:{value:e.addIpPortData.cloudServerList[r].resolve,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"resolve",t)},expression:"addIpPortData.cloudServerList[$index].resolve"}},e._l(e.resolveOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:e.judgeHostPlaceholder(r)},model:{value:e.addIpPortData.cloudServerList[r].host,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"host","string"==typeof t?t.trim():t)},expression:"addIpPortData.cloudServerList[$index].host"}})],1)])]:"port"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].port",rules:e.addIpPortRules.port}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"端口"},model:{value:e.addIpPortData.cloudServerList[r].port,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"port",e._n(t))},expression:"addIpPortData.cloudServerList[$index].port"}})],1)]:"weight"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].weight",rules:e.addIpPortRules.weight}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"权重"},model:{value:e.addIpPortData.cloudServerList[r].weight,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"weight",e._n(t))},expression:"\n                    addIpPortData.cloudServerList[$index].weight\n                  "}})],1)]:"isBackup"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].isBackup",rules:e.addIpPortRules.isBackup}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.addIpPortData.cloudServerList[r].isBackup,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"isBackup",t)},expression:"addIpPortData.cloudServerList[$index].isBackup"}},e._l(e.isBackupOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]:"down"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].down",rules:e.addIpPortRules.isBackup}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.addIpPortData.cloudServerList[r].down,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"down",t)},expression:"addIpPortData.cloudServerList[$index].down"}},e._l(e.downOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]:e._e()]}}],null,!0)})})),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.$index;return[a("div",{staticClass:"icon-wrapper"},[i>0?a("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.removeRowData(i)}}}):e._e()])]}}])})],2),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{icon:"el-icon-plus",plain:""},on:{click:e.addRowData}},[e._v("添加")])],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active === 2"}],ref:"setTheTimeoutData",staticClass:"create-cluster-dialog__form",attrs:{model:e.setTheTimeoutData,rules:e.setTheTimeoutRules,"label-width":"140px"}},e._l(e.setTheTimeoutList,(function(t,i){return a("el-form-item",{key:i,attrs:{label:t.label,prop:t.prop}},[a("el-input-number",{attrs:{min:1,step:100,precision:0,"controls-position":"right"},model:{value:e.setTheTimeoutData[t.prop],callback:function(a){e.$set(e.setTheTimeoutData,t.prop,a)},expression:"setTheTimeoutData[item.prop]"}})],1)})),1),a("div",{directives:[{name:"show",rawName:"v-show",value:3===e.active,expression:"active === 3"}],staticClass:"create-success"},[a("i",{staticClass:"el-icon-success normalColor"}),a("p",{staticClass:"create-success__title"},[e._v("创建成功")])])],1),a("div",{staticClass:"create-cluster-dialog__footer",attrs:{slot:"footer"},slot:"footer"},[0===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v("下一步")])],1):1===e.active||2===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{on:{click:function(t){e.active-=1}}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary",loading:e.nextStepLoading},on:{click:e.nextStep}},[e._v(e._s(e.computeNextStepText))])],1):3===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{type:"primary"},on:{click:e.continueCreate}},[e._v("继续创建")])],1):e._e()])])}),[],!1,null,"0f1884b0",null);t.a=u.exports},"0e07":function(e,t,a){"use strict";var i=a("7aef"),r=a("7562"),s=(a("b775"),{queryList:function(e){return r.a.post("/ApiManagerService/queryCloudClusterList",[e])},cloudClusterSave:function(e){return r.a.post("/ApiManagerService/saveCloudCluster",[e])},cloudClusterUpdate:function(e){return r.a.post("/ApiManagerService/updateCloudCluster",[e])},findUser:function(e){return i.a.get("/hrInfo/findUser",{params:e})},findSupplierUserByErp:function(e){return i.a.get("/supplier/findSupplierUserByErp",{params:e})},saveBaseInfo:function(e){return r.a.post("/HttpApiService/saveBaseInfo",[e])},queryApiReleaseByCondition:function(e){return r.a.post("/ApiDepotService/queryApiReleaseByCondition",JSON.stringify(e))},queryAliasByInterface:function(e){return r.a.post("/JsfApiMetaService/queryAliasByInterface",JSON.stringify(e))},getMethodList:function(e){return r.a.post("/ApiDepotService/queryApiReleaseByCondition",JSON.stringify(e))},queryMethodByInterface:function(e){return r.a.post("/JsfApiMetaService/queryMethodByInterface",JSON.stringify(e))},getSensitiveLabelForest:function(){return r.a.post("/HttpApiService/querySensitiveLabelForest")}});t.a=s},1799:function(e,t,a){"use strict";var i=(a("c5f6"),{name:"Pagination",props:{currentPage:{type:Number,required:!0},pageSize:{type:Number,required:!0},total:{type:Number,default:0},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},reloadTableData:{type:Function,default:function(){}}},methods:{onCurrentChange:function(e){this.$emit("update:currentPage",e),this.reloadTableData()},onSizeChange:function(e){this.$emit("update:pageSize",e),this.reloadTableData()}}}),r=i,s=(a("3fca"),a("2877")),n=Object(s.a)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("el-pagination",{staticClass:"pagination",attrs:{background:!0,"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":e.pageSizes,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.onCurrentChange,"size-change":e.onSizeChange}})}),[],!1,null,"52f386a2",null);t.a=n.exports},"24ec":function(e,t,a){e.exports=a.p+"img/noData.aadb7b7d.png"},"30a5":function(e,t,a){"use strict";a("c0d4")},"328c":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s})),a("b775");var i=a("7562");function r(e){return i.a.post("/ApiManagerService/queryApiCategory",JSON.stringify(e))}function s(e){return i.a.post("/HttpApiService/queryApiList",e)}},"333d":function(e,t,a){"use strict";a("c5f6"),Math.easeInOutQuad=function(e,t,a,i){return(e/=i/2)<1?a/2*e*e+t:-a/2*(--e*(e-2)-1)+t};var i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};function r(e,t,a){var r=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,s=e-r,n=0;t=void 0===t?500:t;!function e(){n+=20,function(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}(Math.easeInOutQuad(n,r,s,t)),n<t?i(e):a&&"function"==typeof a&&a()}()}var s={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&r(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&r(0,800)}}},n=s,l=(a("8d79"),a("2877")),o=Object(l.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)}),[],!1,null,"0a87263c",null);t.a=o.exports},3919:function(e,t,a){"use strict";a("3934e")},"3934e":function(e,t,a){},3935:function(e,t,a){"use strict";var i=a("c7eb"),r=(a("96cf"),a("1da1")),s=a("0e07"),n={name:"ErpPrincipal",props:{showPopover:{type:Boolean,default:!1},formDataPrincipal:{type:String,required:!0},placeholder:{type:String,default:"请输入负责人的ERP账号"},disabled:{type:Boolean,default:!1}},data:function(){return{dataPrincipal:"",principalVisible:!1,principalLoading:!1,principalOptionList:[]}},watch:{formDataPrincipal:{handler:function(e){this.dataPrincipal=e},immediate:!0}},methods:{findUser:function(){var e=Object(r.a)(Object(i.a)().mark((function e(t){var a,r=this;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={erp:t},e.next=3,s.a.findUser(a).catch((function(e){var t=e.data.message;throw t&&r.$message.error(t),new Error(t)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),findSupplierUserByErp:function(){var e=Object(r.a)(Object(i.a)().mark((function e(t){var a,r=this;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={erp:t},e.next=3,s.a.findSupplierUserByErp(a).catch((function(e){var t=e.data.message;throw t&&r.$message.error(t),new Error(e)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),changePrincipal:function(){var e=Object(r.a)(Object(i.a)().mark((function e(t){var a,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.$emit("update:formDataPrincipal",t),!this.showPopover){e.next=7;break}return e.next=4,this.findSupplierUserByErp(t);case 4:a=e.sent,r=a.data.data,this.principalVisible=!r;case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),remotePrincipal:function(){var e=Object(r.a)(Object(i.a)().mark((function e(t){var a,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===t){e.next=10;break}return this.principalLoading=!0,e.next=4,this.findUser(t);case 4:a=e.sent,r=a.data.data,this.principalOptionList=r,this.principalLoading=!1,e.next=11;break;case 10:this.principalOptionList=[];case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}},l=n,o=(a("7780"),a("2877")),u=Object(o.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"erp-principal"},[a("el-popover",{attrs:{placement:"top-start",width:"280","popper-class":"erp-info-popover"},model:{value:e.principalVisible,callback:function(t){e.principalVisible=t},expression:"principalVisible"}},[a("div",{staticClass:"content-wrapper"},[a("i",{staticClass:"el-icon-info"}),a("p",{staticClass:"text"},[e._v(" 【"+e._s(e.formDataPrincipal)+"】不在您的团队下，为了不影响接口审批，建议去【个人中心】将该用户拉入您的团队。 ")])]),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.principalVisible=!1}}},[e._v("我知道了")])],1),a("span",{attrs:{slot:"reference"},slot:"reference"})]),a("el-select",{staticStyle:{width:"100%"},attrs:{loading:e.principalLoading,filterable:!0,remote:!0,"remote-method":e.remotePrincipal,placeholder:e.placeholder,disabled:e.disabled,"value-key":"userName","popper-class":"erp-info-dropdown__list"},on:{change:e.changePrincipal},model:{value:e.dataPrincipal,callback:function(t){e.dataPrincipal=t},expression:"dataPrincipal"}},e._l(e.principalOptionList,(function(t){return a("el-option",{key:t.userName,attrs:{label:t.userName,value:t.userName}},[a("div",{staticClass:"photo-wrapper"},[a("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:t.headImg}})]),a("div",{staticClass:"info-wrapper"},[a("p",{staticClass:"name"},[e._v(e._s(t.userName)+"（"+e._s(t.realName)+"）")]),a("p",{staticClass:"organization"},[e._v(" "+e._s(t.organizationFullName)+" ")])])])})),1)],1)}),[],!1,null,"1a467d82",null);t.a=u.exports},"3b2b":function(e,t,a){var i=a("7726"),r=a("5dbc"),s=a("86cc").f,n=a("9093").f,l=a("aae3"),o=a("0bfb"),u=i.RegExp,c=u,p=u.prototype,d=/a/g,f=/a/g,m=new u(d)!==d;if(a("9e1e")&&(!m||a("79e5")((function(){return f[a("2b4c")("match")]=!1,u(d)!=d||u(f)==f||"/a/i"!=u(d,"i")})))){u=function(e,t){var a=this instanceof u,i=l(e),s=void 0===t;return!a&&i&&e.constructor===u&&s?e:r(m?new c(i&&!s?e.source:e,t):c((i=e instanceof u)?e.source:e,i&&s?o.call(e):t),a?this:p,u)};for(var h=function(e){e in u||s(u,e,{configurable:!0,get:function(){return c[e]},set:function(t){c[e]=t}})},v=n(c),b=0;v.length>b;)h(v[b++]);p.constructor=u,u.prototype=p,a("2aba")(i,"RegExp",u)}a("7a56")("RegExp")},"3fca":function(e,t,a){"use strict";a("848d")},4475:function(e,t,a){},"4b4d":function(e,t,a){},"4c63":function(e,t,a){"use strict";a("6b90")},"547a":function(e,t,a){"use strict";var i=a("3266");t.a={methods:{clstag:function(e,t){return Object(i.a)(e,t)}}}},5990:function(e,t,a){"use strict";a("62dc")},"62dc":function(e,t,a){},"6b90":function(e,t,a){},"753e":function(e,t,a){},7780:function(e,t,a){"use strict";a("0be6")},"77de":function(e,t,a){},"7ea6":function(e,t,a){},"848d":function(e,t,a){},"8d79":function(e,t,a){"use strict";a("753e")},9572:function(e,t,a){"use strict";var i=a("c7eb"),r=(a("7f7f"),a("96cf"),a("1da1")),s=(a("3b2b"),a("ac6a"),a("456d"),a("0e07")),n={name:"CreateClusterDialog",props:{createClusterDialogVisible:{type:Boolean,required:!0}},data:function(){var e=this;return{active:0,stepList:[{title:"填写基本信息"},{title:"添加IP端口"},{title:"设置超时时间"},{title:"创建成功"}],clusterBasicInfoData:{name:"",useType:null,type:null,desc:""},clusterBasicInfoRules:{name:[{required:!0,message:"请输入集群名称"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9]*$/,message:"请输入中文、英文字母或数字"},{min:2,max:20,message:"请输入2到20个字符"}],useType:[{required:!0,message:"请选择集群用途"}],type:[{required:!0,message:"请选择集群类型"}],desc:[{required:!0,message:"请描述集群的使用场景"}]},useTypeOptionList:[{value:1,label:"服务路由"}],typeOptionList:[{value:2,label:"HTTP服务"},{value:3,label:"HTTP流"}],addIpPortData:{cloudServerList:[{host:"",port:null,weight:1,isBackup:0,down:0,resolve:0}]},addIpPortRules:{host:[{validator:function(t,a,i,r){var s=Object.keys(r)[0],n=s.indexOf("[")+1,l=s.indexOf("]"),o=s.slice(n,l);if(0===e.addIpPortData.cloudServerList[o].resolve)if(""===a)i(new Error("请输入IP"));else{RegExp(/^((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)(\.((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)){3}$/).test(a)?i():i(new Error("请输入正确的IP"))}else if(1===e.addIpPortData.cloudServerList[o].resolve)if(""===a)i(new Error("请输入域名"));else{RegExp(/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/).test(a)?i():i(new Error("请输入正确的域名"))}else i(new Error("请选择IP/域名"))}}],port:[{required:!0,message:"请输入端口"},{pattern:/^[0-9]*$/,message:"请输入数字"}],weight:[{required:!0,message:"请输入权重"},{pattern:/^[0-9]*$/,message:"请输入数字"}]},cloudServerListColumnList:[{label:"IP/域名",prop:"host",width:"240"},{label:"端口",prop:"port"},{label:"权重",prop:"weight"},{label:"是否备用",prop:"isBackup"},{label:"是否停用",prop:"down"}],resolveOptionList:[{value:0,label:"IP"},{value:1,label:"域名"}],isBackupOptionList:[{value:0,label:"否"},{value:1,label:"是"}],downOptionList:[{value:0,label:"否"},{value:1,label:"是"}],setTheTimeoutData:{connectTimeout:500,readTimeout:5e3,sendTimeout:5e3,reliveTimeout:1e4},setTheTimeoutRules:{connectTimeout:[{required:!0,message:"请设置连接超时时间/ms"}],readTimeout:[{required:!0,message:"请设置读取超时时间/ms"}],sendTimeout:[{required:!0,message:"请设置发送超时时间/ms"}],reliveTimeout:[{required:!0,message:"请设置自动复活时间/ms"}]},setTheTimeoutList:[{label:"连接超时时间/ms",prop:"connectTimeout"},{label:"读取超时时间/ms",prop:"readTimeout"},{label:"发送超时时间/ms",prop:"sendTimeout"},{label:"自动复活时间/ms",prop:"reliveTimeout"}],nextStepLoading:!1}},computed:{computeNextStepText:function(){return 2===this.active?"保存":"下一步"}},methods:{cloudClusterSave:function(){var e=Object(r.a)(Object(i.a)().mark((function e(){var t,a,r,n,l,o,u,c,p,d,f,m,h=this;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 3,t=this.clusterBasicInfoData,a=t.name,r=t.useType,n=t.type,l=t.desc,o=this.addIpPortData.cloudServerList,u=this.setTheTimeoutData,c=u.connectTimeout,p=u.sendTimeout,d=u.readTimeout,f=u.reliveTimeout,m={name:a,useType:r,type:n,desc:l,cloudServerList:o,connectTimeout:c,sendTimeout:p,readTimeout:d,reliveTimeout:f,sceneType:3},e.next=7,s.a.cloudClusterSave(m).catch((function(e){var t=e.data.message;throw t&&h.$message.error(t),new Error(e)}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),judgeHostPlaceholder:function(e){return{0:"请输入IP",1:"请输入域名"}[this.addIpPortData.cloudServerList[e].resolve]},addRowData:function(){this.addIpPortData.cloudServerList.push({host:"",port:null,weight:1,isBackup:0,down:0,resolve:0})},removeRowData:function(e){this.addIpPortData.cloudServerList.splice(e,1)},dialogBeforeClose:function(){var e=this;["clusterBasicInfoData","addIpPortData","setTheTimeoutData"].forEach((function(t){e.$refs[t].resetFields()})),this.active=0,this.$emit("update:createClusterDialogVisible",!1),this.$emit("queryRefresh",!0)},nextStep:function(){var e=this;this.$refs[{0:"clusterBasicInfoData",1:"addIpPortData",2:"setTheTimeoutData"}[this.active]].validate(function(){var t=Object(r.a)(Object(i.a)().mark((function t(a){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=9;break}if(2!==e.active){t.next=5;break}return e.nextStepLoading=!0,t.next=5,e.cloudClusterSave().catch((function(t){e.nextStepLoading=!1;var a=t.data.message;throw a&&e.$message.error(a),new Error(t)}));case 5:e.active+=1,e.nextStepLoading=!1,t.next=10;break;case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},continueCreate:function(){var e=this;["clusterBasicInfoData","addIpPortData","setTheTimeoutData"].forEach((function(t){e.$refs[t].resetFields()})),this.active=0}}},l=n,o=(a("4c63"),a("2877")),u=Object(o.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"create-cluster-dialog",attrs:{visible:e.createClusterDialogVisible,"close-on-click-modal":!1,title:"创建集群",width:"800px"},on:{close:e.dialogBeforeClose}},[a("div",{staticClass:"create-cluster-dialog__content"},[a("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},e._l(e.stepList,(function(e,t){return a("el-step",{key:t,attrs:{title:e.title}})})),1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],ref:"clusterBasicInfoData",staticClass:"create-cluster-dialog__form",attrs:{model:e.clusterBasicInfoData,rules:e.clusterBasicInfoRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"集群名称",prop:"name"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入集群名称"},model:{value:e.clusterBasicInfoData.name,callback:function(t){e.$set(e.clusterBasicInfoData,"name","string"==typeof t?t.trim():t)},expression:"clusterBasicInfoData.name"}})],1),a("el-form-item",{attrs:{label:"集群用途",prop:"useType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择集群用途"},model:{value:e.clusterBasicInfoData.useType,callback:function(t){e.$set(e.clusterBasicInfoData,"useType",t)},expression:"clusterBasicInfoData.useType"}},e._l(e.useTypeOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"集群类型",prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择集群类型"},model:{value:e.clusterBasicInfoData.type,callback:function(t){e.$set(e.clusterBasicInfoData,"type",t)},expression:"clusterBasicInfoData.type"}},e._l(e.typeOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"集群描述",prop:"desc"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",placeholder:"请描述集群的使用场景"},model:{value:e.clusterBasicInfoData.desc,callback:function(t){e.$set(e.clusterBasicInfoData,"desc","string"==typeof t?t.trim():t)},expression:"clusterBasicInfoData.desc"}})],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],ref:"addIpPortData",staticClass:"create-cluster-dialog__second-form",attrs:{model:e.addIpPortData,rules:e.addIpPortRules}},[a("el-table",{attrs:{data:e.addIpPortData.cloudServerList,"max-height":"180"}},[e._l(e.cloudServerListColumnList,(function(t,i){return a("el-table-column",{key:i,attrs:{label:t.label,prop:t.prop,width:t.width},scopedSlots:e._u([{key:"default",fn:function(i){var r=i.$index;return["host"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].host",rules:e.addIpPortRules.host}},[a("div",{staticClass:"item-content"},[a("el-select",{staticStyle:{width:"40%"},model:{value:e.addIpPortData.cloudServerList[r].resolve,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"resolve",t)},expression:"addIpPortData.cloudServerList[$index].resolve"}},e._l(e.resolveOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:e.judgeHostPlaceholder(r)},model:{value:e.addIpPortData.cloudServerList[r].host,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"host","string"==typeof t?t.trim():t)},expression:"addIpPortData.cloudServerList[$index].host"}})],1)])]:"port"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].port",rules:e.addIpPortRules.port}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"端口"},model:{value:e.addIpPortData.cloudServerList[r].port,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"port",e._n(t))},expression:"addIpPortData.cloudServerList[$index].port"}})],1)]:"weight"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].weight",rules:e.addIpPortRules.weight}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"权重"},model:{value:e.addIpPortData.cloudServerList[r].weight,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"weight",e._n(t))},expression:"\n                    addIpPortData.cloudServerList[$index].weight\n                  "}})],1)]:"isBackup"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].isBackup",rules:e.addIpPortRules.isBackup}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.addIpPortData.cloudServerList[r].isBackup,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"isBackup",t)},expression:"addIpPortData.cloudServerList[$index].isBackup"}},e._l(e.isBackupOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]:"down"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].down",rules:e.addIpPortRules.isBackup}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.addIpPortData.cloudServerList[r].down,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"down",t)},expression:"addIpPortData.cloudServerList[$index].down"}},e._l(e.downOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]:e._e()]}}],null,!0)})})),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.$index;return[a("div",{staticClass:"icon-wrapper"},[i>0?a("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.removeRowData(i)}}}):e._e()])]}}])})],2),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{icon:"el-icon-plus",plain:""},on:{click:e.addRowData}},[e._v("添加")])],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active === 2"}],ref:"setTheTimeoutData",staticClass:"create-cluster-dialog__form",attrs:{model:e.setTheTimeoutData,rules:e.setTheTimeoutRules,"label-width":"140px"}},e._l(e.setTheTimeoutList,(function(t,i){return a("el-form-item",{key:i,attrs:{label:t.label,prop:t.prop}},[a("el-input-number",{attrs:{min:1,step:100,precision:0,"controls-position":"right"},model:{value:e.setTheTimeoutData[t.prop],callback:function(a){e.$set(e.setTheTimeoutData,t.prop,a)},expression:"setTheTimeoutData[item.prop]"}})],1)})),1),a("div",{directives:[{name:"show",rawName:"v-show",value:3===e.active,expression:"active === 3"}],staticClass:"create-success"},[a("i",{staticClass:"el-icon-success normalColor"}),a("p",{staticClass:"create-success__title"},[e._v("创建成功")])])],1),a("div",{staticClass:"create-cluster-dialog__footer",attrs:{slot:"footer"},slot:"footer"},[0===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v("下一步")])],1):1===e.active||2===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{on:{click:function(t){e.active-=1}}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary",loading:e.nextStepLoading},on:{click:e.nextStep}},[e._v(e._s(e.computeNextStepText))])],1):3===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{type:"primary"},on:{click:e.continueCreate}},[e._v("继续创建")])],1):e._e()])])}),[],!1,null,"0395e54e",null);t.a=u.exports},"9afc":function(e,t,a){"use strict";a("4b4d")},"9bb2":function(e,t,a){"use strict";a.r(t);var i=(a("a481"),a("6762"),a("7f7f"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"api-list"},[i("el-row",{staticClass:"filter-container"},[i("el-col",{attrs:{span:18}},[i("el-form",{staticStyle:{height:"45px"},attrs:{inline:!0,model:e.listQuery},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",[i("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:e.searchInputPlaceholder,clstag:e.clstag("apiManager_1618992937884|2","")},on:{input:e.onSearchChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.listQuery.searchKeyWord,callback:function(t){e.$set(e.listQuery,"searchKeyWord",t)},expression:"listQuery.searchKeyWord"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")])],1)],1)],1),i("el-col",{attrs:{span:6}},[i("el-button",{staticStyle:{"margin-bottom":"5px",float:"right"},attrs:{type:"primary",icon:"el-icon-plus",clstag:e.clstag("apiManager_1618997499692|1","")},on:{click:e.registerApi}},[e._v("注册API")])],1)],1),0===e.tableDatas.length&&1===e.type?i("div",{staticClass:"noData"},[i("img",{attrs:{src:a("24ec")}}),i("p",[e._v("抱歉，没有查询到结果～")])]):e._e(),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"},{name:"show",rawName:"v-show",value:e.tableDatas.length>0&&1===e.type,expression:"tableDatas.length > 0 && type === 1"}],staticClass:"my-table mb2",attrs:{data:e.tableDatas,"row-class-name":e.rowClassName}},[i("template",{slot:"empty"},[i("div",[e._v("经查询，无符合搜索条件的结果")])]),i("el-table-column",{attrs:{label:"序号",prop:"number",width:"48px"}}),i("el-table-column",{attrs:{label:"JSF接口名",prop:"qualifiedName",align:"left","min-width":"40%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"API名称",prop:"cnName",align:"left","min-width":"30%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"状态",prop:"status","min-width":"13%"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==+t.row.isOnline&&1==+t.row.status?i("span",{staticClass:"status_init status"},[e._v(" 初始化 ")]):e._e(),1==+t.row.isOnline&&1==+t.row.status?i("span",{staticClass:"status_edit status"},[e._v(" 编辑中 ")]):e._e(),3==+t.row.status||9==+t.row.status||7==+t.row.status?i("span",{staticClass:"status_approve status"},[e._v(" 审批中 ")]):e._e(),4==+t.row.status?i("span",{staticClass:"status_released status"},[e._v(" 已发布 ")]):e._e(),6==+t.row.status?i("span",{staticClass:"status_offline status"},[e._v(" 已下线 ")]):e._e()]}}])}),i("el-table-column",{attrs:{label:"更新人",prop:"createUser",align:"left","min-width":"17.11%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"更新时间",prop:"createTime","min-width":"24.11%"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.serializationTime(a.createTime)))])]}}])}),i("el-table-column",{attrs:{label:"操作",prop:"id","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.jsfBtnStatus(t.row).edit.visible?i("el-link",{attrs:{type:"primary",underline:!1,disabled:e.jsfBtnStatus(t.row).edit.disabled},on:{click:function(a){return e.$router.push({name:"ApiManagerDetail",params:{id:t.row.id,type:"jsf"}})}}},[e._v("管理")]):e._e()]}}])})],2),0===e.httpTableDatas.length&&2===e.type?i("div",{staticClass:"noData"},[i("img",{attrs:{src:a("24ec")}}),i("p",[e._v("抱歉，没有查询到结果～")])]):e._e(),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"},{name:"show",rawName:"v-show",value:e.httpTableDatas.length>0&&2===e.type,expression:"httpTableDatas.length > 0 && type === 2"}],staticClass:"my-table mb2",attrs:{data:e.httpTableDatas,"row-class-name":e.rowClassName}},[i("template",{slot:"empty"},[i("div",[e._v("经查询，无符合搜索条件的结果")])]),i("el-table-column",{attrs:{label:"序号",prop:"number",width:"48px"}}),i("el-table-column",{attrs:{label:"API中文名称",prop:"name",align:"left","min-width":"40%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"URI",prop:"url",align:"left","min-width":"30%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"所属分组",prop:"domainName",align:"left","min-width":"20.40%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"状态",prop:"status","min-width":"13%"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==+t.row.isOnline&&1==+t.row.status?i("span",{staticClass:"status_init status"},[e._v(" 初始化 ")]):e._e(),1==+t.row.isOnline&&1==+t.row.status?i("span",{staticClass:"status_edit status"},[e._v(" 编辑中 ")]):e._e(),3==+t.row.status||9==+t.row.status||7==+t.row.status?i("span",{staticClass:"status_approve status"},[e._v(" 审批中 ")]):e._e(),4==+t.row.status?i("span",{staticClass:"status_released status"},[e._v(" 已发布 ")]):e._e(),6==+t.row.status?i("span",{staticClass:"status_offline status"},[e._v(" 已下线 ")]):e._e()]}}])}),i("el-table-column",{attrs:{label:"更新人",prop:"updateUser",align:"left","min-width":"17.11%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"更新时间",prop:"updateTime","min-width":"24.11%"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.serializationTime(a.updateTime)))])]}}])}),i("el-table-column",{attrs:{label:"操作",prop:"id","min-width":"17%"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){return e.$router.push({name:"ApiManagerDetail",params:{id:t.row.id,type:"http"}})}}},[e._v("管理")]),e.tapOutBtnStatus(t.row).visible?i("el-link",{staticClass:"tap-out-http",attrs:{type:"primary",disabled:e.tapOutBtnStatus(t.row).disabled,underline:!1},on:{click:function(a){return e.handleTapOutHttp(t.row)}}},[e._v("下线")]):e._e()]}}])})],2),i("el-row",[i("el-col",{attrs:{span:24}},[i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.listQuery.total&&1===e.type,expression:"listQuery.total && type === 1"}],staticStyle:{margin:"0px",float:"right"},attrs:{total:e.listQuery.total,pageSizes:e.listQuery.pageSizes,page:e.listQuery.pageNumb,limit:e.listQuery.pageSize},on:{"update:pageSizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page-sizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page":function(t){return e.$set(e.listQuery,"pageNumb",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.paginationChange}}),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.httpListQuery.total&&2===e.type,expression:"httpListQuery.total && type === 2"}],staticStyle:{margin:"0px",float:"right"},attrs:{total:e.httpListQuery.total,pageSizes:e.httpListQuery.pageSizes,page:e.httpListQuery.pageNumb,limit:e.httpListQuery.pageSize},on:{"update:pageSizes":function(t){return e.$set(e.httpListQuery,"pageSizes",t)},"update:page-sizes":function(t){return e.$set(e.httpListQuery,"pageSizes",t)},"update:page":function(t){return e.$set(e.httpListQuery,"pageNumb",t)},"update:limit":function(t){return e.$set(e.httpListQuery,"pageSize",t)},pagination:e.paginationHttpChange}})],1)],1),i("TapOutJsfDialog",{attrs:{tapOutJsfDiaInfo:e.tapOutJsfDiaInfo},on:{"update:tapOutJsfDiaInfo":function(t){e.tapOutJsfDiaInfo=t},"update:tap-out-jsf-dia-info":function(t){e.tapOutJsfDiaInfo=t},queryApi:e.queryApi}}),i("el-dialog",{attrs:{width:"530px",type:"text",title:"API下线申请","custom-class":"tap-out-http-dia",visible:e.tapOutHttpDiaInfo.show},on:{"update:visible":function(t){return e.$set(e.tapOutHttpDiaInfo,"show",t)}}},["step1"===e.tapOutHttpDiaInfo.curStep?i("div",{staticClass:"dia-content"},[i("p",[i("i",{staticClass:"el-icon-warning"}),i("span",{staticClass:"step1-title step-title"},[e._v("确认要下线此API吗？")])]),i("p",{staticClass:"step1-des"},[e._v("此API在7天内有调用量，如果下线将会影响调用方")])]):"step2"===e.tapOutHttpDiaInfo.curStep?i("div",{staticClass:"dia-content"},[i("p",{staticClass:"step-title"},[e._v("请填写审批人ERP账号")]),i("p",{},[e._v("审批人不能是本人，审批通过后，API下线生效")]),i("div",{staticClass:"step2-form_content"},[i("el-form",{ref:"tapOutHttpApplyerErp",attrs:{model:e.tapOutHttpDiaInfo.applyerFormValue,rules:e.tapOutHttpDiaInfo.tapOutHttpApplyerErpFormRule}},[i("el-form-item",{staticClass:"step2-form-item_wrap",attrs:{prop:"applyerErp",label:"审批人ERP账号"}},[i("ErpPrincipal",{attrs:{formDataPrincipal:e.tapOutHttpDiaInfo.applyerFormValue.applyerErp,placeholder:"审批人可在京ME流程中心审批"},on:{"update:formDataPrincipal":function(t){return e.$set(e.tapOutHttpDiaInfo.applyerFormValue,"applyerErp",t)},"update:form-data-principal":function(t){return e.$set(e.tapOutHttpDiaInfo.applyerFormValue,"applyerErp",t)}}})],1)],1)],1)]):"step3"===e.tapOutHttpDiaInfo.curStep?i("div",{staticClass:"dia-content dia-content_success"},[i("i",{staticClass:"el-icon-success"}),i("p",{staticClass:"step3-title"},[e._v("提交成功")]),i("p",{staticClass:"step3-des"},[e._v("提醒审批人尽快审批吧，审批通过后API下线生效")])]):e._e(),i("div",{attrs:{slot:"footer"},slot:"footer"},["step1"===e.tapOutHttpDiaInfo.curStep?[i("el-button",{on:{click:e.handleDiaCancel}},[e._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleDiaConfirm("step1")}}},[e._v("下线")])]:e._e(),"step2"===e.tapOutHttpDiaInfo.curStep?[i("el-button",{on:{click:e.handleDiaCancel}},[e._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleDiaConfirm("step2")}}},[e._v("提交")])]:e._e(),"step3"===e.tapOutHttpDiaInfo.curStep?[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleDiaConfirm("step3")}}},[e._v("确定")])]:e._e()],2)])],1)}),r=a("c7eb"),s=(a("96cf"),a("1da1")),n=a("5530"),l=a("333d"),o=(a("b775"),a("ed08")),u=a("2f62"),c=a("328c"),p=a("ad2b"),d=a("3266"),f=a("7562"),m=a("3cfb"),h=a("fd48"),v=a("3935"),b={props:["tapOutJsfDiaInfo"],computed:{diaVisible:{set:function(e){this.$emit("update:tapOutJsfDiaInfo",Object.assign({},this.tapOutJsfDiaInfo,{show:e}))},get:function(){return this.pShow&&!!this.curStep}},pShow:{get:function(){return this.tapOutJsfDiaInfo.show}}},watch:{pShow:{handler:function(e){e?this.checkJsfApiOfflineHaveHttp():this.applyerForm.applyerErp=""},immediate:!0}},data:function(){return{applyerForm:{applyerErp:""},curStep:"",applyerErpRule:{applyerErp:[{validator:function(e,t,a){t?t!==m.a.getters.user_pin?a():a(new Error("审批人不能为当前操作人本人")):a(new Error("请输入审批人ERP账号"))},trigger:["change","blure"]},{required:!0,trigger:["change","blure"]}]}}},methods:{handleDiaCancel:function(){this.$emit("update:tapOutJsfDiaInfo",Object.assign({},this.tapOutJsfDiaInfo,{show:!1}))},checkJsfApiOfflineHaveHttp:function(){var e=this,t=[{qualifiedName:this.tapOutJsfDiaInfo.rowInfo.qualifiedName}];h.a.HttpApiService.checkJsfApiOfflineHaveHttp(t).then((function(t){var a=t||{},i=a.code,r=a.data;2e4==+i&&(e.curStep=r?"step1":"step2")})).catch((function(t){e.$message.error(t),e.$emit("update:tapOutJsfDiaInfo",Object.assign({},e.tapOutJsfDiaInfo,{show:!1}))}))},offlineJsfApi:function(){var e=this;return new Promise((function(t){var a=[{qualifiedName:e.tapOutJsfDiaInfo.rowInfo.qualifiedName,approver:e.applyerForm.applyerErp}],i=!1;h.a.HttpApiService.offlineJsfApi(JSON.stringify(a)).then((function(a){var r=a||{},s=r.code,n=r.message;i=2e4==+s,2e4!=+s&&e.$message.error(n),t(i)})).catch((function(e){t(i)}))}))},handleDiaConfirm:function(e){var t=this;switch(e){case"step1":this.curStep="step2";break;case"step2":this.$refs.tapOutHttpApplyerErp.validate(function(){var e=Object(s.a)(Object(r.a)().mark((function e(a){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=8;break}return e.next=3,t.offlineJsfApi();case 3:e.sent&&(t.curStep="step3",t.$emit("queryApi")),e.next=9;break;case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());break;case"step3":this.handleDiaCancel()}}},components:{ErpPrincipal:v.a},name:"TapOutJsfDialog"},y=b,g=(a("eea0"),a("2877")),w=Object(g.a)(y,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{width:"530px",type:"text",title:"API下线申请","custom-class":"tap-out-http-dia",visible:e.diaVisible},on:{"update:visible":function(t){e.diaVisible=t}}},["step1"===e.curStep?a("div",{staticClass:"dia-content"},[a("p",[a("i",{staticClass:"el-icon-warning"}),a("span",{staticClass:"step1-title step-title"},[e._v("确认要下线此API吗？")])]),a("p",{staticClass:"step1-des"},[e._v(" 此JSF接口中的方法有对接方案、HTTP接口使用，如下线将会影响使用方更新JSF方法文档 ")])]):"step2"===e.curStep?a("div",{staticClass:"dia-content step2-content"},[a("p",{staticClass:"step-title"},[e._v("请填写审批人ERP账号")]),a("p",{},[e._v("审批通过后，API下线生效")]),a("div",{staticClass:"step2-form_content"},[a("el-form",{ref:"tapOutHttpApplyerErp",attrs:{model:e.applyerForm,rules:e.applyerErpRule}},[a("el-form-item",{staticClass:"step2-form-item_wrap",attrs:{prop:"applyerErp",label:"审批人ERP账号"}},[a("ErpPrincipal",{attrs:{formDataPrincipal:e.applyerForm.applyerErp,placeholder:"审批人可在京ME流程中心审批"},on:{"update:formDataPrincipal":function(t){return e.$set(e.applyerForm,"applyerErp",t)},"update:form-data-principal":function(t){return e.$set(e.applyerForm,"applyerErp",t)}}})],1)],1)],1)]):"step3"===e.curStep?a("div",{staticClass:"dia-content dia-content_success"},[a("i",{staticClass:"el-icon-success"}),a("p",{staticClass:"step3-title"},[e._v("提交成功")]),a("p",{staticClass:"step3-des"},[e._v("提醒审批人尽快审批吧，审批通过后API下线生效")])]):e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},["step1"===e.curStep?[a("el-button",{on:{click:e.handleDiaCancel}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleDiaConfirm("step1")}}},[e._v("下线")])]:e._e(),"step2"===e.curStep?[a("el-button",{on:{click:e.handleDiaCancel}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleDiaConfirm("step2")}}},[e._v("提交")])]:e._e(),"step3"===e.curStep?[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleDiaConfirm("step3")}}},[e._v("确定")])]:e._e()],2)])}),[],!1,null,"65c09a4a",null),S=w.exports,D={components:{Pagination:l.a,ErpPrincipal:v.a,TapOutJsfDialog:S},data:function(){return{env:"",tableDatas:[],httpTableDatas:[],type:1,listQuery:{searchKeyWord:"",total:0,pageNumb:1,pageSize:10,pageSizes:[10,20,40,60]},httpListQuery:{total:0,pageNumb:1,pageSize:10,pageSizes:[10,20,40,60]},loading:!0,loadingInstance:"",tapOutJsfDiaInfo:{show:!1,rowInfo:null},tapOutHttpDiaInfo:{show:!1,curStep:"step1",rowInfo:null,applyerFormValue:{applyerErp:""},tapOutHttpApplyerErpFormRule:{applyerErp:[{validator:function(e,t,a){t?t!==m.a.getters.user_pin?a():a(new Error("审批人不能为当前操作人本人")):a(new Error("请输入审批人ERP账号"))},trigger:["change","blure"]},{required:!0,trigger:["change","blure"]}]}}}},computed:Object(n.a)(Object(n.a)({},Object(u.b)(["user_pin"])),{},{tapOutBtnStatus:function(){return function(e){var t=e.isOnline,a=e.status;return{disabled:3==+a||9==+a||7==+a,visible:1==+t&&1==+a||3==+a||9==+a||7==+a||4==+a}}},jsfBtnStatus:function(){return function(e){var t={visible:!0,disabled:!1},a=e.isOnline,i=e.status;return 0==+a&&1==+i?t.visible=!1:1==+a&&1==+i||(3==+i||9==+i||7==+i?(t.visible=!0,t.disabled=!0):4==+i||6==+i&&(t.visible=!1)),{offline:t,edit:{visible:!0,disabled:!1}}}},searchInputPlaceholder:function(){return 1==+this.type?"请输入API名称、JSF接口名":2==+this.type?"请输入API名称、URI":void 0}}),filters:{parseTimefilter:function(e,t){return Object(o.c)(e,t)}},methods:{queryApiByCondition:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a,i,s,n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/ApiManagerService/queryApiByCondition",t=this.listQuery,a=t.pageSize,i=t.pageNumb,s=(s=this.listQuery.searchKeyWord).trim(),n=[{pageSize:a,pageNumb:i},{searchKeyWord:s,sceneType:1}],e.next=7,f.a.post("/ApiManagerService/queryApiByCondition",JSON.stringify(n));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),clstag:function(e,t){return Object(d.a)(e,t)},serializationTime:function(e){return p.a.timeInTable(e)},search:function(){1===this.type?this.queryApi():2===this.type&&this.queryHttpApi()},queryHttpApi:function(){var e=this,t=[{page:this.httpListQuery.pageNumb,pageSize:this.httpListQuery.pageSize,sord:"desc",sidx:"updateTime"},{queryLike:this.listQuery.searchKeyWord.trim(),sceneType:1}];Object(c.b)(t).then((function(t){e.httpListQuery.total=t.data.total,e.httpTableDatas=t.data.rows})).catch((function(e){}))},queryApi:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a,i,s,n=this;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.queryApiByCondition().catch((function(){throw n.loading=!1,new Error("queryApi queryApiByCondition")}));case 3:t=e.sent,a=t.data,i=a.total,s=a.list,this.listQuery.total=i,this.tableDatas=s||[],this.loading=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),paginationChange:function(e){this.listQuery.pageNumb=e.page,this.listQuery.pageSize=e.limit,this.queryApi()},paginationHttpChange:function(e){this.httpListQuery.pageNumb=e.page,this.httpListQuery.pageSize=e.limit,this.queryHttpApi()},rowClassName:function(e){var t=e.row,a=e.rowIndex;t.number=a+1},registerApi:function(){var e=this.$route.query;this.$router.push({path:"/apiManager/registerApi",query:e})},onSearchChange:function(){0===this.listQuery.searchKeyWord.trim().length&&(1===this.type?this.queryApi():2===this.type&&this.queryHttpApi())},handleTapOutJsf:function(e){this.tapOutJsfDiaInfo={show:!0,rowInfo:e}},handleTapOutHttp:function(e){var t=this,a=[{bizCode:"".concat(e.domainCode).concat(e.url)}];h.a.HttpApiService.queryIsCloudApiHaveCallCountByBizCode(JSON.stringify(a)).then((function(a){var i=a||{},r=i.code,s=i.data;2e4==+r&&(t.tapOutHttpDiaInfo.show=!0,t.tapOutHttpDiaInfo.rowInfo=e,t.tapOutHttpDiaInfo.curStep=s?"step1":"step2")})).catch((function(e){}))},handleDiaCancel:function(){this.tapOutHttpDiaInfo.show=!1},handleDiaConfirm:function(e){var t=this;switch(e){case"step1":this.tapOutHttpDiaInfo.curStep="step2";break;case"step2":this.$refs.tapOutHttpApplyerErp.validate(function(){var e=Object(s.a)(Object(r.a)().mark((function e(a){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=7;break}return e.next=3,t.offlineCloudApi();case 3:e.sent&&(t.tapOutHttpDiaInfo.curStep="step3",t.queryHttpApi()),e.next=8;break;case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());break;case"step3":this.handleDiaCancel(),this.tapOutHttpDiaInfo.applyerFormValue.applyerErp=""}},offlineCloudApi:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t=this;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var a=[t.tapOutHttpDiaInfo.rowInfo.id,t.tapOutHttpDiaInfo.applyerFormValue.applyerErp],i=!1;h.a.HttpApiService.offlineCloudApi(JSON.stringify(a)).then((function(t){var a=t.code;e(i=2e4==+a)})).catch((function(){e(i)}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},created:function(){this.env=window.env.baseEnv},watch:{$route:{handler:function(e){"http"===(e||{}).query.type?(this.type=2,this.queryHttpApi()):(this.type=1,this.queryApi())},immediate:!0}}},_=D,C=(a("bdd0"),Object(g.a)(_,i,[],!1,null,"430f423b",null)).exports,I=a("0bee"),T=(a("3b2b"),a("ac6a"),a("456d"),a("c5f6"),a("0e07")),k=a("d128"),x={name:"EditClusterDialog",props:{editClusterDialogVisible:{type:Boolean,required:!0},id:{type:Number,required:!0}},data:function(){var e=this;return{active:0,stepList:[{title:"填写基本信息"},{title:"添加IP端口"},{title:"设置超时时间"},{title:"创建成功"}],clusterBasicInfoData:{name:"",useType:null,type:null,desc:""},clusterBasicInfoRules:{name:[{required:!0,message:"请输入集群名称"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9]*$/,message:"请输入中文、英文字母或数字"},{min:2,max:20,message:"请输入2到20个字符"}],useType:[{required:!0,message:"请选择集群用途"}],type:[{required:!0,message:"请选择集群类型"}],desc:[{required:!0,message:"请描述集群的使用场景"}]},useTypeOptionList:[{value:1,label:"服务路由"}],typeOptionList:[{value:2,label:"HTTP服务"},{value:3,label:"HTTP流"}],addIpPortData:{cloudServerList:[{host:"",port:null,weight:1,isBackup:0,down:0,resolve:0}]},addIpPortRules:{host:[{validator:function(t,a,i,r){var s=Object.keys(r)[0],n=s.indexOf("[")+1,l=s.indexOf("]"),o=s.slice(n,l);if(0===e.addIpPortData.cloudServerList[o].resolve)if(""===a)i(new Error("请输入IP"));else{RegExp(/^((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)(\.((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)){3}$/).test(a)?i():i(new Error("请输入正确的IP"))}else if(1===e.addIpPortData.cloudServerList[o].resolve)if(""===a)i(new Error("请输入域名"));else{RegExp(/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/).test(a)?i():i(new Error("请输入正确的域名"))}else i(new Error("请选择IP/域名"))}}],port:[{required:!0,message:"请输入端口"},{pattern:/^[0-9]*$/,message:"请输入数字"}],weight:[{required:!0,message:"请输入权重"},{pattern:/^[0-9]*$/,message:"请输入数字"}]},cloudServerListColumnList:[{label:"IP/域名",prop:"host",width:"240"},{label:"端口",prop:"port"},{label:"权重",prop:"weight"},{label:"是否备用",prop:"isBackup"},{label:"是否停用",prop:"down"}],resolveOptionList:[{value:0,label:"IP"},{value:1,label:"域名"}],isBackupOptionList:[{value:0,label:"否"},{value:1,label:"是"}],downOptionList:[{value:0,label:"否"},{value:1,label:"是"}],setTheTimeoutData:{connectTimeout:500,readTimeout:5e3,sendTimeout:5e3,reliveTimeout:1e4},setTheTimeoutRules:{connectTimeout:[{required:!0,message:"请设置连接超时时间/ms"}],readTimeout:[{required:!0,message:"请设置读取超时时间/ms"}],sendTimeout:[{required:!0,message:"请设置发送超时时间/ms"}],reliveTimeout:[{required:!0,message:"请设置自动复活时间/ms"}]},setTheTimeoutList:[{label:"连接超时时间/ms",prop:"connectTimeout"},{label:"读取超时时间/ms",prop:"readTimeout"},{label:"发送超时时间/ms",prop:"sendTimeout"},{label:"自动复活时间/ms",prop:"reliveTimeout"}],nextStepLoading:!1}},computed:{computeNextStepText:function(){return 2===this.active?"保存":"下一步"}},methods:{queryCloudClusterDetails:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a,i=this;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.id,a={clusterId:t},k.a.queryCloudClusterDetails(a).then((function(e){i.clusterBasicInfoData.name=e.data.name,i.clusterBasicInfoData.useType=e.data.useType,i.clusterBasicInfoData.type=e.data.type,i.clusterBasicInfoData.desc=e.data.desc,e.data.cloudServerList.forEach((function(e){e.resolve?e.resolve=1:e.resolve=0,e.isBackup?e.isBackup=1:e.isBackup=0,e.down?e.down=1:e.down=0})),i.addIpPortData.cloudServerList=e.data.cloudServerList,i.setTheTimeoutData.connectTimeout=e.data.connectTimeout,i.setTheTimeoutData.readTimeout=e.data.readTimeout,i.setTheTimeoutData.sendTimeout=e.data.sendTimeout,i.setTheTimeoutData.reliveTimeout=e.data.reliveTimeout})).catch((function(e){i.loading=!1}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),cloudClusterUpdate:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a,i,s,n,l,o,u,c,p,d,f,m,h=this;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.id,a=this.clusterBasicInfoData,i=a.name,s=a.useType,n=a.type,l=a.desc,o=this.addIpPortData.cloudServerList,u=this.setTheTimeoutData,c=u.connectTimeout,p=u.sendTimeout,d=u.readTimeout,f=u.reliveTimeout,m={id:t,name:i,useType:s,type:n,desc:l,cloudServerList:o,connectTimeout:c,sendTimeout:p,readTimeout:d,reliveTimeout:f},e.next=7,T.a.cloudClusterUpdate(m).catch((function(e){var t=e.data.message;throw t&&h.$message.error(t),new Error(e)}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),judgeHostPlaceholder:function(e){return{0:"请输入IP",1:"请输入域名"}[this.addIpPortData.cloudServerList[e].resolve]},addRowData:function(){this.addIpPortData.cloudServerList.push({host:"",port:null,weight:1,isBackup:0,down:0,resolve:0})},removeRowData:function(e){this.addIpPortData.cloudServerList.splice(e,1)},backClusterList:function(){var e=this;["clusterBasicInfoData","addIpPortData","setTheTimeoutData"].forEach((function(t){e.$refs[t].resetFields()})),this.$emit("update:editClusterDialogVisible",!1),this.$emit("queryRefresh",!0)},backApiList:function(){this.$emit("update:editClusterDialogVisible",!1),this.$emit("tabsValue",!0)},dialogBeforeClose:function(){var e=this;["clusterBasicInfoData","addIpPortData","setTheTimeoutData"].forEach((function(t){e.$refs[t].resetFields()})),this.$emit("update:editClusterDialogVisible",!1),this.$emit("queryRefresh",!0)},nextStep:function(){var e=this;this.$refs[{0:"clusterBasicInfoData",1:"addIpPortData",2:"setTheTimeoutData"}[this.active]].validate(function(){var t=Object(s.a)(Object(r.a)().mark((function t(a){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=9;break}if(2!==e.active){t.next=5;break}return e.nextStepLoading=!0,t.next=5,e.cloudClusterUpdate().catch((function(t){e.nextStepLoading=!1;var a=t.data.message;throw a&&e.$message.error(a),new Error(t)}));case 5:e.active+=1,e.nextStepLoading=!1,t.next=10;break;case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},mounted:function(){this.editClusterDialogVisible&&this.queryCloudClusterDetails()}},P=x,O=(a("00d5"),Object(g.a)(P,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"create-cluster-dialog",attrs:{visible:e.editClusterDialogVisible,"close-on-click-modal":!1,title:"编辑集群",width:"800px"},on:{close:e.dialogBeforeClose}},[a("div",{staticClass:"create-cluster-dialog__content"},[a("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},e._l(e.stepList,(function(e,t){return a("el-step",{key:t,attrs:{title:e.title}})})),1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],ref:"clusterBasicInfoData",staticClass:"create-cluster-dialog__form",attrs:{model:e.clusterBasicInfoData,rules:e.clusterBasicInfoRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"集群名称",prop:"name"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入集群名称"},model:{value:e.clusterBasicInfoData.name,callback:function(t){e.$set(e.clusterBasicInfoData,"name","string"==typeof t?t.trim():t)},expression:"clusterBasicInfoData.name"}})],1),a("el-form-item",{attrs:{label:"集群用途",prop:"useType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择集群用途",disabled:""},model:{value:e.clusterBasicInfoData.useType,callback:function(t){e.$set(e.clusterBasicInfoData,"useType",t)},expression:"clusterBasicInfoData.useType"}},e._l(e.useTypeOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"集群类型",prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择集群类型",disabled:""},model:{value:e.clusterBasicInfoData.type,callback:function(t){e.$set(e.clusterBasicInfoData,"type",t)},expression:"clusterBasicInfoData.type"}},e._l(e.typeOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"集群描述",prop:"desc"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",placeholder:"请描述集群的使用场景"},model:{value:e.clusterBasicInfoData.desc,callback:function(t){e.$set(e.clusterBasicInfoData,"desc","string"==typeof t?t.trim():t)},expression:"clusterBasicInfoData.desc"}})],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],ref:"addIpPortData",staticClass:"create-cluster-dialog__second-form",attrs:{model:e.addIpPortData,rules:e.addIpPortRules}},[a("el-table",{attrs:{data:e.addIpPortData.cloudServerList,"max-height":"180"}},[e._l(e.cloudServerListColumnList,(function(t,i){return a("el-table-column",{key:i,attrs:{label:t.label,prop:t.prop,width:t.width},scopedSlots:e._u([{key:"default",fn:function(i){var r=i.$index;return["host"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].host",rules:e.addIpPortRules.host}},[a("div",{staticClass:"item-content"},[a("el-select",{staticStyle:{width:"40%"},model:{value:e.addIpPortData.cloudServerList[r].resolve,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"resolve",t)},expression:"addIpPortData.cloudServerList[$index].resolve"}},e._l(e.resolveOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:e.judgeHostPlaceholder(r)},model:{value:e.addIpPortData.cloudServerList[r].host,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"host","string"==typeof t?t.trim():t)},expression:"addIpPortData.cloudServerList[$index].host"}})],1)])]:"port"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].port",rules:e.addIpPortRules.port}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"端口"},model:{value:e.addIpPortData.cloudServerList[r].port,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"port",e._n(t))},expression:"addIpPortData.cloudServerList[$index].port"}})],1)]:"weight"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].weight",rules:e.addIpPortRules.weight}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"权重"},model:{value:e.addIpPortData.cloudServerList[r].weight,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"weight",e._n(t))},expression:"\n                    addIpPortData.cloudServerList[$index].weight\n                  "}})],1)]:"isBackup"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].isBackup",rules:e.addIpPortRules.isBackup}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.addIpPortData.cloudServerList[r].isBackup,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"isBackup",t)},expression:"addIpPortData.cloudServerList[$index].isBackup"}},e._l(e.isBackupOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]:"down"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].down",rules:e.addIpPortRules.isBackup}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.addIpPortData.cloudServerList[r].down,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"down",t)},expression:"addIpPortData.cloudServerList[$index].down"}},e._l(e.downOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]:e._e()]}}],null,!0)})})),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.$index;return[a("div",{staticClass:"icon-wrapper"},[i>0?a("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.removeRowData(i)}}}):e._e()])]}}])})],2),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{icon:"el-icon-plus",plain:""},on:{click:e.addRowData}},[e._v("添加")])],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active === 2"}],ref:"setTheTimeoutData",staticClass:"create-cluster-dialog__form",attrs:{model:e.setTheTimeoutData,rules:e.setTheTimeoutRules,"label-width":"140px"}},e._l(e.setTheTimeoutList,(function(t,i){return a("el-form-item",{key:i,attrs:{label:t.label,prop:t.prop}},[a("el-input-number",{attrs:{min:1,step:100,precision:0,"controls-position":"right"},model:{value:e.setTheTimeoutData[t.prop],callback:function(a){e.$set(e.setTheTimeoutData,t.prop,a)},expression:"setTheTimeoutData[item.prop]"}})],1)})),1),a("div",{directives:[{name:"show",rawName:"v-show",value:3===e.active,expression:"active === 3"}],staticClass:"create-success"},[a("i",{staticClass:"el-icon-success normalColor"}),a("p",{staticClass:"create-success__title"},[e._v("集群更新成功")]),a("p",{staticClass:"update_success_content"},[e._v(" 集群更新内容非即时生效，刷新缓存需要一定时间，99%的缓存刷新时间在1分钟内 ")])])],1),a("div",{staticClass:"create-cluster-dialog__footer",attrs:{slot:"footer"},slot:"footer"},[0===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v("下一步")])],1):1===e.active||2===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{on:{click:function(t){e.active-=1}}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary",loading:e.nextStepLoading},on:{click:e.nextStep}},[e._v(e._s(e.computeNextStepText))])],1):3===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{on:{click:e.backApiList}},[e._v("返回API列表")]),a("el-button",{attrs:{type:"primary"},on:{click:e.backClusterList}},[e._v("返回集群列表")])],1):e._e()])])}),[],!1,null,"8cd571d8",null)),L=O.exports,A={components:{Pagination:l.a,CreateClusterDialog:I.a,EditClusterDialog:L},data:function(){return{showPopover:!1,id:0,tableDatas:[],listQuery:{searchKeyWord:"",total:0,pageNumb:1,pageSize:10,pageSizes:[10,20,40,60]},loading:!0,loadingInstance:"",createClusterDialogVisible:!1,editClusterDialogVisible:!1}},filters:{parseTimefilter:function(e,t){return Object(o.c)(e,t)}},methods:{queryRefresh:function(e){e&&this.queryApi()},tabsValue:function(e){this.$emit("showApiList",e)},formatType:function(e){return{2:"HTTP服务",3:"HTTP流"}[e]||""},serializationTime:function(e){return p.a.timeInTable(e)},search:function(){this.queryApi()},queryApi:function(){var e=this,t=[{page:this.listQuery.pageNumb,pageSize:this.listQuery.pageSize,sord:"desc",sidx:"updateTime"},{name:this.listQuery.searchKeyWord.trim(),sceneType:1}];k.a.queryListPage(t).then((function(t){e.listQuery.total=t.data.total,e.tableDatas=t.data.rows,e.loading=!1})).catch((function(t){e.loading=!1}))},paginationChange:function(e){this.listQuery.pageNumb=e.page,this.listQuery.pageSize=e.limit,this.queryApi()},rowClassName:function(e){var t=e.row,a=e.rowIndex;t.number=a+1},onSearchChange:function(){0===this.listQuery.searchKeyWord.trim().length&&this.queryApi()},cancleEditCluster:function(e){this.$refs["popover-"+e.id].doClose()},confirmEditCluster:function(e){this.$refs["popover-"+e.id].doClose(),this.editCluster(e)},editCluster:function(e){this.editClusterDialogVisible=!0,this.id=e.id}},created:function(){this.queryApi(1,this.listQuery.limit)}},$=A,B=(a("5990"),Object(g.a)($,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-row",{staticClass:"filter-container"},[i("el-col",{attrs:{span:18}},[i("el-form",{staticStyle:{height:"45px"},attrs:{inline:!0,model:e.listQuery},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",[i("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"输入集群的中文名称"},on:{input:e.onSearchChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.listQuery.searchKeyWord,callback:function(t){e.$set(e.listQuery,"searchKeyWord",t)},expression:"listQuery.searchKeyWord"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")])],1)],1)],1),i("el-col",{attrs:{span:6}},[i("el-button",{staticStyle:{"margin-bottom":"5px",float:"right"},attrs:{type:"primary"},on:{click:function(t){e.createClusterDialogVisible=!0}}},[e._v("创建集群")])],1)],1),0===e.tableDatas.length?i("div",{staticClass:"noData"},[i("img",{attrs:{src:a("24ec")}}),i("p",[e._v("抱歉，没有查询到结果～")])]):e._e(),e.tableDatas.length>0?i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"my-table mb2",attrs:{data:e.tableDatas,"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading",meta:"x:37.0,y:57.0,width:901.0,height:216.0","row-class-name":e.rowClassName,align:"left"}},[i("template",{slot:"empty"},[i("div",[e._v("经查询，无符合搜索条件的结果")])]),i("el-table-column",{attrs:{label:"序号",prop:"number",width:"48px"}}),i("el-table-column",{attrs:{label:"集群名称",prop:"name","min-width":"30%"}}),i("el-table-column",{attrs:{label:"集群描述",prop:"desc","min-width":"40%"}}),i("el-table-column",{attrs:{label:"集群类型",prop:"type","min-width":"17%"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.formatType(t.row.type)))])]}}],null,!1,1947897636)}),i("el-table-column",{attrs:{label:"更新人",prop:"updateUser","min-width":"17.11%"}}),i("el-table-column",{attrs:{label:"更新时间",prop:"updateTime","min-width":"24.11%"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.serializationTime(a.updateTime)))])]}}],null,!1,1950294394)}),i("el-table-column",{attrs:{label:"操作","min-width":"9%"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.useFlag?i("el-popover",{ref:"popover-"+t.row.id,attrs:{placement:"top",width:"200",trigger:"click"}},[[i("p",[e._v("已有API使用此集群，是否继续？")]),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.cancleEditCluster(t.row)}}},[e._v("取消")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.confirmEditCluster(t.row)}}},[e._v("继续")])],1)],i("el-link",{attrs:{slot:"reference",type:"primary",underline:!1},slot:"reference"},[e._v("编辑")])],2):e._e(),t.row.useFlag?e._e():i("el-link",{attrs:{slot:"reference",type:"primary",underline:!1},on:{click:function(a){return e.editCluster(t.row)}},slot:"reference"},[e._v("编辑")])]}}],null,!1,1383256433)})],2):e._e(),i("el-row",[i("el-col",{attrs:{span:24}},[i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.listQuery.total,expression:"listQuery.total"}],staticStyle:{margin:"0px",float:"right"},attrs:{total:e.listQuery.total,pageSizes:e.listQuery.pageSizes,page:e.listQuery.pageNumb,limit:e.listQuery.pageSize},on:{"update:pageSizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page-sizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page":function(t){return e.$set(e.listQuery,"pageNumb",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.paginationChange}})],1)],1),i("CreateClusterDialog",{attrs:{createClusterDialogVisible:e.createClusterDialogVisible},on:{"update:createClusterDialogVisible":function(t){e.createClusterDialogVisible=t},"update:create-cluster-dialog-visible":function(t){e.createClusterDialogVisible=t},queryRefresh:e.queryRefresh}}),e.editClusterDialogVisible?i("EditClusterDialog",{attrs:{editClusterDialogVisible:e.editClusterDialogVisible,id:e.id},on:{"update:editClusterDialogVisible":function(t){e.editClusterDialogVisible=t},"update:edit-cluster-dialog-visible":function(t){e.editClusterDialogVisible=t},"update:id":function(t){e.id=t},queryRefresh:e.queryRefresh,tabsValue:e.tabsValue}}):e._e()],1)}),[],!1,null,"908086cc",null)),z=B.exports,q={components:{Pagination:l.a},data:function(){return{tableDatas:[],type:1,listQuery:{searchKeyWord:"",total:0,page:1,pageSize:10,pageSizes:[10,20,40,60]},loading:!0,loadingInstance:""}},filters:{parseTimefilter:function(e,t){return Object(o.c)(e,t)}},methods:{search:function(){this.queryApiGroup()},serializationTime:function(e){return p.a.timeInTable(e)},queryApiGroup:function(){var e=this,t=[{pageSize:this.listQuery.pageSize,page:this.listQuery.page},{queryLike:this.listQuery.searchKeyWord.trim(),sceneType:1}];f.a.post("/CloudDomainService/query",t).then((function(t){e.listQuery.total=t.data.total,e.tableDatas=t.data.rows,e.tableDatas||(e.tableDatas=[]),e.loading=!1})).catch((function(t){e.loading=!1}))},paginationChange:function(e){this.listQuery.page=e.page,this.listQuery.pageSize=e.limit,this.queryApiGroup()},rowClassName:function(e){var t=e.row,a=e.rowIndex;t.number=a+1},onSearchChange:function(){0===this.listQuery.searchKeyWord.trim().length&&this.queryApiGroup()},apiGroupDetail:function(e){this.$router.push({name:"ApiManagerApiGroupDetail",params:{id:e}})},createApiGroup:function(){this.$router.push({name:"ApiManagerCreateApiGroup"})}},created:function(){this.queryApiGroup()}},E=q,Q=(a("ae6c"),Object(g.a)(E,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-row",{staticClass:"filter-container"},[i("el-col",{attrs:{span:18}},[i("el-form",{staticStyle:{height:"45px"},attrs:{inline:!0,model:e.listQuery},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",[i("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入分组中文/英文名称"},on:{input:e.onSearchChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.listQuery.searchKeyWord,callback:function(t){e.$set(e.listQuery,"searchKeyWord",t)},expression:"listQuery.searchKeyWord"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")])],1)],1)],1),i("el-button",{staticClass:"filter-container-btn",attrs:{type:"primary"},on:{click:e.createApiGroup}},[e._v("创建API分组")])],1),0===e.tableDatas.length&&1===e.type?i("div",{staticClass:"noData"},[i("img",{attrs:{src:a("24ec")}}),i("p",[e._v("抱歉，没有查询到结果～")])]):e._e(),e.tableDatas.length>0?i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"my-table mb2",attrs:{data:e.tableDatas,"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading",meta:"x:37.0,y:57.0,width:901.0,height:216.0","row-class-name":e.rowClassName}},[i("template",{slot:"empty"},[i("div",[e._v("经查询，无符合搜索条件的结果")])]),i("el-table-column",{attrs:{label:"序号",prop:"number",width:"48px"}}),i("el-table-column",{attrs:{label:"分组中文名称",prop:"cnName",align:"left","min-width":"20%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"分组英文名称",prop:"code",align:"left","min-width":"20%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"分组内API的服务类型",prop:"type",align:"left","min-width":"12%","show-tooltip-when-overflow":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.type?i("span",[e._v("JSF")]):e._e(),2===t.row.type?i("span",[e._v("HTTP")]):e._e(),3===t.row.type?i("span",[e._v("HTTP流")]):e._e()]}}],null,!1,4117630751)}),i("el-table-column",{attrs:{label:"分组内API的发布范围",prop:"serviceType",align:"left","min-width":"12%","show-tooltip-when-overflow":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.serviceType?i("span",[e._v("内网")]):e._e(),2===t.row.serviceType?i("span",[e._v("公网")]):e._e()]}}],null,!1,2341310558)}),i("el-table-column",{attrs:{label:"分组状态",prop:"status","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(t){return[4===t.row.status?i("span",{staticClass:"normalColor"},[e._v("运行中")]):e._e(),1!==t.row.status&&3!==t.row.status||0!==t.row.isOnline?e._e():i("span",{staticClass:"initColor"},[e._v("初始化")]),1!==t.row.status&&3!==t.row.status||1!==t.row.isOnline?e._e():i("span",{staticClass:"updateColor"},[e._v("更新中")])]}}],null,!1,436403251)}),i("el-table-column",{attrs:{label:"更新人",prop:"updateUser",align:"left","min-width":"10%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"更新时间",prop:"updateTime","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.serializationTime(a.updateTime)))])]}}],null,!1,1950294394)}),i("el-table-column",{attrs:{label:"操作",prop:"id","min-width":"8%"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){return e.apiGroupDetail(t.row.id)}}},[e._v("管理")])]}}],null,!1,1522109833)})],2):e._e(),i("el-row",[i("el-col",{attrs:{span:24}},[i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.listQuery.total,expression:"listQuery.total"}],staticStyle:{margin:"0px",float:"right"},attrs:{total:e.listQuery.total,pageSizes:e.listQuery.pageSizes,page:e.listQuery.page,limit:e.listQuery.pageSize},on:{"update:pageSizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page-sizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.paginationChange}})],1)],1)],1)}),[],!1,null,"73016027",null)),j=Q.exports,N={name:"ApiPassbackList",components:{Pagination:a("1799").a},data:function(){return{loading:!0,tableData:[],tableList:[{prop:"name",label:"API名称","min-width":"15%"},{prop:"url",label:"URL","min-width":"25%"},{prop:"status",label:"状态","min-width":"10%"},{prop:"updateUser",label:"更新人","min-width":"15%"},{prop:"updateTime",label:"更新时间","min-width":"20%"}],searchKeyWord:"",total:0,page:1,pageSize:10,pageSizes:[10,20,40,60]}},methods:{serializationTime:function(e){return p.a.timeInTable(e)},queryOuterApiByCondition:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a,i,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.pageSize,a=this.page,i=this.searchKeyWord,s=[{pageSize:t,pageNumb:a},{searchKeyWord:i,sceneType:1}],e.next=4,h.a.ApiManagerService.queryOuterApiByCondition(s);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),loadTableData:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a,i,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.queryOuterApiByCondition().catch((function(){throw new Error("loadTableData queryOuterApiByCondition")}));case 3:t=e.sent,a=t.data,i=a.list,s=a.total,this.tableData=i||[],this.total=s||0,this.loading=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},created:function(){this.loadTableData()}},H=N,R=(a("30a5"),Object(g.a)(H,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"api-passback-list"},[i("el-form",{attrs:{inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",[i("el-input",{staticStyle:{width:"360px"},attrs:{placeholder:"输入API名称、URL"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadTableData(t)}},model:{value:e.searchKeyWord,callback:function(t){e.searchKeyWord="string"==typeof t?t.trim():t},expression:"searchKeyWord"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.loadTableData}},[e._v("查询")])],1),i("el-form-item",{staticStyle:{float:"right"}},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.push({name:"ApiManagerPassBackRegister"})}}},[e._v("注册API ")])],1)],1),e.tableData&&e.tableData.length>0?i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,align:"left"}},[i("template",{slot:"empty"},[i("div",[e._v("经查询，无符合搜索条件的结果")])]),i("el-table-column",{attrs:{label:"序号",type:"index",width:"48px"}}),e._l(e.tableList,(function(t){return i("el-table-column",{key:t.id,attrs:{prop:t.prop,label:t.label,"min-width":t["min-width"],formatter:t.formatter,"show-tooltip-when-overflow":!0},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return["status"===t.prop?i("div",[0==+r.isOnline&&1==+r.status?i("span",{staticClass:"status_init status"},[e._v(" 初始化 ")]):e._e(),1==+r.isOnline&&1==+r.status?i("span",{staticClass:"status_edit status"},[e._v(" 编辑中 ")]):e._e(),3==+r.status||9==+r.status||7==+r.status?i("span",{staticClass:"status_approve status"},[e._v(" 审批中 ")]):e._e(),4==+r.status?i("span",{staticClass:"status_released status"},[e._v(" 已发布 ")]):e._e(),6==+r.status?i("span",{staticClass:"status_offline status"},[e._v(" 已下线 ")]):e._e()]):"updateTime"===t.prop?i("span",[e._v(" "+e._s(e.serializationTime(r.updateTime))+" ")]):i("span",[e._v(e._s(r[t.prop]))])]}}],null,!0)})})),i("el-table-column",{attrs:{label:"操作","min-width":"8%"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row.id;return[i("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){return e.$router.push({name:"ApiManagerPassBackDetail",params:{id:a}})}}},[e._v("管理")])]}}],null,!1,2397084842)})],2):i("div",{staticClass:"api-passback-list__no-data"},[i("img",{attrs:{src:a("24ec")}}),i("p",[e._v("抱歉，没有查询到结果～")])]),e.total>0?i("Pagination",{attrs:{currentPage:e.page,pageSize:e.pageSize,pageSizes:e.pageSizes,total:e.total,reloadTableData:e.loadTableData},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"update:pageSizes":function(t){e.pageSizes=t},"update:page-sizes":function(t){e.pageSizes=t},"update:total":function(t){e.total=t}}}):e._e()],1)}),[],!1,null,"2a5ba575",null)),M=R.exports,V={components:{Pagination:l.a,ErpPrincipal:v.a},data:function(){return{env:"",tableDatas:[],httpTableDatas:[],listQuery:{searchKeyWord:"",total:0,pageNumb:1,pageSize:10,pageSizes:[10,20,40,60]},httpListQuery:{total:0,pageNumb:1,pageSize:10,pageSizes:[10,20,40,60]},loading:!0,loadingInstance:"",tapOutJsfDiaInfo:{show:!1,rowInfo:null},tapOutHttpDiaInfo:{show:!1,curStep:"step1",rowInfo:null,applyerFormValue:{applyerErp:""},tapOutHttpApplyerErpFormRule:{applyerErp:[{validator:function(e,t,a){t?t!==m.a.getters.user_pin?a():a(new Error("审批人不能为当前操作人本人")):a(new Error("请输入审批人ERP账号"))},trigger:["change","blure"]},{required:!0,trigger:["change","blure"]}]}}}},computed:Object(n.a)(Object(n.a)({},Object(u.b)(["user_pin"])),{},{tapOutBtnStatus:function(){return function(e){var t=e.isOnline,a=e.status;return{disabled:3==+a||9==+a||7==+a,visible:1==+t&&1==+a||3==+a||9==+a||7==+a||4==+a}}},jsfBtnStatus:function(){return function(e){var t={visible:!0,disabled:!1},a=e.isOnline,i=e.status;return 0==+a&&1==+i?t.visible=!1:1==+a&&1==+i||(3==+i||9==+i||7==+i?(t.visible=!0,t.disabled=!0):4==+i||6==+i&&(t.visible=!1)),{offline:t,edit:{visible:!0,disabled:!1}}}}}),filters:{parseTimefilter:function(e,t){return Object(o.c)(e,t)}},methods:{queryApiByCondition:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a,i,s,n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/ApiManagerService/queryApiByCondition",t=this.listQuery,a=t.pageSize,i=t.pageNumb,s=(s=this.listQuery.searchKeyWord).trim(),3,n=[{pageSize:a,pageNumb:i},{searchKeyWord:s,sceneType:3}],e.next=8,f.a.post("/ApiManagerService/queryApiByCondition",JSON.stringify(n));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),clstag:function(e,t){return Object(d.a)(e,t)},serializationTime:function(e){return p.a.timeInTable(e)},search:function(){this.queryHttpApi()},queryHttpApi:function(){var e=this,t=[{page:this.httpListQuery.pageNumb,pageSize:this.httpListQuery.pageSize,sord:"desc",sidx:"updateTime"},{queryLike:this.listQuery.searchKeyWord.trim(),sceneType:3}];Object(c.b)(t).then((function(t){e.httpListQuery.total=t.data.total,e.httpTableDatas=t.data.rows})).catch((function(e){}))},queryApi:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a,i,s,n=this;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.queryApiByCondition().catch((function(){throw n.loading=!1,new Error("queryApi queryApiByCondition")}));case 3:t=e.sent,a=t.data,i=a.total,s=a.list,this.listQuery.total=i,this.tableDatas=s||[],this.loading=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),paginationChange:function(e){this.listQuery.pageNumb=e.page,this.listQuery.pageSize=e.limit,this.queryApi()},paginationHttpChange:function(e){this.httpListQuery.pageNumb=e.page,this.httpListQuery.pageSize=e.limit,this.queryHttpApi()},rowClassName:function(e){var t=e.row,a=e.rowIndex;t.number=a+1},registerApi:function(){var e=this.$route.query;this.$router.push({path:"/apiManager/mobile/registerApi",query:e})},onSearchChange:function(){0===this.listQuery.searchKeyWord.trim().length&&this.queryHttpApi()},handleTapOutHttp:function(e){var t=this,a=[{bizCode:"".concat(e.domainCode).concat(e.url)}];h.a.HttpApiService.queryIsCloudApiHaveCallCountByBizCode(JSON.stringify(a)).then((function(a){var i=a||{},r=i.code,s=i.data;2e4==+r&&(t.tapOutHttpDiaInfo.show=!0,t.tapOutHttpDiaInfo.rowInfo=e,t.tapOutHttpDiaInfo.curStep=s?"step1":"step2")})).catch((function(e){}))},handleDiaCancel:function(){this.tapOutHttpDiaInfo.show=!1},handleDiaConfirm:function(e){var t=this;switch(e){case"step1":this.tapOutHttpDiaInfo.curStep="step2";break;case"step2":this.$refs.tapOutHttpApplyerErp.validate(function(){var e=Object(s.a)(Object(r.a)().mark((function e(a){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=7;break}return e.next=3,t.offlineCloudApi();case 3:e.sent&&(t.tapOutHttpDiaInfo.curStep="step3",t.queryHttpApi()),e.next=8;break;case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());break;case"step3":this.handleDiaCancel(),this.tapOutHttpDiaInfo.applyerFormValue.applyerErp=""}},offlineCloudApi:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t=this;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var a=[t.tapOutHttpDiaInfo.rowInfo.id,t.tapOutHttpDiaInfo.applyerFormValue.applyerErp],i=!1;h.a.HttpApiService.offlineCloudApi(JSON.stringify(a)).then((function(t){var a=t.code;e(i=2e4==+a)})).catch((function(){e(i)}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},created:function(){this.env=window.env.baseEnv,this.queryHttpApi()}},F=V,W=(a("e2f7"),Object(g.a)(F,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"api-list"},[i("el-row",{staticClass:"filter-container"},[i("el-col",{attrs:{span:18}},[i("el-form",{staticStyle:{height:"45px"},attrs:{inline:!0,model:e.listQuery},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",[i("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入API名称、URI",clstag:e.clstag("apiManager_1618992937884|2","")},on:{input:e.onSearchChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.listQuery.searchKeyWord,callback:function(t){e.$set(e.listQuery,"searchKeyWord",t)},expression:"listQuery.searchKeyWord"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")])],1)],1)],1),i("el-col",{attrs:{span:6}},[i("el-button",{staticStyle:{"margin-bottom":"5px",float:"right"},attrs:{type:"primary",icon:"el-icon-plus",clstag:e.clstag("apiManager_1618997499692|1","")},on:{click:e.registerApi}},[e._v("注册API")])],1)],1),0===e.httpTableDatas.length?i("div",{staticClass:"noData"},[i("img",{attrs:{src:a("24ec")}}),i("p",[e._v("抱歉，没有查询到结果～")])]):e._e(),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"},{name:"show",rawName:"v-show",value:e.httpTableDatas.length>0,expression:"httpTableDatas.length > 0"}],staticClass:"my-table mb2",attrs:{data:e.httpTableDatas,"row-class-name":e.rowClassName}},[i("template",{slot:"empty"},[i("div",[e._v("经查询，无符合搜索条件的结果")])]),i("el-table-column",{attrs:{label:"序号",prop:"number",width:"48px"}}),i("el-table-column",{attrs:{label:"API名称",prop:"name","min-width":"40%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"URI",prop:"url","min-width":"30%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"所属分组",prop:"domainName","min-width":"20.40%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"发布范围",prop:"serviceType","min-width":"17%"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(1==t.row.serviceType?"内网":""))]),i("span",[e._v(e._s(2==t.row.serviceType?"外网":""))])]}}])}),i("el-table-column",{attrs:{label:"状态",prop:"status","min-width":"13%"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==+t.row.isOnline&&1==+t.row.status?i("span",{staticClass:"status_init status"},[e._v(" 初始化 ")]):e._e(),1==+t.row.isOnline&&1==+t.row.status?i("span",{staticClass:"status_edit status"},[e._v(" 编辑中 ")]):e._e(),3==+t.row.status||9==+t.row.status||7==+t.row.status?i("span",{staticClass:"status_approve status"},[e._v(" 审批中 ")]):e._e(),4==+t.row.status?i("span",{staticClass:"status_released status"},[e._v(" 已发布 ")]):e._e(),6==+t.row.status?i("span",{staticClass:"status_offline status"},[e._v(" 已下线 ")]):e._e()]}}])}),i("el-table-column",{attrs:{label:"更新人",prop:"updateUser","min-width":"17.11%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"更新时间",prop:"updateTime","min-width":"24.11%"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.serializationTime(a.updateTime)))])]}}])}),i("el-table-column",{attrs:{label:"操作",prop:"id","min-width":"17%"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){return e.$router.push({name:"ApiManagerMobileDetail",params:{id:t.row.id}})}}},[e._v("管理")]),e.tapOutBtnStatus(t.row).visible?i("el-link",{staticClass:"tap-out-http",attrs:{type:"primary",disabled:e.tapOutBtnStatus(t.row).disabled,underline:!1},on:{click:function(a){return e.handleTapOutHttp(t.row)}}},[e._v("下线")]):e._e()]}}])})],2),i("el-row",[i("el-col",{attrs:{span:24}},[i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.httpListQuery.total,expression:"httpListQuery.total"}],staticStyle:{margin:"0px",float:"right"},attrs:{total:e.httpListQuery.total,pageSizes:e.httpListQuery.pageSizes,page:e.httpListQuery.pageNumb,limit:e.httpListQuery.pageSize},on:{"update:pageSizes":function(t){return e.$set(e.httpListQuery,"pageSizes",t)},"update:page-sizes":function(t){return e.$set(e.httpListQuery,"pageSizes",t)},"update:page":function(t){return e.$set(e.httpListQuery,"pageNumb",t)},"update:limit":function(t){return e.$set(e.httpListQuery,"pageSize",t)},pagination:e.paginationHttpChange}})],1)],1),i("el-dialog",{attrs:{width:"530px",type:"text",title:"API下线申请","custom-class":"tap-out-http-dia",visible:e.tapOutHttpDiaInfo.show},on:{"update:visible":function(t){return e.$set(e.tapOutHttpDiaInfo,"show",t)}}},["step1"===e.tapOutHttpDiaInfo.curStep?i("div",{staticClass:"dia-content"},[i("p",[i("i",{staticClass:"el-icon-warning"}),i("span",{staticClass:"step1-title step-title"},[e._v("确认要下线此API吗？")])]),i("p",{staticClass:"step1-des"},[e._v("此API在7天内有调用量，如果下线将会影响调用方")])]):"step2"===e.tapOutHttpDiaInfo.curStep?i("div",{staticClass:"dia-content"},[i("p",{staticClass:"step-title"},[e._v("请填写审批人ERP账号")]),i("p",{},[e._v("审批人不能是本人，审批通过后，API下线生效")]),i("div",{staticClass:"step2-form_content"},[i("el-form",{ref:"tapOutHttpApplyerErp",attrs:{model:e.tapOutHttpDiaInfo.applyerFormValue,rules:e.tapOutHttpDiaInfo.tapOutHttpApplyerErpFormRule}},[i("el-form-item",{staticClass:"step2-form-item_wrap",attrs:{prop:"applyerErp",label:"审批人ERP账号"}},[i("ErpPrincipal",{attrs:{formDataPrincipal:e.tapOutHttpDiaInfo.applyerFormValue.applyerErp,placeholder:"审批人可在京ME流程中心审批"},on:{"update:formDataPrincipal":function(t){return e.$set(e.tapOutHttpDiaInfo.applyerFormValue,"applyerErp",t)},"update:form-data-principal":function(t){return e.$set(e.tapOutHttpDiaInfo.applyerFormValue,"applyerErp",t)}}})],1)],1)],1)]):"step3"===e.tapOutHttpDiaInfo.curStep?i("div",{staticClass:"dia-content dia-content_success"},[i("i",{staticClass:"el-icon-success"}),i("p",{staticClass:"step3-title"},[e._v("提交成功")]),i("p",{staticClass:"step3-des"},[e._v("提醒审批人尽快审批吧，审批通过后API下线生效")])]):e._e(),i("div",{attrs:{slot:"footer"},slot:"footer"},["step1"===e.tapOutHttpDiaInfo.curStep?[i("el-button",{on:{click:e.handleDiaCancel}},[e._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleDiaConfirm("step1")}}},[e._v("下线")])]:e._e(),"step2"===e.tapOutHttpDiaInfo.curStep?[i("el-button",{on:{click:e.handleDiaCancel}},[e._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleDiaConfirm("step2")}}},[e._v("提交")])]:e._e(),"step3"===e.tapOutHttpDiaInfo.curStep?[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleDiaConfirm("step3")}}},[e._v("确定")])]:e._e()],2)])],1)}),[],!1,null,"94b2cf6c",null)),J=W.exports,G=a("9572"),K={name:"EditClusterDialog",props:{editClusterDialogVisible:{type:Boolean,required:!0},id:{type:Number,required:!0}},data:function(){var e=this;return{active:0,stepList:[{title:"填写基本信息"},{title:"添加IP端口"},{title:"设置超时时间"},{title:"创建成功"}],clusterBasicInfoData:{name:"",useType:null,type:null,desc:""},clusterBasicInfoRules:{name:[{required:!0,message:"请输入集群名称"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9]*$/,message:"请输入中文、英文字母或数字"},{min:2,max:20,message:"请输入2到20个字符"}],useType:[{required:!0,message:"请选择集群用途"}],type:[{required:!0,message:"请选择集群类型"}],desc:[{required:!0,message:"请描述集群的使用场景"}]},useTypeOptionList:[{value:1,label:"服务路由"}],typeOptionList:[{value:2,label:"HTTP服务"},{value:3,label:"HTTP流"}],addIpPortData:{cloudServerList:[{host:"",port:null,weight:1,isBackup:0,down:0,resolve:0}]},addIpPortRules:{host:[{validator:function(t,a,i,r){var s=Object.keys(r)[0],n=s.indexOf("[")+1,l=s.indexOf("]"),o=s.slice(n,l);if(0===e.addIpPortData.cloudServerList[o].resolve)if(""===a)i(new Error("请输入IP"));else{RegExp(/^((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)(\.((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)){3}$/).test(a)?i():i(new Error("请输入正确的IP"))}else if(1===e.addIpPortData.cloudServerList[o].resolve)if(""===a)i(new Error("请输入域名"));else{RegExp(/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/).test(a)?i():i(new Error("请输入正确的域名"))}else i(new Error("请选择IP/域名"))}}],port:[{required:!0,message:"请输入端口"},{pattern:/^[0-9]*$/,message:"请输入数字"}],weight:[{required:!0,message:"请输入权重"},{pattern:/^[0-9]*$/,message:"请输入数字"}]},cloudServerListColumnList:[{label:"IP/域名",prop:"host",width:"240"},{label:"端口",prop:"port"},{label:"权重",prop:"weight"},{label:"是否备用",prop:"isBackup"},{label:"是否停用",prop:"down"}],resolveOptionList:[{value:0,label:"IP"},{value:1,label:"域名"}],isBackupOptionList:[{value:0,label:"否"},{value:1,label:"是"}],downOptionList:[{value:0,label:"否"},{value:1,label:"是"}],setTheTimeoutData:{connectTimeout:500,readTimeout:5e3,sendTimeout:5e3,reliveTimeout:1e4},setTheTimeoutRules:{connectTimeout:[{required:!0,message:"请设置连接超时时间/ms"}],readTimeout:[{required:!0,message:"请设置读取超时时间/ms"}],sendTimeout:[{required:!0,message:"请设置发送超时时间/ms"}],reliveTimeout:[{required:!0,message:"请设置自动复活时间/ms"}]},setTheTimeoutList:[{label:"连接超时时间/ms",prop:"connectTimeout"},{label:"读取超时时间/ms",prop:"readTimeout"},{label:"发送超时时间/ms",prop:"sendTimeout"},{label:"自动复活时间/ms",prop:"reliveTimeout"}],nextStepLoading:!1}},computed:{computeNextStepText:function(){return 2===this.active?"保存":"下一步"}},methods:{queryCloudClusterDetails:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a,i=this;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.id,a={clusterId:t},k.a.queryCloudClusterDetails(a).then((function(e){i.clusterBasicInfoData.name=e.data.name,i.clusterBasicInfoData.useType=e.data.useType,i.clusterBasicInfoData.type=e.data.type,i.clusterBasicInfoData.desc=e.data.desc,e.data.cloudServerList.forEach((function(e){e.resolve?e.resolve=1:e.resolve=0,e.isBackup?e.isBackup=1:e.isBackup=0,e.down?e.down=1:e.down=0})),i.addIpPortData.cloudServerList=e.data.cloudServerList,i.setTheTimeoutData.connectTimeout=e.data.connectTimeout,i.setTheTimeoutData.readTimeout=e.data.readTimeout,i.setTheTimeoutData.sendTimeout=e.data.sendTimeout,i.setTheTimeoutData.reliveTimeout=e.data.reliveTimeout})).catch((function(e){i.loading=!1}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),cloudClusterUpdate:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a,i,s,n,l,o,u,c,p,d,f,m,h=this;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.id,a=this.clusterBasicInfoData,i=a.name,s=a.useType,n=a.type,l=a.desc,o=this.addIpPortData.cloudServerList,u=this.setTheTimeoutData,c=u.connectTimeout,p=u.sendTimeout,d=u.readTimeout,f=u.reliveTimeout,m={id:t,name:i,useType:s,type:n,desc:l,cloudServerList:o,connectTimeout:c,sendTimeout:p,readTimeout:d,reliveTimeout:f},e.next=7,T.a.cloudClusterUpdate(m).catch((function(e){var t=e.data.message;throw t&&h.$message.error(t),new Error(e)}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),judgeHostPlaceholder:function(e){return{0:"请输入IP",1:"请输入域名"}[this.addIpPortData.cloudServerList[e].resolve]},addRowData:function(){this.addIpPortData.cloudServerList.push({host:"",port:null,weight:1,isBackup:0,down:0,resolve:0})},removeRowData:function(e){this.addIpPortData.cloudServerList.splice(e,1)},backClusterList:function(){var e=this;["clusterBasicInfoData","addIpPortData","setTheTimeoutData"].forEach((function(t){e.$refs[t].resetFields()})),this.$emit("update:editClusterDialogVisible",!1),this.$emit("queryRefresh",!0)},backApiList:function(){this.$emit("update:editClusterDialogVisible",!1),this.$emit("tabsValue",!0)},dialogBeforeClose:function(){var e=this;["clusterBasicInfoData","addIpPortData","setTheTimeoutData"].forEach((function(t){e.$refs[t].resetFields()})),this.$emit("update:editClusterDialogVisible",!1),this.$emit("queryRefresh",!0)},nextStep:function(){var e=this;this.$refs[{0:"clusterBasicInfoData",1:"addIpPortData",2:"setTheTimeoutData"}[this.active]].validate(function(){var t=Object(s.a)(Object(r.a)().mark((function t(a){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=9;break}if(2!==e.active){t.next=5;break}return e.nextStepLoading=!0,t.next=5,e.cloudClusterUpdate().catch((function(t){e.nextStepLoading=!1;var a=t.data.message;throw a&&e.$message.error(a),new Error(t)}));case 5:e.active+=1,e.nextStepLoading=!1,t.next=10;break;case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},mounted:function(){this.editClusterDialogVisible&&this.queryCloudClusterDetails()}},U=K,Z=(a("3919"),Object(g.a)(U,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"create-cluster-dialog",attrs:{visible:e.editClusterDialogVisible,"close-on-click-modal":!1,title:"编辑集群",width:"800px"},on:{close:e.dialogBeforeClose}},[a("div",{staticClass:"create-cluster-dialog__content"},[a("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},e._l(e.stepList,(function(e,t){return a("el-step",{key:t,attrs:{title:e.title}})})),1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],ref:"clusterBasicInfoData",staticClass:"create-cluster-dialog__form",attrs:{model:e.clusterBasicInfoData,rules:e.clusterBasicInfoRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"集群名称",prop:"name"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入集群名称"},model:{value:e.clusterBasicInfoData.name,callback:function(t){e.$set(e.clusterBasicInfoData,"name","string"==typeof t?t.trim():t)},expression:"clusterBasicInfoData.name"}})],1),a("el-form-item",{attrs:{label:"集群用途",prop:"useType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择集群用途",disabled:""},model:{value:e.clusterBasicInfoData.useType,callback:function(t){e.$set(e.clusterBasicInfoData,"useType",t)},expression:"clusterBasicInfoData.useType"}},e._l(e.useTypeOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"集群类型",prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择集群类型",disabled:""},model:{value:e.clusterBasicInfoData.type,callback:function(t){e.$set(e.clusterBasicInfoData,"type",t)},expression:"clusterBasicInfoData.type"}},e._l(e.typeOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"集群描述",prop:"desc"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",placeholder:"请描述集群的使用场景"},model:{value:e.clusterBasicInfoData.desc,callback:function(t){e.$set(e.clusterBasicInfoData,"desc","string"==typeof t?t.trim():t)},expression:"clusterBasicInfoData.desc"}})],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],ref:"addIpPortData",staticClass:"create-cluster-dialog__second-form",attrs:{model:e.addIpPortData,rules:e.addIpPortRules}},[a("el-table",{attrs:{data:e.addIpPortData.cloudServerList,"max-height":"180"}},[e._l(e.cloudServerListColumnList,(function(t,i){return a("el-table-column",{key:i,attrs:{label:t.label,prop:t.prop,width:t.width},scopedSlots:e._u([{key:"default",fn:function(i){var r=i.$index;return["host"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].host",rules:e.addIpPortRules.host}},[a("div",{staticClass:"item-content"},[a("el-select",{staticStyle:{width:"40%"},model:{value:e.addIpPortData.cloudServerList[r].resolve,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"resolve",t)},expression:"addIpPortData.cloudServerList[$index].resolve"}},e._l(e.resolveOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:e.judgeHostPlaceholder(r)},model:{value:e.addIpPortData.cloudServerList[r].host,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"host","string"==typeof t?t.trim():t)},expression:"addIpPortData.cloudServerList[$index].host"}})],1)])]:"port"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].port",rules:e.addIpPortRules.port}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"端口"},model:{value:e.addIpPortData.cloudServerList[r].port,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"port",e._n(t))},expression:"addIpPortData.cloudServerList[$index].port"}})],1)]:"weight"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].weight",rules:e.addIpPortRules.weight}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"权重"},model:{value:e.addIpPortData.cloudServerList[r].weight,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"weight",e._n(t))},expression:"\n                    addIpPortData.cloudServerList[$index].weight\n                  "}})],1)]:"isBackup"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].isBackup",rules:e.addIpPortRules.isBackup}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.addIpPortData.cloudServerList[r].isBackup,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"isBackup",t)},expression:"addIpPortData.cloudServerList[$index].isBackup"}},e._l(e.isBackupOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]:"down"===t.prop?[a("el-form-item",{attrs:{prop:"cloudServerList["+r+"].down",rules:e.addIpPortRules.isBackup}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.addIpPortData.cloudServerList[r].down,callback:function(t){e.$set(e.addIpPortData.cloudServerList[r],"down",t)},expression:"addIpPortData.cloudServerList[$index].down"}},e._l(e.downOptionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]:e._e()]}}],null,!0)})})),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.$index;return[a("div",{staticClass:"icon-wrapper"},[i>0?a("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.removeRowData(i)}}}):e._e()])]}}])})],2),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{icon:"el-icon-plus",plain:""},on:{click:e.addRowData}},[e._v("添加")])],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active === 2"}],ref:"setTheTimeoutData",staticClass:"create-cluster-dialog__form",attrs:{model:e.setTheTimeoutData,rules:e.setTheTimeoutRules,"label-width":"140px"}},e._l(e.setTheTimeoutList,(function(t,i){return a("el-form-item",{key:i,attrs:{label:t.label,prop:t.prop}},[a("el-input-number",{attrs:{min:1,step:100,precision:0,"controls-position":"right"},model:{value:e.setTheTimeoutData[t.prop],callback:function(a){e.$set(e.setTheTimeoutData,t.prop,a)},expression:"setTheTimeoutData[item.prop]"}})],1)})),1),a("div",{directives:[{name:"show",rawName:"v-show",value:3===e.active,expression:"active === 3"}],staticClass:"create-success"},[a("i",{staticClass:"el-icon-success normalColor"}),a("p",{staticClass:"create-success__title"},[e._v("集群更新成功")]),a("p",{staticClass:"update_success_content"},[e._v(" 集群更新内容非即时生效，刷新缓存需要一定时间，99%的缓存刷新时间在1分钟内 ")])])],1),a("div",{staticClass:"create-cluster-dialog__footer",attrs:{slot:"footer"},slot:"footer"},[0===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v("下一步")])],1):1===e.active||2===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{on:{click:function(t){e.active-=1}}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary",loading:e.nextStepLoading},on:{click:e.nextStep}},[e._v(e._s(e.computeNextStepText))])],1):3===e.active?a("div",{staticClass:"button-wrapper"},[a("el-button",{on:{click:e.backApiList}},[e._v("返回API列表")]),a("el-button",{attrs:{type:"primary"},on:{click:e.backClusterList}},[e._v("返回集群列表")])],1):e._e()])])}),[],!1,null,"fe8172ee",null)),X=Z.exports,Y={components:{Pagination:l.a,CreateClusterDialog:G.a,EditClusterDialog:X},data:function(){return{showPopover:!1,id:0,tableDatas:[],listQuery:{searchKeyWord:"",total:0,pageNumb:1,pageSize:10,pageSizes:[10,20,40,60]},loading:!0,loadingInstance:"",createClusterDialogVisible:!1,editClusterDialogVisible:!1}},filters:{parseTimefilter:function(e,t){return Object(o.c)(e,t)}},methods:{queryRefresh:function(e){e&&this.queryApi()},tabsValue:function(e){this.$emit("showMobileApiList",e)},formatType:function(e){return{2:"HTTP服务",3:"HTTP流"}[e]||""},serializationTime:function(e){return p.a.timeInTable(e)},search:function(){this.queryApi()},queryApi:function(){var e=this,t=[{page:this.listQuery.pageNumb,pageSize:this.listQuery.pageSize,sord:"desc",sidx:"updateTime"},{name:this.listQuery.searchKeyWord.trim(),sceneType:3}];k.a.queryListPage(t).then((function(t){e.listQuery.total=t.data.total,e.tableDatas=t.data.rows,e.loading=!1})).catch((function(t){e.loading=!1}))},paginationChange:function(e){this.listQuery.pageNumb=e.page,this.listQuery.pageSize=e.limit,this.queryApi()},rowClassName:function(e){var t=e.row,a=e.rowIndex;t.number=a+1},onSearchChange:function(){0===this.listQuery.searchKeyWord.trim().length&&this.queryApi()},cancleEditCluster:function(e){this.$refs["popover-"+e.id].doClose()},confirmEditCluster:function(e){this.$refs["popover-"+e.id].doClose(),this.editCluster(e)},editCluster:function(e){this.editClusterDialogVisible=!0,this.id=e.id}},created:function(){this.queryApi(1,this.listQuery.limit)}},ee=Y,te=(a("d4eb"),Object(g.a)(ee,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-row",{staticClass:"filter-container"},[i("el-col",{attrs:{span:18}},[i("el-form",{staticStyle:{height:"45px"},attrs:{inline:!0,model:e.listQuery},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",[i("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"输入集群的中文名称"},on:{input:e.onSearchChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.listQuery.searchKeyWord,callback:function(t){e.$set(e.listQuery,"searchKeyWord",t)},expression:"listQuery.searchKeyWord"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")])],1)],1)],1),i("el-col",{attrs:{span:6}},[i("el-button",{staticStyle:{"margin-bottom":"5px",float:"right"},attrs:{type:"primary"},on:{click:function(t){e.createClusterDialogVisible=!0}}},[e._v("创建集群")])],1)],1),0===e.tableDatas.length?i("div",{staticClass:"noData"},[i("img",{attrs:{src:a("24ec")}}),i("p",[e._v("抱歉，没有查询到结果～")])]):e._e(),e.tableDatas.length>0?i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"my-table mb2",attrs:{data:e.tableDatas,"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading",meta:"x:37.0,y:57.0,width:901.0,height:216.0","row-class-name":e.rowClassName,align:"left"}},[i("template",{slot:"empty"},[i("div",[e._v("经查询，无符合搜索条件的结果")])]),i("el-table-column",{attrs:{label:"序号",prop:"number",width:"48px"}}),i("el-table-column",{attrs:{label:"集群名称",prop:"name","min-width":"30%"}}),i("el-table-column",{attrs:{label:"集群描述",prop:"desc","min-width":"40%"}}),i("el-table-column",{attrs:{label:"集群类型",prop:"type","min-width":"17%"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.formatType(t.row.type)))])]}}],null,!1,1947897636)}),i("el-table-column",{attrs:{label:"更新人",prop:"updateUser","min-width":"17.11%"}}),i("el-table-column",{attrs:{label:"更新时间",prop:"updateTime","min-width":"24.11%"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.serializationTime(a.updateTime)))])]}}],null,!1,1950294394)}),i("el-table-column",{attrs:{label:"操作","min-width":"9%"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.useFlag?i("el-popover",{ref:"popover-"+t.row.id,attrs:{placement:"top",width:"200",trigger:"click"}},[[i("p",[e._v("已有API使用此集群，是否继续？")]),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.cancleEditCluster(t.row)}}},[e._v("取消")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.confirmEditCluster(t.row)}}},[e._v("继续")])],1)],i("el-link",{attrs:{slot:"reference",type:"primary",underline:!1},slot:"reference"},[e._v("编辑")])],2):e._e(),t.row.useFlag?e._e():i("el-link",{attrs:{slot:"reference",type:"primary",underline:!1},on:{click:function(a){return e.editCluster(t.row)}},slot:"reference"},[e._v("编辑")])]}}],null,!1,1383256433)})],2):e._e(),i("el-row",[i("el-col",{attrs:{span:24}},[i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.listQuery.total,expression:"listQuery.total"}],staticStyle:{margin:"0px",float:"right"},attrs:{total:e.listQuery.total,pageSizes:e.listQuery.pageSizes,page:e.listQuery.pageNumb,limit:e.listQuery.pageSize},on:{"update:pageSizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page-sizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page":function(t){return e.$set(e.listQuery,"pageNumb",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.paginationChange}})],1)],1),i("CreateClusterDialog",{attrs:{createClusterDialogVisible:e.createClusterDialogVisible},on:{"update:createClusterDialogVisible":function(t){e.createClusterDialogVisible=t},"update:create-cluster-dialog-visible":function(t){e.createClusterDialogVisible=t},queryRefresh:e.queryRefresh}}),e.editClusterDialogVisible?i("EditClusterDialog",{attrs:{editClusterDialogVisible:e.editClusterDialogVisible,id:e.id},on:{"update:editClusterDialogVisible":function(t){e.editClusterDialogVisible=t},"update:edit-cluster-dialog-visible":function(t){e.editClusterDialogVisible=t},"update:id":function(t){e.id=t},queryRefresh:e.queryRefresh,tabsValue:e.tabsValue}}):e._e()],1)}),[],!1,null,"3aa6800b",null)),ae=te.exports,ie={components:{Pagination:l.a},data:function(){return{tableDatas:[],type:1,listQuery:{searchKeyWord:"",total:0,page:1,pageSize:10,pageSizes:[10,20,40,60]},loading:!0,loadingInstance:""}},filters:{parseTimefilter:function(e,t){return Object(o.c)(e,t)}},methods:{search:function(){this.queryApiGroup()},serializationTime:function(e){return p.a.timeInTable(e)},queryApiGroup:function(){var e=this,t=[{pageSize:this.listQuery.pageSize,page:this.listQuery.page},{queryLike:this.listQuery.searchKeyWord.trim(),sceneType:3}];f.a.post("/CloudDomainService/query",t).then((function(t){e.listQuery.total=t.data.total,e.tableDatas=t.data.rows,e.tableDatas||(e.tableDatas=[]),e.loading=!1})).catch((function(t){e.loading=!1}))},paginationChange:function(e){this.listQuery.page=e.page,this.listQuery.pageSize=e.limit,this.queryApiGroup()},rowClassName:function(e){var t=e.row,a=e.rowIndex;t.number=a+1},onSearchChange:function(){0===this.listQuery.searchKeyWord.trim().length&&this.queryApiGroup()},apiGroupDetail:function(e){this.$router.push({name:"ApiManagerMobileApiGroupDetail",params:{id:e}})},createApiGroup:function(){this.$router.push({name:"ApiManagerMobileCreateApiGroup"})}},created:function(){this.queryApiGroup()}},re=ie,se=(a("9afc"),Object(g.a)(re,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-row",{staticClass:"filter-container"},[i("el-col",{attrs:{span:18}},[i("el-form",{staticStyle:{height:"45px"},attrs:{inline:!0,model:e.listQuery},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",[i("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入分组中文/英文名称"},on:{input:e.onSearchChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.listQuery.searchKeyWord,callback:function(t){e.$set(e.listQuery,"searchKeyWord",t)},expression:"listQuery.searchKeyWord"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")])],1)],1)],1),i("el-button",{staticClass:"filter-container-btn",attrs:{type:"primary"},on:{click:e.createApiGroup}},[e._v("创建API分组")])],1),0===e.tableDatas.length&&1===e.type?i("div",{staticClass:"noData"},[i("img",{attrs:{src:a("24ec")}}),i("p",[e._v("抱歉，没有查询到结果～")])]):e._e(),e.tableDatas.length>0?i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"my-table mb2",attrs:{data:e.tableDatas,"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading",meta:"x:37.0,y:57.0,width:901.0,height:216.0","row-class-name":e.rowClassName}},[i("template",{slot:"empty"},[i("div",[e._v("经查询，无符合搜索条件的结果")])]),i("el-table-column",{attrs:{label:"序号",prop:"number",width:"48px"}}),i("el-table-column",{attrs:{label:"分组中文名称",prop:"cnName",align:"left","min-width":"20%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"分组英文名称",prop:"code",align:"left","min-width":"20%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"分组内API的服务类型",prop:"type",align:"left","min-width":"12%","show-tooltip-when-overflow":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.type?i("span",[e._v("JSF")]):e._e(),2===t.row.type?i("span",[e._v("HTTP")]):e._e(),3===t.row.type?i("span",[e._v("HTTP流")]):e._e()]}}],null,!1,4117630751)}),i("el-table-column",{attrs:{label:"分组内API的发布范围",prop:"serviceType",align:"left","min-width":"12%","show-tooltip-when-overflow":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.serviceType?i("span",[e._v("内网")]):e._e(),2===t.row.serviceType?i("span",[e._v("公网")]):e._e()]}}],null,!1,2341310558)}),i("el-table-column",{attrs:{label:"分组状态",prop:"status","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(t){return[4===t.row.status?i("span",{staticClass:"normalColor"},[e._v("运行中")]):e._e(),1!==t.row.status&&3!==t.row.status||0!==t.row.isOnline?e._e():i("span",{staticClass:"initColor"},[e._v("初始化")]),1!==t.row.status&&3!==t.row.status||1!==t.row.isOnline?e._e():i("span",{staticClass:"updateColor"},[e._v("更新中")])]}}],null,!1,436403251)}),i("el-table-column",{attrs:{label:"更新人",prop:"updateUser",align:"left","min-width":"10%","show-tooltip-when-overflow":!0}}),i("el-table-column",{attrs:{label:"更新时间",prop:"updateTime","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.serializationTime(a.updateTime)))])]}}],null,!1,1950294394)}),i("el-table-column",{attrs:{label:"操作",prop:"id","min-width":"9%"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){return e.apiGroupDetail(t.row.id)}}},[e._v("管理")])]}}],null,!1,1522109833)})],2):e._e(),i("el-row",[i("el-col",{attrs:{span:24}},[i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.listQuery.total,expression:"listQuery.total"}],staticStyle:{margin:"0px",float:"right"},attrs:{total:e.listQuery.total,pageSizes:e.listQuery.pageSizes,page:e.listQuery.page,limit:e.listQuery.pageSize},on:{"update:pageSizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page-sizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.paginationChange}})],1)],1)],1)}),[],!1,null,"787555e1",null)),ne=se.exports,le=a("547a"),oe=["/apiManager","ApiManagerPassBack","ApiManagerApiGroup","ApiManagerCluster"],ue=["ApiManagerMobile","ApiManagerMobileApiGroup","ApiManagerMobileCluster"],ce={jsf:"apiManager_jsf_1670468865530|1",http:"apiManager_http_1670470412984|1",ApiManagerPassBack:"apiManager_passBack_1670471262879|1"},pe={name:"ApiManager",mixins:[le.a],components:{ApiList:C,GroupList:j,ClusterList:z,PassBack:M,MobileGateWayApiList:J,MobileGateWayClusterList:ae,MobileGateWayGroupList:ne},data:function(){return{activeParentTab:"openingApi",activeOpeningItem:"",activeGatewayApiItem:""}},computed:{parentTabClassName:function(){var e=this;return function(t){return e.activeParentTab===t?"tab-content-active":"tab-content-off"}}},watch:{$route:{handler:function(e,t){if(e){var a=e||{},i=a.path,r=a.query,s=a.name;(oe.includes(s)||oe.includes(i))&&(this.activeParentTab="openingApi",this.activeOpeningItem=s,this.activeGatewayApiItem="","/apiManager"===i&&(r.type||this.$router.replace({path:"/apiManager",query:{type:"jsf"}}),this.activeOpeningItem=r.type),this.monitoring(this.activeOpeningItem)),(ue.includes(s)||ue.includes(i))&&(this.activeParentTab="gatewayApi",this.activeOpeningItem="",this.activeGatewayApiItem=s)}},immediate:!0}},methods:{showApiList:function(e){e&&(this.activeOpeningItem="jsf",this.$router.replace({path:"/apiManager",query:{type:"jsf"}}))},showMobileApiList:function(e){e&&this.$router.replace({path:"/apiManager/mobile"})},handleSwitchTab:function(e,t){var a=t.name,i=t.$attrs&&t.$attrs.query;"openingApi"===e&&"jsf"===a||"openingApi"===e&&"http"===a?this.$router.push({path:"/apiManager",query:i}):this.$router.push({name:a,query:i})},monitoring:function(e){var t=ce[e]||"";if(t){var a=document.createElement("div");a.setAttribute("clstag",this.clstag(t,"")),document.body.appendChild(a),a.click(),a.remove()}}},mounted:function(){}},de=pe,fe=(a("ac13"),Object(g.a)(de,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"api-manager"},[a("div",{staticClass:"tab-wrap"},[a("div",{class:["tab-openingapi","tab-content",e.parentTabClassName("openingApi")]},[a("p",{staticClass:"tab-content-title",on:{click:function(t){return e.handleSwitchTab("openingApi",{name:"jsf",$attrs:{query:{type:"jsf"}}})}}},[e._v(" 开放API "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"开放给外部客户、京东内部业务线使用的API；如：USF3.0系统以API形式开放权限管理的能力给京东集团的业务系统管理自身权限。",placement:"bottom-start"}},[a("p",{staticClass:"tab-tip-img"})])],1),a("el-tabs",{staticClass:"child-tabs",on:{"tab-click":function(t){return e.handleSwitchTab("openingApi",t)}},model:{value:e.activeOpeningItem,callback:function(t){e.activeOpeningItem=t},expression:"activeOpeningItem"}},[a("el-tab-pane",{attrs:{label:"JSF服务API",name:"jsf",query:{type:"jsf"}}}),a("el-tab-pane",{attrs:{label:"HTTP服务API",name:"http",query:{type:"http"}}}),a("el-tab-pane",{attrs:{label:"回传API",name:"ApiManagerPassBack"}}),a("el-tab-pane",{attrs:{label:"API分组",name:"ApiManagerApiGroup"}}),a("el-tab-pane",{attrs:{label:"集群",name:"ApiManagerCluster"}})],1)],1),a("div",{class:["tab-content","tab-gatewayapi",e.parentTabClassName("gatewayApi")]},[a("p",{staticClass:"tab-content-title",on:{click:function(t){return e.handleSwitchTab("gatewayApi",{name:"ApiManagerMobile"})}}},[e._v(" 移动端网关API "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"提供给移动端、PC端使用的API；如：发布API给京东快递小程序使用、发布API给站长工作台使用。",placement:"bottom-start"}},[a("p",{staticClass:"tab-tip-img"})])],1),a("el-tabs",{staticClass:"child-tabs",on:{"tab-click":function(t){return e.handleSwitchTab("gatewayApi",t)}},model:{value:e.activeGatewayApiItem,callback:function(t){e.activeGatewayApiItem=t},expression:"activeGatewayApiItem"}},[a("el-tab-pane",{attrs:{label:"HTTP协议API",name:"ApiManagerMobile"}}),a("el-tab-pane",{attrs:{label:"API分组",name:"ApiManagerMobileApiGroup"}}),a("el-tab-pane",{attrs:{label:"集群",name:"ApiManagerMobileCluster"}})],1)],1)]),a("div",{staticClass:"main-content"},["openingApi"===e.activeParentTab?["jsf"===e.activeOpeningItem||"http"===e.activeOpeningItem?a("ApiList"):"ApiManagerPassBack"===e.activeOpeningItem?a("PassBack"):"ApiManagerApiGroup"===e.activeOpeningItem?a("GroupList"):"ApiManagerCluster"===e.activeOpeningItem?a("ClusterList",{on:{showApiList:e.showApiList}}):e._e()]:"gatewayApi"===e.activeParentTab?["ApiManagerMobile"===e.activeGatewayApiItem?a("MobileGateWayApiList"):"ApiManagerMobileApiGroup"===e.activeGatewayApiItem?a("MobileGateWayGroupList"):"ApiManagerMobileCluster"===e.activeGatewayApiItem?a("MobileGateWayClusterList",{on:{showMobileApiList:e.showMobileApiList}}):e._e()]:e._e()],2)])}),[],!1,null,"260b0b18",null));t.default=fe.exports},ac13:function(e,t,a){"use strict";a("07d5")},ad2b:function(e,t,a){"use strict";a("28a5"),a("a481");var i={timeInTable:function(e){"string"==typeof e&&e.replace(".000+0000","");var t=new Date(e);return e?"".concat(t.toLocaleDateString().replaceAll("/","-")," ").concat(t.toTimeString().split(" ")[0]):""}};t.a=i},ae6c:function(e,t,a){"use strict";a("bb8a")},b4a3:function(e,t,a){"use strict";a("4475")},bb8a:function(e,t,a){},bdd0:function(e,t,a){"use strict";a("d0b0")},c0d4:function(e,t,a){},d0b0:function(e,t,a){},d128:function(e,t,a){"use strict";var i=a("7562"),r={queryListPage:function(e){return i.a.post("/ApiManagerService/queryCloudClusterListPage",e)},queryCloudClusterDetails:function(e){return i.a.post("/ApiManagerService/findCloudClusterDetail",[e])}};t.a=r},d2b9:function(e,t,a){},d4eb:function(e,t,a){"use strict";a("d2b9")},e2f7:function(e,t,a){"use strict";a("7ea6")},eea0:function(e,t,a){"use strict";a("77de")},f30d:function(e,t,a){}}]);