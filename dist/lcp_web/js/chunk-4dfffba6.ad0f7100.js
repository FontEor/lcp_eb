(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4dfffba6"],{"08c1":function(e,t,a){"use strict";a.r(t);var r=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"vbox"},[t("img",{attrs:{src:a("c48a")}})])}],n=a("5530"),i=a("c7eb"),s=(a("7f7f"),a("96cf"),a("1da1")),o=a("333d"),l=a("b775"),c=a("6f81"),u=a("ed08"),m=a("3266"),p=a("1a71"),d={name:"SoftwareSystem",components:{Pagination:o.a},data:function(){return{env:window.env.buildEnv,prodSearchForm:{queryName:""},createSystemDialogVisible:!1,createSystemForm:{name:"",code:"",description:"",scope:"",uatDomainName:"",domainName:"",secondaryDevelopment:"1"},createSystemFormList:[{label:"系统名称：",prop:"name",placeholder:"请输入系统名称，长度在 2 到 20 个字符"},{label:"系统编码：",prop:"code",placeholder:"请输入系统编码，长度在 2 到 20 个字符，仅支持英文字母、数字、下划线"},{label:"发布范围：",prop:"scope",placeholder:"请选择发布范围",optionList:[{label:"外网",value:1},{label:"内网",value:2}]},{label:"系统描述：",prop:"description",placeholder:"请输入系统描述，长度在 2 到 255 个字符"},{label:"预发环境域名：",prop:"uatDomainName",placeholder:"请输入域名，长度不超过3到45字符，请勿填写http://"},{label:"生产环境域名：",prop:"domainName",placeholder:"请输入域名，长度不超过3到45字符，请勿填写http://"},{label:"是否支持二次开发：",prop:"secondaryDevelopment",radioList:[{label:"1",text:"支持"},{label:"0",text:"不支持"}]}],rules:{name:[{required:!0,message:"请输入系统名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符"}],code:[{required:!0,message:"请输入系统编码",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符"},{pattern:p.a.engNumUnder,message:"只能输入字母、数字、下划线"}],scope:[{required:!0,message:"请选择当前软件系统发布范围"}],description:[{required:!0,message:"请输入系统描述",trigger:"blur"},{min:2,max:255,message:"长度在 2 到 255 个字符"}],uatDomainName:[{required:!0,message:"域名不能为空"},{pattern:/^[\w-]+(\.[\w-]+)+([\w.-]*[\w-])?$/,message:"只允许输入英文字母、数字、“-”和“.”，且“-”和“.”不能出现在开头或者结尾",trigger:"blur"},{min:3,max:45,message:"长度在 3 到 45 个字符"}],domainName:[{required:!0,message:"域名不能为空"},{pattern:/^[\w-]+(\.[\w-]+)+([\w.-]*[\w-])?$/,message:"只允许输入英文字母、数字、“-”和“.”，且“-”和“.”不能出现在开头或者结尾",trigger:"blur"},{min:3,max:45,message:"长度在 3 到 45 个字符"}],secondaryDevelopment:[{required:!0,message:"请选择是否支持二次开发"}]},listQuery:{total:1,pageNumb:1,pageSize:10,pageSizes:[10,20,40,60]},systemTableData:[],searchStatus:!1}},filters:{parseTimefilter:function(e,t){return e?Object(u.c)(e,t):""}},methods:{register:function(){var e=Object(s.a)(Object(i.a)().mark((function e(){var t,a,r,n,s,o,l,u,m,p,d=this;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.createSystemForm,a=t.name,r=t.code,n=t.description,s=t.scope,o=t.uatDomainName,l=t.domainName,u=t.secondaryDevelopment,"uat"!==(m=this.env)&&"prod"!==m&&(o=l),p={name:a,code:r,description:n,scope:s,uatDomainName:o,domainName:l,secondaryDevelopment:u},e.next=6,c.a.register(p).catch((function(e){var t=e.data.message;throw t&&d.$message.error(t),new Error("register")}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),clstag:function(e,t){return Object(m.a)(e,t)},queryProducts:function(){var e=this;Object(l.a)({url:"/product/list",method:"get",params:{pageSize:this.listQuery.pageSize,pageNumb:this.listQuery.pageNumb}}).then((function(t){e.listQuery.total=t.data.total,e.systemTableData=t.data.list})).catch((function(e){}))},paginationChange:function(e){this.listQuery.pageNumb=e.page,this.listQuery.pageSize=e.limit,0===this.prodSearchForm.queryName.trim().length?this.queryProducts():this.searchProducts()},searchProducts:function(){var e=this;this.searchStatus=!0,0===this.prodSearchForm.queryName.trim().length?this.queryProducts():Object(l.a)({url:"/product/search",method:"get",params:{pageSize:this.listQuery.pageSize,pageNumb:this.listQuery.pageNumb,name:this.prodSearchForm.queryName}}).then((function(t){e.listQuery.total=t.data.total,e.systemTableData=t.data.list})).catch((function(e){}))},newProd:function(){this.createSystemDialogVisible=!0},onSearch:function(){this.searchStatus=!0,this.queryProducts()},confirmCreateSystem:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(s.a)(Object(i.a)().mark((function e(a){var r,n,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=11;break}return e.next=3,t.register();case 3:r=e.sent,n=r.data.data,s=n,t.$message.success("软件系统添加成功"),t.createSystemForm.name="",t.createSystemForm.description="",t.createSystemDialogVisible=!1,t.$router.push({name:"SoftwareSystemDetail",params:{id:s}});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},prodManager:function(e){this.$router.push({name:"SoftwareSystemDetail",params:{id:e}})},onCancel:function(){this.$refs.createSystemForm.resetFields(),this.createSystemForm.name="",this.createSystemForm.code="",this.createSystemForm.description="",this.createSystemDialogVisible=!1},closeCreateSystemDialog:function(e){this.$refs.createSystemForm.resetFields(),this.createSystemForm.name="",this.createSystemForm.description="",this.createSystemForm.code="",e()}},created:function(){var e=this.env;"local"!==e&&"devtest"!==e&&"publictest"!==e||(this.createSystemFormList=this.createSystemFormList.map((function(e){return"domainName"===e.prop?Object(n.a)(Object(n.a)({},e),{},{label:"测试环境域名"}):e})).filter((function(e){return"uatDomainName"!==e.prop})))},mounted:function(){this.queryProducts()}},g=d,f=(a("7c24"),a("2877")),h=Object(f.a)(g,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"software-system"},[a("div",{staticClass:"app-container"},[e.systemTableData&&0===e.systemTableData.length&&!e.searchStatus?a("div",[e._m(0),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.newProd}},[e._v("开始创建第一个系统")])],1)]):a("div",[a("el-row",{staticClass:"filter-container"},[a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{inline:!0,model:e.prodSearchForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"搜索系统名称",clstag:e.clstag("productManager_1618992837521|1","")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchProducts(t)}},model:{value:e.prodSearchForm.queryName,callback:function(t){e.$set(e.prodSearchForm,"queryName",t)},expression:"prodSearchForm.queryName"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchProducts}},[e._v("查询")])],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-button",{staticStyle:{float:"right"},attrs:{icon:"el-icon-plus",type:"primary",clstag:e.clstag("productManager_1618992837521|2","")},on:{click:e.newProd}},[e._v("创建系统")])],1)],1),a("el-table",{attrs:{data:e.systemTableData}},[a("el-table-column",{attrs:{label:"序号",type:"index",align:"center",width:"64"}}),a("el-table-column",{attrs:{label:"系统名称",prop:"name",align:"center"}}),a("el-table-column",{attrs:{label:"状态",prop:"status",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"initColor"},[e._v(e._s(0==t.row.status?"初始化":""))]),a("span",{staticClass:"normalColor"},[e._v(e._s(1==t.row.status?"已发布":""))]),a("span",{staticClass:"updateColor"},[e._v(e._s(2==t.row.status?"编辑中":""))])]}}])}),a("el-table-column",{attrs:{label:"创建人",prop:"createUser",align:"center"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("parseTimefilter")(t.row.createTime,"{y}-{m}-{d} {h}:{i}")))])]}}])}),a("el-table-column",{attrs:{label:"操作",prop:"id",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.prodManager(t.row.id)}}},[e._v("管理")])]}}])})],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.listQuery.total,expression:"listQuery.total"}],staticStyle:{margin:"0px",float:"right"},attrs:{total:e.listQuery.total,pageSizes:e.listQuery.pageSizes,page:e.listQuery.pageNumb,limit:e.listQuery.pageSize},on:{"update:pageSizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page-sizes":function(t){return e.$set(e.listQuery,"pageSizes",t)},"update:page":function(t){return e.$set(e.listQuery,"pageNumb",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.paginationChange}})],1)],1)],1),a("el-dialog",{attrs:{title:"创建系统",width:"680px",top:"8vh",visible:e.createSystemDialogVisible,"before-close":e.closeCreateSystemDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.createSystemDialogVisible=t}}},[a("el-form",{ref:"createSystemForm",attrs:{model:e.createSystemForm,rules:e.rules,"label-width":"160px"}},e._l(e.createSystemFormList,(function(t,r){return a("el-form-item",{key:r,attrs:{label:t.label,prop:t.prop}},[t.optionList?[a("el-select",{attrs:{placeholder:t.placeholder},model:{value:e.createSystemForm[t.prop],callback:function(a){e.$set(e.createSystemForm,t.prop,a)},expression:"createSystemForm[item.prop]"}},e._l(t.optionList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]:t.radioList?[a("el-radio-group",{model:{value:e.createSystemForm[t.prop],callback:function(a){e.$set(e.createSystemForm,t.prop,a)},expression:"createSystemForm[item.prop]"}},e._l(t.radioList,(function(t){return a("el-radio",{key:t.label,attrs:{label:t.label}},[e._v(" "+e._s(t.text)+" ")])})),1)]:[a("el-input",{attrs:{placeholder:t.placeholder},model:{value:e.createSystemForm[t.prop],callback:function(a){e.$set(e.createSystemForm,t.prop,"string"==typeof a?a.trim():a)},expression:"createSystemForm[item.prop]"}})]],2)})),1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"default"},on:{click:e.onCancel}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.confirmCreateSystem("createSystemForm")}}},[e._v("确 定")])],1)],1)],1)])}),r,!1,null,"1a4e5a0d",null);t.default=h.exports},"1a71":function(e,t,a){"use strict";t.a={normal:/^[a-zA-Z0-9_\-.#\u4e00-\u9fa5]+$/,email:/^[a-zA-Z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,chinese:/^[\u4e00-\u9fa5]*$/,english:/^[a-zA-Z]*$/,url:/^(http|https)?(:\/\/)?[-A-Za-z0-9+&@#\/%?=~_|!:,.;]+[-A-Za-z0-9+&@#\/%=~_|]$/,engNumUnder:/^[a-zA-Z0-9_]*$/,mobile:/^1[3456789]{1}[0-9]{9}$/,zhEngNumUnder:/^[\u4E00-\u9FA5\uF900-\uFA2D0-9a-zA-Z_]+$/,enumValue:/^([\u4E00-\u9FA5\uF900-\uFA2D0-9a-zA-Z_]+\:[\u4E00-\u9FA5\uF900-\uFA2D0-9a-zA-Z_]+)(,[\u4E00-\u9FA5\uF900-\uFA2D0-9a-zA-Z_]+\:[\u4E00-\u9FA5\uF900-\uFA2D0-9a-zA-Z_]+)*$/,number:/^\d+.?\d{0,2}$/}},"333d":function(e,t,a){"use strict";a("c5f6"),Math.easeInOutQuad=function(e,t,a,r){return(e/=r/2)<1?a/2*e*e+t:-a/2*(--e*(e-2)-1)+t};var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};function n(e,t,a){var n=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,i=e-n,s=0;t=void 0===t?500:t;!function e(){s+=20,function(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}(Math.easeInOutQuad(s,n,i,t)),s<t?r(e):a&&"function"==typeof a&&a()}()}var i={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&n(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&n(0,800)}}},s=i,o=(a("8d79"),a("2877")),l=Object(o.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)}),[],!1,null,"0a87263c",null);t.a=l.exports},"753e":function(e,t,a){},"7c24":function(e,t,a){"use strict";a("acdc")},"8d79":function(e,t,a){"use strict";a("753e")},acdc:function(e,t,a){},c48a:function(e,t,a){e.exports=a.p+"img/createapp.16354947.png"}}]);