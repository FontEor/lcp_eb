(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-57681fe4"],{ae24:function(e,t,a){},c7de:function(e,t,a){"use strict";a("ae24")},e29b:function(e,t,a){"use strict";a.r(t);var n=(a("ac6a"),a("456d"),a("c7eb")),r=(a("96cf"),a("1da1")),s=a("fd48"),o={},i={data:function(){return{editing:!1,formData:{channel:"",topic:"",cnName:"",desc:"",tag:"",status:-1},formRules:{channel:[{required:!0,message:"请选择你在LSB系统创建的通道",trigger:"change"}],topic:[{required:!0,min:2,max:120,message:"长度为2-120个字符",trigger:"change"},{validator:function(e,t,a){/^[a-zA-Z][\w\-]*[a-zA-Z0-9]$/.test(t)?a():a(new Error("请输入英文、数字、-、_并且首字母必须为英文，尾字母必须为英文、数字"))},trigger:"change"}],cnName:[{required:!0,min:2,max:30,message:"请输入2-30个字符",trigger:"change"}],desc:[{required:!0,min:5,max:500,message:"请输入5-500个字符",trigger:"change"}],tag:[]},remoteInfo:{loading:!1,options:[]},tagsRemoteList:[]}},computed:{status:function(){return this.formData.status}},watch:{},mounted:function(){this.getFormOriginData()},methods:{handleEdit:function(){this.editing=!0,this.handleTagsRemote()},handleCancel:function(){this.editing=!1,this.formData=Object.assign({},o),this.clearFormValidate()},handleSave:function(){var e=this;this.$refs.form.validate(function(){var t=Object(r.a)(Object(n.a)().mark((function t(a){var r,i,c,l,m;return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=7;break}return r=[e.formData],t.next=4,s.a.messageAccessService.saveMessageBaseInfo(r);case 4:i=t.sent,l=(c=i||{}).code,m=c.data,2e4==+l&&(e.editing=!1,e.$emit("updateBasicInfo",m),o=Object.assign({},m));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getFormOriginData:function(){var e=Object(r.a)(Object(n.a)().mark((function e(){var t,a,r,i,c;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{topic:this.$route.params.topic}],e.next=3,s.a.messageAccessService.queryMessageBaseInfo(t);case 3:a=e.sent,i=(r=a||{}).code,c=r.data,2e4==+i&&(o=Object.assign({},c),this.formData=Object.assign({},c),this.clearFormValidate(),this.$emit("updateBasicInfo",c));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),clearFormValidate:function(){var e=this;!this.editing&&this.$nextTick((function(){e.$refs.form.clearValidate(Object.keys(e.formData))}))},handleRemote:function(){var e=Object(r.a)(Object(n.a)().mark((function e(t){var a,r,o,i,c,l=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.remoteInfo.loading=!0,a=[t.trim()],e.next=4,s.a.messageAccessService.queryLsbChannel(a).catch((function(e){l.remoteInfo.loading=!1}));case 4:r=e.sent,i=(o=r||{}).code,c=o.data,2e4==+i&&(this.remoteInfo={loading:!1,options:[c]||!1});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),handleTagsRemote:function(){var e=Object(r.a)(Object(n.a)().mark((function e(t){var a,r,o,i,c;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tagsRemoteList.length){e.next=2;break}return e.abrupt("return");case 2:return a=[{keyWords:t}],e.next=5,s.a.messageAccessService.queryApiCategory(a).catch((function(e){}));case 5:r=e.sent,i=(o=r||{}).code,c=o.data,2e4==+i&&(this.tagsRemoteList=c||[]);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},name:"messageManagerDetailBasicInfo"},c=i,l=(a("c7de"),a("2877")),m=Object(l.a)(c,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",class:["form-content",!e.editing&&"form-content-disabled"],attrs:{model:e.formData,rules:e.formRules,"label-position":"right","label-width":"70px",disabled:!e.editing}},[a("el-form-item",{attrs:{label:"通道",prop:"channel"}},[a("el-select",{staticClass:"select",attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"搜索你在LSB系统创建的通道","remote-method":e.handleRemote,loading:e.remoteInfo.loading,disabled:0!=+e.status},model:{value:e.formData.channel,callback:function(t){e.$set(e.formData,"channel",t)},expression:"formData.channel"}},e._l(e.remoteInfo.options,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"TOPIC",prop:"topic"}},[a("el-input",{attrs:{placeholder:"示例：eclp_back_po_lop_message",disabled:0!=+e.status,maxlength:"120","show-word-limit":""},model:{value:e.formData.topic,callback:function(t){e.$set(e.formData,"topic",t)},expression:"formData.topic"}})],1),a("el-form-item",{attrs:{label:"名称",prop:"cnName"}},[a("el-input",{attrs:{placeholder:"示例：五道口仓商品变更消息",maxlength:"30","show-word-limit":""},model:{value:e.formData.cnName,callback:function(t){e.$set(e.formData,"cnName",t)},expression:"formData.cnName"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",row:5,placeholder:"说明清楚哪些业务场景会触发系统发送该消息",maxlength:"500","show-word-limit":""},model:{value:e.formData.desc,callback:function(t){e.$set(e.formData,"desc",t)},expression:"formData.desc"}})],1),a("el-form-item",{attrs:{label:"标签",prop:"tag"}},[a("el-select",{staticClass:"select",attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"搜索、输入你想要为消息打的标签"},model:{value:e.formData.tag,callback:function(t){e.$set(e.formData,"tag",t)},expression:"formData.tag"}},e._l(e.tagsRemoteList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1)],1),a("div",{staticClass:"btn-content"},[e.editing?[a("el-button",{on:{click:e.handleCancel}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")])]:a("el-button",{attrs:{type:"primary",disabled:2==+e.status||4==+e.status},on:{click:e.handleEdit}},[e._v("编辑")])],2)],1)}),[],!1,null,"c2903a44",null);t.default=m.exports}}]);