(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7e8b5c94"],{"30aa":function(e,t,n){},"4ad0":function(e,t,n){"use strict";n.r(t);var a=(n("7f7f"),n("c7eb")),i=(n("96cf"),n("1da1")),s=n("6ea4"),r=n("96e0"),o={name:"CreateBizUnit",components:{Steps:s.a},data:function(){var e=this,t=this,n=function(){var t=Object(i.a)(Object(a.a)().mark((function t(n,i,s){var r;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.handleIsCodeExist(i).catch((function(e){throw s(new Error("对接方案编码校验异常")),new Error("validateCode, ".concat(e))}));case 2:r=t.sent,s(r?void 0:new Error("对接方案编码已存在"));case 4:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}();return{unitId:0,steps:{active:0,tiptitle:["填写基本信息","选择接口","创建SDK","完成"]},stepFormTitleTable:["请填写对接方案基本信息","选择您要开放的接口","创建SDK","接下来您可以"],stepFormTipTable:["此处填写的信息将直接展示给用户，以供用户了解和订阅对接方案，请认真填写","从API仓库中选择您要开放的接口，稍后可在对接方案管理-接口管理中继续添加接口","将一组接口打包生成SDK，以方便合作伙伴对接业务系统","补全对接方案相关信息后，即可发布该对接方案"],formRefTable:["formBasic",,],formBasic:{data:{checkList:[],businessTypeCode:"",solutionType:""},itemList:[{label:"对接方案编码",prop:"code",placeholder:"2-30个字符，由字母、下划线组成",hidden:!1},{label:"对接方案名称",prop:"name",placeholder:"2-30个字符",hidden:!1},{label:"方案类型",prop:"solutionType",placeholder:"2-30个字符",hidden:!1,componentType:"select"},{label:"所属分类",prop:"businessTypeCode",placeholder:"2-30个字符",hidden:!1,componentType:"select"},{label:"底层接口类型",prop:"domainType",componentType:"radio",hidden:!1},{label:"对接环境",prop:"checkList",componentType:"check",hidden:!0},{label:"对接方案简介",prop:"remark",type:"textarea",placeholder:"简述对接方案的主要服务内容，10-200个字符",rows:3,hidden:!1}],rules:{code:[{required:!0,message:"编码不能为空"},{min:2,max:30,message:"请输入2-30个字符"},{pattern:/^[A-Za-z_]*$/,message:"请输入英文字母、_"},{validator:n}],name:[{required:!0,message:"名称不能为空"},{min:2,max:30,message:"请输入2-30个字符"}],remark:[{required:!0,message:"简介不能为空"},{min:10,max:200,message:"请输入10-200个字符"}],domainType:[{required:!0,message:"服务类型不能为空"}],solutionType:[{required:!0,message:"方案类型不能为空"}],businessTypeCode:[{required:!0,message:"所属分类不能为空"}]}},formAccess:{data:{authProtocol:1,signAlg:1,signEntity:1},rules:{appType:[{required:!0,message:"应用类型不能为空"}]},accessTable:[,,{type:"oauth2"},,{type:"hmac"}]},cardList:[{title:"管理要开放的接口",tip:"继续增加要开放的接口，确保接口列表完整覆盖所有场景要用到的业务接口",buttonText:"去管理",goTo:function(){t.goToRoute("OpenBizOpenBizDetail","interfaceList")}},{title:"创建SDK",tip:"创建多语言SDK，开发者可通过SDK调用接口，对接更快",buttonText:"去创建",goTo:function(){t.goToRoute("OpenBizOpenBizDetail","sdkAdd")}}],formChooseEnv:{checkboxList:[{label:"test",text:"测试环境",envList:["local","test"],checked:!0},{label:"uat",text:"生产环境",envList:["prod"],checked:!0},{label:"prod",text:"生产环境",envList:["prod"],checked:!0}],envTable:{local:["test"],test:["test"],uat:["prod"],prod:["prod"]},env:window.env.baseEnv},solutionTypeOptionList:[],businessTypeCodeOptionList:[],confirmCreateLoading:!1,confirmCreateDebounceTimer:null}},computed:{computeStepFormTitle:function(){return this.stepFormTitleTable[this.steps.active]},computeStepFormTip:function(){return this.stepFormTipTable[this.steps.active]}},methods:{getDicts:function(){var e=Object(i.a)(Object(a.a)().mark((function e(){var t;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"solutionType",t={type:"solutionType"},e.next=4,r.a.lcpDict.getDicts(t).catch((function(e){throw new Error("getDicts, ".concat(e))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),isCodeExist:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={code:t},e.next=3,r.a.bizunit.isCodeExist(n).catch((function(e){throw new Error("isCodeExist, ".concat(e))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),findBySolutionType:function(){var e=Object(i.a)(Object(a.a)().mark((function e(){var t,n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.formBasic.data.solutionType,n={solutionType:t},e.next=4,r.a.businesstype.findBySolutionType(n).catch((function(e){throw new Error("findBySolutionType, ".concat(e))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),insertBizUnitPre:function(){var e=Object(i.a)(Object(a.a)().mark((function e(){var t,n,i,s,o,c,p,u;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.formBasic.data,n=t.code,i=t.name,s=t.solutionType,o=t.businessTypeCode,c=t.domainType,p=t.remark,u={code:n,name:i,remark:p,domainType:c,solutionType:s,businessTypeCode:o},e.next=4,r.a.bizunit.insertBizUnitPre(u).catch((function(e){throw new Error("insertBizUnitPre, ".concat(e))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleGetDicts:function(){var e=Object(i.a)(Object(a.a)().mark((function e(){var t,n,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDicts().catch((function(e){throw new Error("handleGetDicts, ".concat(e))}));case 2:t=e.sent,n=t.data,i=void 0===n?[]:n,this.solutionTypeOptionList=i instanceof Array?i:[];case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleIsCodeExist:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){var n,i,s;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.isCodeExist(t).catch((function(e){throw new Error("handleIsCodeExist, ".concat(e))}));case 2:return n=e.sent,i=n.data,s=void 0!==i&&i,e.abrupt("return",s||!1);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),handleFindBySolutionType:function(){var e=Object(i.a)(Object(a.a)().mark((function e(){var t,n,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findBySolutionType().catch((function(e){throw new Error("handleFindBySolutionType, ".concat(e))}));case 2:t=e.sent,n=t.data,i=void 0===n?[]:n,this.businessTypeCodeOptionList=i instanceof Array?i:[];case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleInsertBizUnitPre:function(){var e=Object(i.a)(Object(a.a)().mark((function e(){var t,n,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.insertBizUnitPre().catch((function(e){throw new Error("handleInsertBizUnitPre, ".concat(e))}));case 2:t=e.sent,n=t.data,i=void 0===n?0:n,this.unitId=i||0;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),previousStep:function(){this.steps.active-=1},nextStep:function(){var e=this;this.formRefTable[this.steps.active]?this.$refs[this.formRefTable[this.steps.active]].validate((function(t){if(!t)return!1;e.steps.active+=1})):this.steps.active+=1},onClickConfirmCreateButton:function(){var e=this;clearTimeout(this.confirmCreateDebounceTimer),this.confirmCreateDebounceTimer=setTimeout(Object(i.a)(Object(a.a)().mark((function t(){return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.confirmCreateLoading=!0,t.next=3,e.handleInsertBizUnitPre().catch((function(t){throw e.confirmCreateLoading=!1,new Error("onClickConfirmCreateButton, ".concat(t))}));case 3:e.nextStep(),e.confirmCreateLoading=!1;case 5:case"end":return t.stop()}}),t)}))),300)},goToRoute:function(e,t){var n=this.unitId;this.$router.push({name:e,params:{id:n},query:{tag:t}})},changeCheckShow:function(e){this.formBasic.itemList[3].hidden=!1,"uat"===this.formChooseEnv.env||"prod"===this.formChooseEnv.env?"2"==e?(this.formBasic.data.checkList=["prod","uat"],this.formChooseEnv.checkboxList[2].checked=!0):"1"==e&&(this.formBasic.data.checkList=this.formChooseEnv.envTable[this.formChooseEnv.env],this.formChooseEnv.checkboxList[2].checked=!1):this.formBasic.data.checkList=this.formChooseEnv.envTable[this.formChooseEnv.env]},onChangeSolutionType:function(){var e=Object(i.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.formBasic.data.businessTypeCode="",e.next=3,this.handleFindBySolutionType().catch((function(e){throw new Error("onChangeSolutionType, ".concat(e))}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},created:function(){var e=Object(i.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleGetDicts().catch((function(e){throw new Error("created, ".concat(e))}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},c=o,p=(n("4f04"),n("2877")),u=Object(p.a)(c,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"createBizUnit"},[a("div",{staticClass:"app-container"},[a("h2",{staticClass:"menuTitle"},[e._v("创建对接方案")]),a("Steps",{attrs:{active:e.steps.active,tiptitle:e.steps.tiptitle}}),a("div",{staticClass:"stepForm"},[a("h3",{staticClass:"stepFormTitle"},[e._v(e._s(e.computeStepFormTitle))]),a("p",{staticClass:"stepFormTip"},[e._v(e._s(e.computeStepFormTip))]),a("el-form",{directives:[{name:"show",rawName:"v-show",value:0===e.steps.active,expression:"steps.active === 0"}],ref:"formBasic",attrs:{model:e.formBasic.data,rules:e.formBasic.rules,"label-width":"190px"}},e._l(e.formBasic.itemList,(function(t,n){return a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!t.hidden,expression:"!item.hidden"}],key:n,attrs:{label:t.label,prop:t.prop}},["radio"===t.componentType?a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(t.label)+" "),a("el-tooltip",{attrs:{content:"注意此处指底层接口的服务类型，不是对接方案，对接方案对外统一为http服务",placement:"top"}},[a("i",{staticClass:"el-icon-help-solid"})])],1):e._e(),"radio"===t.componentType?a("el-radio-group",{on:{change:e.changeCheckShow},model:{value:e.formBasic.data.domainType,callback:function(t){e.$set(e.formBasic.data,"domainType",t)},expression:"formBasic.data.domainType"}},[a("el-radio",{attrs:{label:1}},[e._v("JSF服务")]),a("el-radio",{attrs:{label:2}},[e._v("HTTP服务")])],1):"check"===t.componentType?a("el-checkbox-group",{model:{value:e.formBasic.data.checkList,callback:function(t){e.$set(e.formBasic.data,"checkList",t)},expression:"formBasic.data.checkList"}},e._l(e.formChooseEnv.checkboxList,(function(t,n){return a("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:t.envList.includes(e.formChooseEnv.env),expression:"checkboxItem.envList.includes(formChooseEnv.env)"}],key:n,attrs:{label:t.label,disabled:t.checked}},[e._v(e._s(t.text))])})),1):"select"==t.componentType&&"solutionType"==t.prop?a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.onChangeSolutionType},model:{value:e.formBasic.data.solutionType,callback:function(t){e.$set(e.formBasic.data,"solutionType",t)},expression:"formBasic.data.solutionType"}},e._l(e.solutionTypeOptionList,(function(e){return a("el-option",{key:e.dictName,attrs:{label:e.dictValue,value:e.dictName}})})),1):"select"==t.componentType&&"businessTypeCode"==t.prop?a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formBasic.data.businessTypeCode,callback:function(t){e.$set(e.formBasic.data,"businessTypeCode",t)},expression:"formBasic.data.businessTypeCode"}},e._l(e.businessTypeCodeOptionList,(function(e){return a("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1):a("el-input",{attrs:{type:t.type,placeholder:t.placeholder,rows:t.rows,resize:"vertical"},model:{value:e.formBasic.data[t.prop],callback:function(n){e.$set(e.formBasic.data,t.prop,"string"==typeof n?n.trim():n)},expression:"formBasic.data[item.prop]"}})],1)})),1),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.steps.active,expression:"steps.active === 1"}],staticClass:"imageWrapper"},[a("el-image",{attrs:{src:n("a23e"),"preview-src-list":[n("a23e")],fit:"contain"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:2===e.steps.active,expression:"steps.active === 2"}],staticClass:"imageWrapper"},[a("el-image",{attrs:{src:n("d2a4"),"preview-src-list":[n("d2a4")],fit:"contain"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:3===e.steps.active,expression:"steps.active === 3"}],staticClass:"cardWrapper"},e._l(e.cardList,(function(t,n){return a("div",{key:n,staticClass:"card"},[a("p",{staticClass:"cardTitle"},[e._v(e._s(t.title))]),a("div",{staticClass:"cardContent"},[a("p",{staticClass:"cardTip"},[e._v(e._s(t.tip))]),a("el-button",{attrs:{type:"primary"},on:{click:t.goTo}},[e._v(e._s(t.buttonText))])],1)])})),0),e.steps.active<3?a("div",{staticClass:"buttonWrapper"},[e.steps.active>0?a("el-button",{on:{click:e.previousStep}},[e._v("上一步")]):e._e(),e.steps.active<2?a("el-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v("下一步")]):e._e(),2===e.steps.active?a("el-button",{attrs:{type:"primary",loading:e.confirmCreateLoading},on:{click:e.onClickConfirmCreateButton}},[e._v("确认创建")]):e._e()],1):e._e()],1)],1)])}),[],!1,null,"57f66ba7",null);t.default=u.exports},"4f04":function(e,t,n){"use strict";n("30aa")},"6ea4":function(e,t,n){"use strict";var a=(n("c5f6"),{name:"steps",props:{active:{required:!0,type:Number},title:{required:!1,type:String},tiptitle:{required:!0,type:Array}}}),i=(n("e7be"),n("2877")),s=Object(i.a)(a,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.title?n("h2",{staticClass:"com-tit-mini"},[e._v(e._s(e.title))]):e._e(),n("div",{staticClass:"my-step-bar"},[n("el-steps",{staticClass:"my-steps",attrs:{active:e.active,"finish-status":"success","align-center":""}},e._l(e.tiptitle,(function(e,t){return n("el-step",{key:t,attrs:{title:e}})})),1)],1)])}),[],!1,null,"16bbb482",null);t.a=s.exports},a23e:function(e,t,n){e.exports=n.p+"img/addInterface.de38d45c.gif"},d2a4:function(e,t,n){e.exports=n.p+"img/addSDK.9133a6c7.gif"},d6a5:function(e,t,n){},e7be:function(e,t,n){"use strict";n("d6a5")}}]);