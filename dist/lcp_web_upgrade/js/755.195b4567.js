(self["webpackChunklcp_web_upgrade"]=self["webpackChunklcp_web_upgrade"]||[]).push([[755],{8134:function(e,t,r){r(7658),
/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */
function(t,r){e.exports=r()}(0,(function(){return function(){var e={686:function(e,t,r){"use strict";r.d(t,{default:function(){return U}});var n=r(279),o=r.n(n),a=r(370),l=r.n(a),i=r(817),u=r.n(i);function c(e){try{return document.execCommand(e)}catch(t){return!1}}var s=function(e){var t=u()(e);return c("cut"),t},d=s;function p(e){var t="rtl"===document.documentElement.getAttribute("dir"),r=document.createElement("textarea");r.style.fontSize="12pt",r.style.border="0",r.style.padding="0",r.style.margin="0",r.style.position="absolute",r.style[t?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;return r.style.top="".concat(n,"px"),r.setAttribute("readonly",""),r.value=e,r}var m=function(e,t){var r=p(e);t.container.appendChild(r);var n=u()(r);return c("copy"),r.remove(),n},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body},r="";return"string"===typeof e?r=m(e,t):e instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(null===e||void 0===e?void 0:e.type)?r=m(e.value,t):(r=u()(e),c("copy")),r},v=f;function w(e){return w="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}var y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.action,r=void 0===t?"copy":t,n=e.container,o=e.target,a=e.text;if("copy"!==r&&"cut"!==r)throw new Error('Invalid "action" value, use either "copy" or "cut"');if(void 0!==o){if(!o||"object"!==w(o)||1!==o.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===r&&o.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===r&&(o.hasAttribute("readonly")||o.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}return a?v(a,{container:n}):o?"cut"===r?d(o):v(o,{container:n}):void 0},h=y;function b(e){return b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),e}function O(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}function W(e,t){return W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},W(e,t)}function C(e){var t=T();return function(){var r,n=S(e);if(t){var o=S(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return N(this,r)}}function N(e,t){return!t||"object"!==b(t)&&"function"!==typeof t?x(e):t}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function E(e,t){var r="data-clipboard-".concat(e);if(t.hasAttribute(r))return t.getAttribute(r)}var D=function(e){O(r,e);var t=C(r);function r(e,n){var o;return _(this,r),o=t.call(this),o.resolveOptions(n),o.listenClick(e),o}return k(r,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"===typeof e.action?e.action:this.defaultAction,this.target="function"===typeof e.target?e.target:this.defaultTarget,this.text="function"===typeof e.text?e.text:this.defaultText,this.container="object"===b(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=l()(e,"click",(function(e){return t.onClick(e)}))}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget,r=this.action(t)||"copy",n=h({action:r,container:this.container,target:this.target(t),text:this.text(t)});this.emit(n?"success":"error",{action:r,text:n,trigger:t,clearSelection:function(){t&&t.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(e){return E("action",e)}},{key:"defaultTarget",value:function(e){var t=E("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return E("text",e)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body};return v(e,t)}},{key:"cut",value:function(e){return d(e)}},{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"===typeof e?[e]:e,r=!!document.queryCommandSupported;return t.forEach((function(e){r=r&&!!document.queryCommandSupported(e)})),r}}]),r}(o()),U=D},828:function(e){var t=9;if("undefined"!==typeof Element&&!Element.prototype.matches){var r=Element.prototype;r.matches=r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector}function n(e,r){while(e&&e.nodeType!==t){if("function"===typeof e.matches&&e.matches(r))return e;e=e.parentNode}}e.exports=n},438:function(e,t,r){var n=r(828);function o(e,t,r,n,o){var a=l.apply(this,arguments);return e.addEventListener(r,a,o),{destroy:function(){e.removeEventListener(r,a,o)}}}function a(e,t,r,n,a){return"function"===typeof e.addEventListener?o.apply(null,arguments):"function"===typeof r?o.bind(null,document).apply(null,arguments):("string"===typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,(function(e){return o(e,t,r,n,a)})))}function l(e,t,r,o){return function(r){r.delegateTarget=n(r.target,t),r.delegateTarget&&o.call(e,r)}}e.exports=a},879:function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var r=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===r||"[object HTMLCollection]"===r)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"===typeof e||e instanceof String},t.fn=function(e){var t=Object.prototype.toString.call(e);return"[object Function]"===t}},370:function(e,t,r){var n=r(879),o=r(438);function a(e,t,r){if(!e&&!t&&!r)throw new Error("Missing required arguments");if(!n.string(t))throw new TypeError("Second argument must be a String");if(!n.fn(r))throw new TypeError("Third argument must be a Function");if(n.node(e))return l(e,t,r);if(n.nodeList(e))return i(e,t,r);if(n.string(e))return u(e,t,r);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function l(e,t,r){return e.addEventListener(t,r),{destroy:function(){e.removeEventListener(t,r)}}}function i(e,t,r){return Array.prototype.forEach.call(e,(function(e){e.addEventListener(t,r)})),{destroy:function(){Array.prototype.forEach.call(e,(function(e){e.removeEventListener(t,r)}))}}}function u(e,t,r){return o(document.body,e,t,r)}e.exports=a},817:function(e){function t(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var r=e.hasAttribute("readonly");r||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),r||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var n=window.getSelection(),o=document.createRange();o.selectNodeContents(e),n.removeAllRanges(),n.addRange(o),t=n.toString()}return t}e.exports=t},279:function(e){function t(){}t.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function o(){n.off(e,o),t.apply(r,arguments)}return o._=t,this.on(e,o,r)},emit:function(e){var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,o=r.length;for(n;n<o;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],o=[];if(n&&t)for(var a=0,l=n.length;a<l;a++)n[a].fn!==t&&n[a].fn._!==t&&o.push(n[a]);return o.length?r[e]=o:delete r[e],this}},e.exports=t,e.exports.TinyEmitter=t}},t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}return function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),r(686)}().default}))},5755:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ie}});r(7658);var n=r(3396),o=r(4870),a=r(2483),l=r(7139),i=r(8134),u=e=>{const t=void 0===(null===e||void 0===e?void 0:e.appendToBody)||e.appendToBody;return{toClipboard(e,r){return new Promise(((n,o)=>{const a=document.createElement("button"),l=new i(a,{text:()=>e,action:()=>"copy",container:void 0!==r?r:document.body});l.on("success",(e=>{l.destroy(),n(e)})),l.on("error",(e=>{l.destroy(),o(e)})),t&&document.body.appendChild(a),a.click(),t&&document.body.removeChild(a)}))}}},c=r(7178);const s=e=>((0,n.dD)("data-v-ed41b838"),e=e(),(0,n.Cn)(),e),d={class:"list-item__title"},p={class:"title__work-order-number"},m={class:"work-order-number__text"},f={class:"list-item__info"},v={class:"info__work-order-type-code"},w=s((()=>(0,n._)("label",null,"工单类型：",-1))),y={class:"info__create-time"},h=s((()=>(0,n._)("label",null,"提交时间：",-1))),b={class:"list-item__work-order-content"},_=s((()=>(0,n._)("label",null,"问题描述：",-1)));var g=(0,n.aZ)({__name:"index",props:{currentWorkOrderNumber:null,itemData:null},emits:["update:currentWorkOrderNumber"],setup(e,{expose:t,emit:r}){const a=e,{toClipboard:i}=u(),s=(new Map).set(1,"color-danger").set(2,"color-primary").set(3,"color-info"),g=(new Map).set(1,"待处理").set(2,"处理中").set(3,"已关闭"),k=(0,n.Fl)((()=>a.currentWorkOrderNumber===a.itemData.workOrderNumber?"is-active":"")),O=(0,n.Fl)((()=>s.get(a.itemData.status)||"")),W=(0,n.Fl)((()=>g.get(a.itemData.status)||"")),C=(e,t)=>a.currentWorkOrderNumber!==e&&t,N=()=>{r("update:currentWorkOrderNumber",a.itemData.workOrderNumber||"")};async function x(){await i(a.itemData.workOrderNumber||"").catch((e=>{throw console.error("onClickWorkOrderNumberDocumentCopyIcon"),e}));const e="复制成功！",t={message:e};c.z8.success(t)}return t({workOrderNumber:a.itemData.workOrderNumber,clickFirstListItem:N}),(e,t)=>{const r=(0,n.up)("DocumentCopy"),i=(0,n.up)("el-icon"),u=(0,n.up)("el-badge");return(0,n.wg)(),(0,n.iD)("li",{class:(0,l.C_)([(0,o.SU)(k),"list-item"]),ref:"listItemRef",onClick:N},[(0,n._)("div",d,[(0,n._)("div",p,[(0,n._)("p",m,(0,l.zw)(a.itemData.workOrderNumber),1),(0,n.Wm)(i,{size:14,color:"#666666",class:"work-order-number__document-copy",onClick:x},{default:(0,n.w5)((()=>[(0,n.Wm)(r)])),_:1})]),(0,n.Wm)(u,{"is-dot":C(a.itemData.workOrderNumber,a.itemData.haveUnreadMessages),class:"title__badge"},{default:(0,n.w5)((()=>[(0,n._)("p",{class:(0,l.C_)(["badge__status-text",(0,o.SU)(O)])},(0,l.zw)((0,o.SU)(W)),3)])),_:1},8,["is-dot"])]),(0,n._)("div",f,[(0,n._)("p",v,[w,(0,n._)("span",null,(0,l.zw)(a.itemData.workOrderTypeName),1)]),(0,n._)("p",y,[h,(0,n._)("span",null,(0,l.zw)(a.itemData.createTime),1)])]),(0,n._)("p",b,[_,(0,n._)("span",null,(0,l.zw)(a.itemData.workOrderContent),1)])],2)}}}),k=r(89);const O=(0,k.Z)(g,[["__scopeId","data-v-ed41b838"]]);var W=O,C=(0,n.aZ)({__name:"index",props:{currentWorkOrderNumber:null,data:null},emits:["update:currentWorkOrderNumber"],setup(e,{expose:t,emit:r}){const a=e,l=(0,o.iH)(),i=(0,o.iH)(),u=()=>{const e={top:0};l.value?.scrollTo(e)},c=()=>{if(i.value&&i.value.length>0){const[e]=a.data,t=i.value.find((t=>t.workOrderNumber===e.workOrderNumber));t?.clickFirstListItem()}};return t({scrollToTop:u,clickFirstListItem:c}),(t,o)=>{const u=(0,n.up)("el-empty");return e.data.length?((0,n.wg)(),(0,n.iD)("ul",{key:0,ref_key:"listRef",ref:l,class:"left-list"},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.data,(t=>((0,n.wg)(),(0,n.j4)(W,{key:t.workOrderNumber,"current-work-order-number":e.currentWorkOrderNumber,"item-data":t,ref_for:!0,ref_key:"listItemRef",ref:i,"onUpdate:currentWorkOrderNumber":o[0]||(o[0]=e=>r("update:currentWorkOrderNumber",e))},null,8,["current-work-order-number","item-data"])))),128))],512)):((0,n.wg)(),(0,n.j4)(u,{key:1,description:"暂无工单信息，可点击顶部按钮新建",class:"left-list"}))}}});const N=(0,k.Z)(C,[["__scopeId","data-v-500c89f5"]]);var x=N,T=r(9242),S=r(8137);const E=e=>((0,n.dD)("data-v-35f19a3c"),e=e(),(0,n.Cn)(),e),D={class:"item__content"},U={key:0,class:"item__attachment"},A=E((()=>(0,n._)("p",{class:"attachment__title"},"附件：",-1))),H={class:"attachment__file-list"},j={class:"file-list__item"},L={key:1,class:"item__content"},F={key:2,class:"item__content"},I={key:3,class:"item__content"},R=E((()=>(0,n._)("span",null,"以上是回复信息",-1))),q=E((()=>(0,n._)("div",{class:"card__title"},[(0,n._)("p",{class:"title__text"},"工单服务评价"),(0,n._)("p",{class:"tip__text"}," 请对本次工单服务进行评价，您的评价会帮助我们更好的为您服务！ ")],-1))),z=E((()=>(0,n._)("p",{class:"form__tip"},"您认为有哪些服务需要改进？",-1))),M={class:"card__button"};var B=(0,n.aZ)({__name:"index",props:{data:null,currentWorkOrderNumber:null,currentStatus:null,currentHaveEvaluate:{type:Boolean}},emits:["submit"],setup(e,{expose:t,emit:r}){const a=e,i=["#99A9BF","#F7BA2A","#FF9900"],u=(e,t,r)=>{if(!t)return r(new Error("请评价回复质量"));r()},c=(e,t,r)=>{if(!t)return r(new Error("请评价回复时效"));r()},s=(e,t,r)=>{if(!m.whetherToSolve||m.quality<4||m.aging<4){if(!t)return r(new Error("内容不能为空"));if(t.length<10)return r(new Error("请输入10-150个字符"))}r()},d=(0,o.iH)(),p=(0,o.iH)(),m=(0,o.qj)({whetherToSolve:!0,quality:5,aging:5,content:""}),f=(0,o.qj)({whetherToSolve:[{required:!0,message:"请选择是否解决"}],quality:[{validator:u}],aging:[{validator:c}],content:[{validator:s}]}),v=(0,o.iH)(0),w=(0,n.Fl)((()=>3===a.currentStatus&&!a.currentHaveEvaluate)),y=(0,n.Fl)((()=>0===v.value)),h=(0,n.Fl)((()=>1===v.value));function b(e,t,r){return e=2===r?"京东物流开放平台IT":e,`${e||""} ${t||""}`}(0,n.YP)((()=>a.currentWorkOrderNumber),(()=>{C()}));const _=async e=>await S.i.downloadFile({code:e}),g=async()=>{const e=a.currentWorkOrderNumber,t=m.whetherToSolve,r=m.quality,n=m.aging,o=m.content,l={whetherToSolve:t,quality:r,aging:n,content:o};return await S.i.evaluate({workOrderNumber:e,data:l})},k=async({attName:e,fileCode:t})=>{const r=await _(t).catch((e=>{throw console.error("handleDownloadWorkOrderFile"),e})),n=URL.createObjectURL(r),o=document.createElement("a"),a=e;"download"in o&&(o.download=a,o.href=n,document.body.appendChild(o),o.click(),document.body.removeChild(o))},O=async()=>{await g().catch((e=>{throw console.error("handleEvaluateWorkOrder"),e}))},W=()=>{const e={top:999999};d.value?.scrollTo(e)},C=()=>{v.value=0,p.value?.resetFields()},N=async({attName:e,fileCode:t})=>{await k({attName:e,fileCode:t}).catch((e=>{}))},x=async()=>{await(p.value?.validate().then((async()=>{await O().catch((e=>{throw console.error("onClickSubmitButton"),e})),C(),v.value=1,r("submit",!1)})).catch((()=>{})))};return t({scrollToBottom:W}),(e,t)=>{const r=(0,n.up)("Paperclip"),u=(0,n.up)("el-icon"),c=(0,n.up)("el-link"),s=(0,n.up)("el-card"),v=(0,n.up)("el-timeline-item"),_=(0,n.up)("el-timeline"),g=(0,n.up)("el-divider"),k=(0,n.up)("el-radio"),O=(0,n.up)("el-radio-group"),W=(0,n.up)("el-form-item"),C=(0,n.up)("el-rate"),S=(0,n.up)("el-input"),E=(0,n.up)("el-form"),B=(0,n.up)("el-button"),P=(0,n.up)("el-result");return(0,n.wg)(),(0,n.iD)("article",{ref_key:"rightDetailListRef",ref:d,class:"right-detail-list"},[(0,n.Wm)(_,{class:"right-detail-list__timeline"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.data,((e,t)=>((0,n.wg)(),(0,n.j4)(v,{key:t,timestamp:b(e.createUser,e.createTime,e.directType),placement:"top",class:"timeline__item"},{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n._)("p",D,(0,l.zw)(e.workOrderContent),1),e.appendices&&e.appendices.length>0?((0,n.wg)(),(0,n.iD)("div",U,[A,(0,n._)("div",H,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.appendices,(({attName:e,fileCode:t})=>((0,n.wg)(),(0,n.iD)("p",j,[(0,n.Wm)(c,{underline:!1,type:"primary",onClick:r=>N({attName:e,fileCode:t})},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{size:14,color:"#666666",class:"item__paperclip"},{default:(0,n.w5)((()=>[(0,n.Wm)(r)])),_:1}),(0,n._)("span",null,(0,l.zw)(e),1)])),_:2},1032,["onClick"])])))),256))])])):(0,n.kq)("",!0),e.appKey?((0,n.wg)(),(0,n.iD)("p",L," APPKEY："+(0,l.zw)(e.appKey),1)):(0,n.kq)("",!0),e.orderNumberInfo?((0,n.wg)(),(0,n.iD)("p",F," 单号信息："+(0,l.zw)(e.orderNumberInfo),1)):(0,n.kq)("",!0),e.msgApiInfo?((0,n.wg)(),(0,n.iD)("p",I," API/消息："+(0,l.zw)(e.msgApiInfo),1)):(0,n.kq)("",!0)])),_:2},1024)])),_:2},1032,["timestamp"])))),128))])),_:1}),(0,o.SU)(w)?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Wm)(g,{class:"right-detail-list__divider"},{default:(0,n.w5)((()=>[R])),_:1}),(0,n.wy)((0,n.Wm)(s,{class:"right-detail-list__card"},{default:(0,n.w5)((()=>[q,(0,n.Wm)(E,{model:m,rules:f,"hide-required-asterisk":"","label-width":"120px","label-position":"left",ref_key:"formRef",ref:p,class:"card__form"},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{label:"是否解决",prop:"whetherToSolve"},{default:(0,n.w5)((()=>[(0,n.Wm)(O,{modelValue:m.whetherToSolve,"onUpdate:modelValue":t[0]||(t[0]=e=>m.whetherToSolve=e)},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{label:!0},{default:(0,n.w5)((()=>[(0,n.Uk)("已解决")])),_:1}),(0,n.Wm)(k,{label:!1},{default:(0,n.w5)((()=>[(0,n.Uk)("未解决")])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,n.Wm)(W,{label:"回复质量",prop:"quality"},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{modelValue:m.quality,"onUpdate:modelValue":t[1]||(t[1]=e=>m.quality=e),colors:i,clearable:""},null,8,["modelValue"])])),_:1}),(0,n.Wm)(W,{label:"回复时效",prop:"aging"},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{modelValue:m.aging,"onUpdate:modelValue":t[2]||(t[2]=e=>m.aging=e),colors:i,clearable:""},null,8,["modelValue"])])),_:1}),z,(0,n.Wm)(W,{"label-width":"0",prop:"content"},{default:(0,n.w5)((()=>[(0,n.Wm)(S,{modelValue:m.content,"onUpdate:modelValue":t[3]||(t[3]=e=>m.content=e),rows:3,type:"textarea",placeholder:"聆听您的感受与建议",maxlength:"150",resize:"none","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),(0,n._)("div",M,[(0,n.Wm)(B,{type:"primary",onClick:x},{default:(0,n.w5)((()=>[(0,n.Uk)("提交")])),_:1})])])),_:1},512),[[T.F8,(0,o.SU)(y)]]),(0,n.wy)((0,n.Wm)(s,{class:"right-detail-list__card"},{default:(0,n.w5)((()=>[(0,n.Wm)(P,{icon:"success",title:"评价成功","sub-title":"已经收到您的反馈，我们将继续努力！"})])),_:1},512),[[T.F8,(0,o.SU)(h)]])],64)):(0,n.kq)("",!0)],512)}}});const P=(0,k.Z)(B,[["__scopeId","data-v-35f19a3c"]]);var V=P,Z=r(2655);const Y=e=>((0,n.dD)("data-v-40ad3250"),e=e(),(0,n.Cn)(),e),K={class:"right-detail-append"},$={class:"upload__button"},Q=Y((()=>(0,n._)("p",{class:"el-upload__tip"}," 附件支持txt、pdf、jpg、jpeg、png格式，单个文件大小不超过10MB。 ",-1))),X={class:"right-detail-append__button-list"};var G=(0,n.aZ)({__name:"index",props:{currentWorkOrderNumber:null},emits:["submit"],setup(e,{emit:t}){const r=e,a=(0,o.iH)(),l=(0,o.qj)({workOrderContent:"",appendices:[]}),i=(0,o.qj)({workOrderContent:[{required:!0,message:"请输入内容"}],appendices:[]}),u=(0,o.iH)(),s=(0,o.iH)([]),d=(0,o.iH)(!1),p=(0,o.iH)();(0,n.YP)((()=>r.currentWorkOrderNumber),(()=>{b()}));const m=async e=>await S.i.uploadFile(e),f=async()=>{const e=r.currentWorkOrderNumber,t=l.workOrderContent,n=l.appendices,o={workOrderNumber:e,workOrderContent:t,appendices:n};return await S.i.append(o)},v=async()=>{const e=r.currentWorkOrderNumber;return await S.i.close({workOrderNumber:e})},w=async e=>{const{file:t}=e,r=new FormData;r.append("file",t);const{code:n,name:o}=await m(r).catch((e=>{throw console.error("handleUploadWorkOrderFile"),e}));return{fileCode:n,attName:o}},y=async()=>{await f().catch((e=>{throw console.error("handleAppendWorkOrder"),e}))},h=async()=>{await v().catch((e=>{throw console.error("handleCloseWorkOrder"),e}))},b=()=>{a.value?.resetFields(),u.value?.clearFiles(),l.appendices=[]},_=e=>{const t=e.size/1024/1024<10;if(!t)return c.z8.error("上传文件大小不能超过 10MB!"),!1;let r=e.name.lastIndexOf("."),n=e.name.substr(r+1,e.name.length);return-1!==["txt","pdf","jpg","jpeg","png"].indexOf(n.toLowerCase())||(c.z8.error("请上传txt、pdf、jpg、jpeg、png格式的附件！"),!1)},g=(e,t,r)=>{l.appendices=r.map((e=>e.response))},k=async()=>{await Z.T.confirm("关闭工单后此工单将不会再收到回复，是否继续关闭？","是否关闭工单？",{confirmButtonText:"确认关闭",cancelButtonText:"取消"}).then((async()=>{await h().catch((e=>{throw console.error("onClickCloseWorkOrderButton"),e})),t("submit"),b()})).catch((()=>{}))},O=async()=>{await(a.value?.validate().then((()=>{p.value=setTimeout((async()=>{clearTimeout(p.value),d.value=!0,await y().catch((e=>{throw d.value=!1,console.error("onClickConfirmButton"),e})),b(),t("submit"),d.value=!1}),300)})).catch((()=>{})))};return(e,t)=>{const r=(0,n.up)("el-input"),o=(0,n.up)("el-form-item"),c=(0,n.up)("el-button"),p=(0,n.up)("el-upload"),m=(0,n.up)("el-form");return(0,n.wg)(),(0,n.iD)("div",K,[(0,n.Wm)(m,{model:l,rules:i,"label-width":"80px",ref_key:"formRef",ref:a,class:"right-detail-append__form"},{default:(0,n.w5)((()=>[(0,n.Wm)(o,{label:"内容",prop:"workOrderContent"},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{modelValue:l.workOrderContent,"onUpdate:modelValue":t[0]||(t[0]=e=>l.workOrderContent=e),placeholder:"请输入",autosize:{minRows:2,maxRows:4},type:"textarea",maxlength:"500",resize:"vertical","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,n.Wm)(o,{label:"附件上传",prop:"appendices"},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{"file-list":s.value,"onUpdate:fileList":t[2]||(t[2]=e=>s.value=e),"http-request":w,limit:3,"before-upload":_,"on-success":g,accept:".txt,.pdf,.jpg,.jpeg,.png",multiple:"","show-file-list":"",ref_key:"formUploadRef",ref:u,class:"form__upload"},{tip:(0,n.w5)((()=>[Q])),default:(0,n.w5)((()=>[(0,n._)("div",$,[(0,n.Wm)(c,{type:"primary"},{default:(0,n.w5)((()=>[(0,n.Uk)("点击上传")])),_:1}),(0,n._)("span",{class:"button-tip",onClick:t[1]||(t[1]=(0,T.iM)((()=>{}),["stop"]))},"最多可以上传3个附件")])])),_:1},8,["file-list"])])),_:1})])),_:1},8,["model","rules"]),(0,n._)("div",X,[(0,n.Wm)(c,{onClick:k},{default:(0,n.w5)((()=>[(0,n.Uk)("关闭工单")])),_:1}),(0,n.Wm)(c,{loading:d.value,type:"primary",onClick:O},{default:(0,n.w5)((()=>[(0,n.Uk)("确认追加")])),_:1},8,["loading"])])])}}});const J=(0,k.Z)(G,[["__scopeId","data-v-40ad3250"]]);var ee=J;const te=e=>((0,n.dD)("data-v-668bd4ac"),e=e(),(0,n.Cn)(),e),re={class:"left-area__order-list"},ne=te((()=>(0,n._)("header",{class:"right-area__header"},[(0,n._)("h3",{class:"header__text"},"工单详情")],-1))),oe={class:"right-area__detail"};var ae=(0,n.aZ)({__name:"index",setup(e){const t=(0,n.RC)((()=>r.e(314).then(r.bind(r,1314)))),l=(0,n.RC)((()=>r.e(90).then(r.bind(r,9090)))),i=((0,a.yj)(),10);const u=(0,o.iH)(""),c=(0,o.iH)(void 0),s=(0,o.iH)(""),d=(0,o.iH)(null),p=(0,o.iH)(!1),m=(0,o.iH)([]),f=(0,o.iH)(),v=(0,o.iH)(1),w=(0,o.iH)(0),y=(0,o.iH)(),h=(0,o.iH)(!1),b=(0,o.iH)([]),_=(0,o.iH)(""),g=(0,o.iH)(void 0),k=(0,o.iH)(!1),O=(0,o.iH)(),W=(0,n.Fl)((()=>{const e=[1,2];return e.includes(g.value)})),C=async()=>{const e=i;let[t,r]=d.value||[];t=t||"",r=r||"";const n=c.value||void 0,o=v.value,a=u.value,l=s.value||"",p={pageSize:e,startTime:t,endTime:r,pageNumb:o,status:n,workOrderNumber:a,workOrderTypeCode:l};return await S.i.fetchList(p)},N=async()=>{const e=_.value;return await S.i.fetchExtraneousInfoByWorkOrderNumber({workOrderNumber:e})},T=async()=>{const e=_.value;return await S.i.fetchDetailListByWorkOrderNumber({workOrderNumber:e})},E=async()=>{const e=_.value;return await S.i.markAsRead({workOrderNumber:e})},D=async()=>{p.value=!0;const{total:e,list:t}=await C().catch((e=>{throw console.error("handleFetchWorkOrderList"),e}));w.value=e||0,m.value=Array.isArray(t)?t:[],p.value=!1},U=async(e=!0)=>{const{haveEvaluate:t,haveUnreadMessages:r,status:n}=await N().catch((e=>{throw console.error("handleFetchWorkOrderExtraneousInfoByWorkOrderNumber"),e}));g.value=n,e&&(k.value=t),m.value=m.value.map((e=>{const{workOrderNumber:t}=e;return t===_.value?{...e,haveUnreadMessages:r,status:n}:e}))},A=async()=>{const e=await T().catch((e=>{throw console.error("handleFetchWorkOrderDetailListByWorkOrderNumber"),e}));b.value=Array.isArray(e)?e:[];const t=_.value;m.value.forEach(((e,r)=>{if(e.workOrderNumber===t){const t={appKey:e.appKey,orderNumberInfo:e.orderNumberInfo,msgApiInfo:e.msgApiInfo};b.value.forEach(((e,r)=>{0===r&&Object.assign(e,t)}))}})),O.value=b.value[b.value.length-1].offset},H=async()=>{await E().catch((e=>{throw console.error("handleMarkWorkOrderAsRead"),e}))},j=async e=>{e&&(v.value=e),await D().catch((e=>{throw console.error("onFetchList"),e})),f.value?.scrollToTop(),f.value?.clickFirstListItem()},L=async e=>{_.value=e,H().catch((e=>{console.error("onUpdateCurrentWorkOrderNumber",e)})),h.value=!0,await Promise.all([U(),A()]).catch((e=>{throw console.error("onUpdateCurrentWorkOrderNumber"),e})),h.value=!1,y.value?.scrollToBottom()},F=async(e=!0)=>{h.value=!0,await Promise.all([U(e),A()]).catch((e=>{throw console.error("onSubmitWorkOrder"),e})),h.value=!1,y.value?.scrollToBottom()};return(0,n.bv)((async()=>{await j().catch((e=>{throw console.error("onMounted"),e}))})),(e,r)=>{const a=(0,n.up)("el-col"),O=(0,n.up)("el-row"),C=(0,n.Q2)("loading");return(0,n.wg)(),(0,n.j4)(O,{class:"work-order"},{default:(0,n.w5)((()=>[(0,n.Wm)(a,{span:11,xl:8,tag:"aside",class:"work-order__left-area"},{default:(0,n.w5)((()=>[(0,n.Wm)((0,o.SU)(t),{"work-order-number":u.value,"onUpdate:workOrderNumber":r[0]||(r[0]=e=>u.value=e),status:c.value,"onUpdate:status":r[1]||(r[1]=e=>c.value=e),"work-order-type-code":s.value,"onUpdate:workOrderTypeCode":r[2]||(r[2]=e=>s.value=e),"time-range":d.value,"onUpdate:timeRange":r[3]||(r[3]=e=>d.value=e),onFetchList:j},null,8,["work-order-number","status","work-order-type-code","time-range"]),(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",re,[(0,n.Wm)(x,{"current-work-order-number":_.value,data:m.value,ref_key:"leftListRef",ref:f,"onUpdate:currentWorkOrderNumber":L},null,8,["current-work-order-number","data"]),(0,n.Wm)((0,o.SU)(l),{"page-numb":v.value,"onUpdate:pageNumb":r[4]||(r[4]=e=>v.value=e),total:w.value,pageSize:i,onFetchList:j},null,8,["page-numb","total"])])),[[C,p.value]])])),_:1}),(0,n.Wm)(a,{span:13,xl:16,tag:"main",class:"work-order__right-area"},{default:(0,n.w5)((()=>[ne,(0,n.wy)(((0,n.wg)(),(0,n.iD)("main",oe,[(0,n.Wm)(V,{data:b.value,"current-work-order-number":_.value,"current-status":g.value,"current-have-evaluate":k.value,ref_key:"rightDetailListRef",ref:y,onSubmit:F},null,8,["data","current-work-order-number","current-status","current-have-evaluate"]),(0,o.SU)(W)?((0,n.wg)(),(0,n.j4)(ee,{key:0,"current-work-order-number":_.value,onSubmit:F},null,8,["current-work-order-number"])):(0,n.kq)("",!0)])),[[C,h.value]])])),_:1})])),_:1})}}});const le=(0,k.Z)(ae,[["__scopeId","data-v-668bd4ac"]]);var ie=le}}]);
//# sourceMappingURL=755.195b4567.js.map